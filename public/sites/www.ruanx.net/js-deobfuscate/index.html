<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>一场有趣的 js 反混淆</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="../assets/built/screen%EF%B9%96v=792c672b3c.css" />

    <meta name="description" content="对哈工大运动场馆预约系统 js 的分析过程。我们通过自动和人工分析，提取出了网络请求的相关逻辑，为编写爬虫提供基础。" />
    <link rel="icon" href="../content/images/size/w256h256/2020/02/small-3.png" type="image/png" />
    <link rel="canonical" href="index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="amp/index.html" />
    
    <meta property="og:site_name" content="Pion1eer" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="一场有趣的 js 反混淆" />
    <meta property="og:description" content="对哈工大运动场馆预约系统 js 的分析过程。我们通过自动和人工分析，提取出了网络请求的相关逻辑，为编写爬虫提供基础。" />
    <meta property="og:url" content="https://www.ruanx.net/js-deobfuscate/" />
    <meta property="og:image" content="https://www.ruanx.net/content/images/2023/03/output-1.jpg" />
    <meta property="article:published_time" content="2023-03-30T14:24:22.000Z" />
    <meta property="article:modified_time" content="2023-04-01T08:17:03.000Z" />
    <meta property="article:tag" content="reverse" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="一场有趣的 js 反混淆" />
    <meta name="twitter:description" content="对哈工大运动场馆预约系统 js 的分析过程。我们通过自动和人工分析，提取出了网络请求的相关逻辑，为编写爬虫提供基础。" />
    <meta name="twitter:url" content="https://www.ruanx.net/js-deobfuscate/" />
    <meta name="twitter:image" content="https://www.ruanx.net/content/images/2023/03/output-1.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Ruan Xingzhi" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="reverse" />
    <meta property="og:image:width" content="640" />
    <meta property="og:image:height" content="480" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Pion1eer",
        "url": "https://www.ruanx.net/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://www.ruanx.net/content/images/size/w256h256/2020/02/small-3.png",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Ruan Xingzhi",
        "image": {
            "@type": "ImageObject",
            "url": "https://www.ruanx.net/content/images/2020/05/blue.jpeg",
            "width": 1024,
            "height": 1024
        },
        "url": "https://www.ruanx.net/author/blue/",
        "sameAs": []
    },
    "headline": "一场有趣的 js 反混淆",
    "url": "https://www.ruanx.net/js-deobfuscate/",
    "datePublished": "2023-03-30T14:24:22.000Z",
    "dateModified": "2023-04-01T08:17:03.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://www.ruanx.net/content/images/2023/03/output-1.jpg",
        "width": 640,
        "height": 480
    },
    "keywords": "reverse",
    "description": "对哈工大运动场馆预约系统 js 的分析过程。我们通过自动和人工分析，提取出了网络请求的相关逻辑，为编写爬虫提供基础。",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://www.ruanx.net/"
    }
}
    </script>

    <meta name="generator" content="Ghost 5.8" />
    <link rel="alternate" type="application/rss+xml" title="Pion1eer" href="../rss/index.rss" />
    <script defer src="https://cdn.jsdelivr.net/npm/@tryghost/portal@~2.5/umd/portal.min.js" data-ghost="https://www.ruanx.net/" data-key="595acd8f13c14d79a10527399d" data-api="https://www.ruanx.net/ghost/api/content/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="https://cdn.jsdelivr.net/npm/@tryghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="595acd8f13c14d79a10527399d" data-styles="https://cdn.jsdelivr.net/npm/@tryghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://www.ruanx.net/" crossorigin="anonymous"></script>
    <script defer src="../public/cards.min%EF%B9%96v=792c672b3c.js"></script>
    <link rel="stylesheet" type="text/css" href="../public/cards.min%EF%B9%96v=792c672b3c.css">
    <!-- link href="https://fonts.googleapis.com/css?family=Noto+Serif+SC&display=swap" rel="stylesheet" -->

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fira+Mono&amp;family=Noto+Serif+SC&amp;display=swap" rel="stylesheet">

<style>.post-content,.post-card-excerpt{font-family: 'Noto Serif SC', "PingFang SC","Helvetica Neue",Helvetica,"Hiragino Sans GB","Microsoft YaHei","微软雅黑",Arial,sans-serif;}
    .post-full-content{font-size: 100%;}
    .post-full-custom-excerpt {font-size: 1.8rem;}
    .post-full-title {font-size:3.2rem;}
    .post-full-content blockquote{margin:20px;padding: 1em;  background-color: #3eb0ef14; }
    .post-full-content blockquote p {font-style:normal;}
    .post-full-image {display:none;}
    
    /* .post-full-content figcaption {margin: .4em 0 .5em  !important} */
    
    .kg-callout-card {width: 100%; margin-bottom: 1em;}
    
    .post-full-content figure {margin: 0.8em 0 1em;}
    
    p {margin: 0.2em 0 0.5em !important;}
    
    .post-full-content img{border-radius:5px;}
    
    code {font-family: 'Noto Serif SC';}
</style>


<style>:root {--ghost-accent-color: #15171A;}</style>

</head>
<body class="post-template tag-reverse">

    <div class="site-wrapper">

        

<header class="site-header">
    <div class="outer site-nav-main">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left-wrapper">
        <div class="site-nav-left">
                <a class="site-nav-logo" href="../index.html">Pion1eer</a>
            <div class="site-nav-content">
                    <ul class="nav">
    <li class="nav-home"><a href="../index.html">Home</a></li>
    <li class="nav-about"><a href="../about/index.html">About</a></li>
</ul>

                    <span class="nav-post-title dash">一场有趣的 js 反混淆</span>
            </div>
        </div>
    </div>
    <div class="site-nav-right">
            <div class="social-links">
            </div>
                <a class="rss-button" href="https://feedly.com/i/subscription/feed/https://www.ruanx.net/rss/" title="RSS" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="6.18" cy="17.82" r="2.18"/><path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/></svg>
</a>

    </div>
</nav>
    </div>
</div>

<script>
 MathJax = {
        tex:{
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            },
        svg:{
                fontCache: 'global'
            }
        }; 
    </script>
    <script src="https://cdn.staticfile.org/babel-polyfill/7.12.1/polyfill.min.js?features=es6"></script>
    <script type="text/javascript" id="MathJax-script" async  src="https://cdn.staticfile.org/mathjax/3.2.2/es5/tex-mml-chtml.js"></script>

<style>@media (prefers-color-scheme: light) {
		.post-full-content  
    pre{background:#fafafa;margin:10px 10px 20px 10px;border-style: solid;border-color:#DCDFE6;}
}
</style>

<link rel="stylesheet" href="https://cdn.ruanx.net/css/atom-one-dark.css">
<link rel="stylesheet" media="(prefers-color-scheme: light)" href="https://cdn.ruanx.net/css/atom-one-light.min.css">
<style>.post-full-content  code{font-family: 'Fira Mono', 'Jetbrains mono', 'ubuntu mono', consolas, 'monospace' !important;}
</style>

</header>


<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post tag-reverse ">

            <header class="post-full-header">

                <section class="post-full-tags">
                    <a href="../tag/reverse/index.html">reverse</a>
                </section>

                <h1 class="post-full-title">一场有趣的 js 反混淆</h1>

                <p class="post-full-custom-excerpt">对哈工大运动场馆预约系统 js 的分析过程。我们通过自动和人工分析，提取出了网络请求的相关逻辑，为编写爬虫提供基础。</p>

                <div class="post-full-byline">

                    <section class="post-full-byline-content">

                        <ul class="author-list">
                            <li class="author-list-item">

                                <div class="author-card">
                                    <img class="author-profile-image" src="../content/images/size/w100/2020/05/blue.jpeg" alt="Ruan Xingzhi" />
                                    <div class="author-info">
                                        <div class="bio">
                                            <h2>Ruan Xingzhi</h2>
                                            <p>Welcome to my site and hope you have fun.</p>
                                            <p><a href="../author/blue/index.html">More posts</a> by Ruan Xingzhi.</p>
                                        </div>
                                    </div>
                                </div>

                                <a href="../author/blue/index.html" class="author-avatar">
                                    <img class="author-profile-image" src="../content/images/size/w100/2020/05/blue.jpeg" alt="Ruan Xingzhi" />
                                </a>

                            </li>
                        </ul>

                        <section class="post-full-byline-meta">
                            <h4 class="author-name"><a href="../author/blue/index.html">Ruan Xingzhi</a></h4>
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2023-03-30">30 Mar 2023</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> 13 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            <figure class="post-full-image">
                <img
                    srcset="../content/images/size/w300/2023/03/output-1.jpg 300w,
                            ../content/images/size/w600/2023/03/output-1.jpg 600w,
                            ../content/images/size/w1000/2023/03/output-1.jpg 1000w,
                            ../content/images/size/w2000/2023/03/output-1.jpg 2000w"
                    sizes="(max-width: 800px) 400px,
                        (max-width: 1170px) 1170px,
                            2000px"
                    src="../content/images/size/w2000/2023/03/output-1.jpg"
                    alt="一场有趣的 js 反混淆"
                />
            </figure>

            <section class="post-full-content">
                <div class="post-content">
                    <p>　　前些天在校园网内测试一些站点，第一个目标便是平时使用的运动场馆预约系统。发现这个系统的前后端通讯有加密（当然，实为 encode 而非 encrypt），且 js 代码存在混淆。当天挖到三个漏洞，提交给网络中心，就转而去测试其他信息系统了；近日苦于难以预测乒乓球场是否存在空位，想到定时爬取预约系统的申请数量，做一个数据分析工作。这就需要写一个爬虫出来。</p><p>　　显然，最简单的方式是用 Selenium 操纵一个 Firefox/Chrome 浏览器，完成登录、爬取等任务。不过近期笔者想提升 web 渗透测试水平，于是决定重新系统性地分析这个网站的 javascript 混淆机制。于是有了本篇文章。</p><h3 id="0x00-%E8%8E%B7%E5%8F%96%E7%AB%99%E7%82%B9%E5%9C%B0%E5%9D%80">0x00 获取站点地址</h3><p>　　预约系统是在移动端「哈工大 APP」中使用的，此 APP 是基于华为 welink，并未显示预约系统的 url。想要获取 url，显然可以通过局域网抓包的方式，从 DNS 请求或者 HTTP 请求中拿到域名。</p><p>　　不过，笔者发现哈工大 APP 里面有「在系统浏览器中打开」按钮，点击即送 url。因此省掉了许多工作，直接拿到域名：<code>venue-book.hit.edu.cn</code> 。</p><h3 id="0x01-%E6%8E%A2%E7%B4%A2">0x01 探索</h3><p>　　首先，进入每一个页面收集信息。</p><figure class="kg-card kg-gallery-card kg-width-wide"><div class="kg-gallery-container"><div class="kg-gallery-row"><div class="kg-gallery-image"><img src="../content/images/2023/03/QQ--20230322131104.png" width="852" height="1693" loading="lazy" alt srcset="../content/images/size/w600/2023/03/QQ--20230322131104.png 600w, ../content/images/2023/03/QQ--20230322131104.png 852w" sizes="(min-width: 720px) 720px"></div><div class="kg-gallery-image"><img src="../content/images/2023/03/QQ--20230322131136.png" width="871" height="1672" loading="lazy" alt srcset="../content/images/size/w600/2023/03/QQ--20230322131136.png 600w, ../content/images/2023/03/QQ--20230322131136.png 871w" sizes="(min-width: 720px) 720px"></div><div class="kg-gallery-image"><img src="../content/images/2023/03/QQ--20230322131228.png" width="843" height="1652" loading="lazy" alt srcset="../content/images/size/w600/2023/03/QQ--20230322131228.png 600w, ../content/images/2023/03/QQ--20230322131228.png 843w" sizes="(min-width: 720px) 720px"></div></div></div></figure><p>　　观察网络请求：</p><figure class="kg-card kg-image-card"><img src="../content/images/2023/03/image.png" class="kg-image" alt loading="lazy" width="2000" height="864" srcset="../content/images/size/w600/2023/03/image.png 600w, ../content/images/size/w1000/2023/03/image.png 1000w, ../content/images/size/w1600/2023/03/image.png 1600w, ../content/images/size/w2400/2023/03/image.png 2400w" sizes="(min-width: 720px) 720px"></figure><p>　　对所有 API 的访问都如上图所示。无论是 GET 还是 POST，服务端返回数据一定按照以下格式：</p><pre><code class="language-json">{
    "data": "siVU7wqjTVcR0fGnUUTEPPI+yWUZlQjZJfqjPs1gaOTLCQ1Iu/CA4Cvw0zhDJjbMp3rh/NEnO4m1j4T0L6fpWS7qQMpE7UyK98BRBqSHNpeBYPtq3boTMPhOPOjo08BuBGqknRdhehKwzaeraSJaXnpH11XqZxs19ywDKHG8zzX3wYCny7VfeYd1sELWpChZe3mJU28ernqilEEcmpgiU6oCxPzLYxEffbLBJ1pZQCs=",
    "md5": "JhoUtk4Lsvf3x6vP1Vfz4NASx11EQiRzsi0VXJnnR6EXxXJWISmGXmeAeU4eoVzvnp5rR91UY8V6BMSETT3D74M9/5fwgPMWL34WJ3vBJvNRg/ByJc6/qfDb6MEmFzDFE5vpX5SHbuiL94dhFFVn+eBfnf+z9A+yQP1zUbUjA2M=37666333346434343334633363623338"
}</code></pre><p>　　如果是 POST 请求，则客户端发送的报文形如：</p><pre><code class="language-json">{
    "data": "IK/CNHtsAmpiFNrebaKTh1R8tNpByd+IHNUwTCOI8i85z6kS4Kw3sZxO81+wvar+klVmynzoj79NE1XMPuMrjwdt0UTia4QmhGHayJ1AaPG8JXELRj10SrOn6IATTCQj",
    "md5": "f982zQQ7JBVGrbde+Y9G0apkwg7tAyRvuIEcujZoMY1LX2szjXwi4RcU16QCoMN2J5y6XrjtnqTUGpyisdYSOQVWaGt3HsQRN+DmfGoq6EGLvFDldbcQsjDIgVGuAzkVXjaczM+PPmmho2br9MCJORQ0waVP0B/m+MK3DyMJZ4w="
}</code></pre><p>　　观察可知，服务端返回数据中，<code>md5</code> 字段尾部有一串十六进制码。我们给网络请求过程下断点：</p><figure class="kg-card kg-image-card"><img src="../content/images/2023/03/image-1.png" class="kg-image" alt loading="lazy" width="2000" height="1241" srcset="../content/images/size/w600/2023/03/image-1.png 600w, ../content/images/size/w1000/2023/03/image-1.png 1000w, ../content/images/size/w1600/2023/03/image-1.png 1600w, ../content/images/size/w2400/2023/03/image-1.png 2400w" sizes="(min-width: 720px) 720px"></figure><p>　　于是追踪到相关逻辑。接下来，进入网络请求的反混淆工作。</p><h3 id="0x02-%E5%8E%BB%E6%B7%B7%E6%B7%86">0x02 去混淆</h3><p>　　主要的逻辑在下面这个 js：</p>
        <div class="kg-card kg-file-card kg-file-card-medium">
            <a class="kg-file-card-container" href="../content/files/2023/03/app.6b2e12ec.js" title="Download" download>
                <div class="kg-file-card-contents">
                    <div class="kg-file-card-title">App6b2e12ec</div>
                    
                    <div class="kg-file-card-metadata">
                        <div class="kg-file-card-filename">app.6b2e12ec.js</div>
                        <div class="kg-file-card-filesize">147 KB</div>
                    </div>
                </div>
                <div class="kg-file-card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>download-circle</title><polyline class="a" points="8.25 14.25 12 18 15.75 14.25"/><line class="a" x1="12" y1="6.75" x2="12" y2="18"/><circle class="a" cx="12" cy="12" r="11.25"/></svg>
                </div>
            </a>
        </div>
        <p>　　这个文件经历过比较强的混淆，相当难看。我们首先看文件的开头：</p><figure class="kg-card kg-image-card"><img src="../content/images/2023/03/image-2.png" class="kg-image" alt loading="lazy" width="1757" height="897" srcset="../content/images/size/w600/2023/03/image-2.png 600w, ../content/images/size/w1000/2023/03/image-2.png 1000w, ../content/images/size/w1600/2023/03/image-2.png 1600w, ../content/images/2023/03/image-2.png 1757w" sizes="(min-width: 720px) 720px"></figure><p>　　这里面有一个 <code>a-zA-Z+/=</code> 的字符串表，推测 <code>a0_0x1934</code> 这个函数是用来编解码的。继续往后看：</p><figure class="kg-card kg-image-card"><img src="../content/images/2023/03/image-3.png" class="kg-image" alt loading="lazy" width="1798" height="1183" srcset="../content/images/size/w600/2023/03/image-3.png 600w, ../content/images/size/w1000/2023/03/image-3.png 1000w, ../content/images/size/w1600/2023/03/image-3.png 1600w, ../content/images/2023/03/image-3.png 1798w" sizes="(min-width: 720px) 720px"></figure><p>　　注意到这一部分有很多形如 <code>_0xd11376(0x56f, 'c@mQ')</code> 的调用。动态调试，发现这里的 <code>_0xd11376</code> 正是 <code>a0_0x1934</code> 的别名，且只有第一个数值参数有效，第二个字符串参数与返回值无关。于是可以猜测程序逻辑：</p><ol><li>建立一个 <code>int -&gt; str</code> 的编码表</li><li>之后透过查表的方式获取常量字符串</li></ol><p>　　这样做是有道理的，可以比较方便地隐藏常量字符串，以逃避关键字检查。而编码表在程序运行的一开始便建立起来，我们可以很方便地在 chrome console 中查表。</p><p>　　渗透测试过程中，笔者发现这一流程后，采用动态调试 + 肉眼反混淆的方式解析出了网络请求的逻辑。本文采取另一条做法：先想办法自动反混淆。网络上有些工具：</p><ul><li><a href="https://deobfuscate.relative.im/">https://deobfuscate.relative.im/</a></li><li><a href="https://deobfuscate.io/">https://deobfuscate.io/</a></li><li><a href="https://www.seosniffer.com/javascript-deobfuscator">https://www.seosniffer.com/javascript-deobfuscator</a></li></ul><p>　　重复反混淆几次，结果就很漂亮了。结果如下：</p>
        <div class="kg-card kg-file-card kg-file-card-medium">
            <a class="kg-file-card-container" href="../content/files/2023/03/deobfuscated.js" title="Download" download>
                <div class="kg-file-card-contents">
                    <div class="kg-file-card-title">Deobfuscated</div>
                    
                    <div class="kg-file-card-metadata">
                        <div class="kg-file-card-filename">deobfuscated.js</div>
                        <div class="kg-file-card-filesize">56 KB</div>
                    </div>
                </div>
                <div class="kg-file-card-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><defs><style>.a{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:1.5px;}</style></defs><title>download-circle</title><polyline class="a" points="8.25 14.25 12 18 15.75 14.25"/><line class="a" x1="12" y1="6.75" x2="12" y2="18"/><circle class="a" cx="12" cy="12" r="11.25"/></svg>
                </div>
            </a>
        </div>
        <h3 id="0x03-%E5%88%86%E6%9E%90%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82">0x03 分析网络请求</h3><p>　　快速浏览一遍程序，发现几个网络请求的 url：</p><figure class="kg-card kg-image-card"><img src="../content/images/2023/03/image-4.png" class="kg-image" alt loading="lazy" width="2000" height="1420" srcset="../content/images/size/w600/2023/03/image-4.png 600w, ../content/images/size/w1000/2023/03/image-4.png 1000w, ../content/images/size/w1600/2023/03/image-4.png 1600w, ../content/images/2023/03/image-4.png 2081w" sizes="(min-width: 720px) 720px"></figure><p>　　动态调试下断点，找到发出请求前的关键逻辑：</p><figure class="kg-card kg-image-card"><img src="../content/images/2023/03/image-5.png" class="kg-image" alt loading="lazy" width="1790" height="1226" srcset="../content/images/size/w600/2023/03/image-5.png 600w, ../content/images/size/w1000/2023/03/image-5.png 1000w, ../content/images/size/w1600/2023/03/image-5.png 1600w, ../content/images/2023/03/image-5.png 1790w" sizes="(min-width: 720px) 720px"></figure><p>　　观察这部分代码。看到一句 <code>_0x27e530.a.enc.Utf8.parse(_0x28d2df)</code> ，猜测这是一个库函数。在网上查询 <code>enc.Utf8.parse</code> 这个 API，发现是 CryptoJS 提供的。类似地，查询 <code>KJUR.crypto.Cipher.encrypt</code> 这个 API，发现对应 jsrsasign 库。</p><p>　　于是简化如下：</p><pre><code class="language-js">function _0x128461(_0x55f5d0, _0x350abb) {
    _0x350abb = CryptoJS.enc.Hex.parse(_0x350abb)
    var _0x43ce13 = CryptoJS.enc.Utf8.parse(_0x55f5d0),
        _0x36ea5f = CryptoJS.AES.encrypt(_0x43ce13, _0x350abb, {
            mode: CryptoJS.mode.ECB,
            padding: CryptoJS.pad.Pkcs7,
        })
    return _0x36ea5f.toString()
}
function _0x35b81b(_0x4e3276, _0x56dae9) {
    _0x56dae9 = CryptoJS.enc.Hex.parse(_0x56dae9)
    var _0x21fe0c = CryptoJS.AES.decrypt(_0x4e3276, _0x56dae9, {
        mode: CryptoJS.mode.ECB,
        padding: CryptoJS.pad.Pkcs7,
    })
    const _0x50f0cc = CryptoJS.enc.Utf8.stringify(_0x21fe0c).toString()
    return _0x50f0cc
}
function _0x24156d(_0x3d3cf1, _0x22c595) {
    const _0x31e1d3 = jsrsasign.KEYUTIL.getKey(_0x22c595)
    var _0x552c24 = jsrsasign.KJUR.crypto.Cipher.encrypt(_0x3d3cf1, _0x31e1d3)
    return (_0x552c24 = Object(jsrsasign.hextob64)(_0x552c24)), _0x552c24
}
function _0x4ef4f7(plain_msg) {
    if ('pk' === _0x10fe5c.a.state.pk) {
        return plain_msg
    }
    var _0x28d2df = _0x3c4515(16),
        _0x10e785 = CryptoJS.enc.Utf8.parse(_0x28d2df).toString(
            CryptoJS.enc.Hex
        ),
        post_data_msg = JSON.stringify(plain_msg)
    post_data_msg = _0x128461(post_data_msg, _0x10e785)
    var post_data_md5 = CryptoJS.MD5(post_data_msg).toString()
    post_data_md5 = _0x24156d(post_data_md5 + _0x28d2df, _0x10fe5c.a.state.pk)
    var post_data = {
        data: post_data_msg,
        md5: post_data_md5,
    }
    const _0x38c2c2 = post_data
    return _0x38c2c2
}</code></pre><p>　　继续简化。动态调试发现 <code>_0x3c4515(16)</code> 返回了一个 16 字节长的随机串。它转 hex 之后立刻会参与 <code>_0x128461</code> 过程，而很容易分析出 <code>_0x128461</code> 过程是一个 aes-128-ecb 加密。于是得知这 16 字节随机串是当作了 AES key 使用。</p><p>　　再进行一些分析，得到结果：</p><pre><code class="language-js">function encrypt_aes_128_ecb(plain, passwd) {
    passwd = CryptoJS.enc.Hex.parse(passwd)
    var _0x43ce13 = CryptoJS.enc.Utf8.parse(plain),
        ciphertext = CryptoJS.AES.encrypt(_0x43ce13, passwd, {
            mode: CryptoJS.mode.ECB,
            padding: CryptoJS.pad.Pkcs7,
        })
    return ciphertext.toString()
}
function decrypt_aes_128_ecb(ciphertext, passwd) {
    passwd = CryptoJS.enc.Hex.parse(passwd)
    var _0x21fe0c = CryptoJS.AES.decrypt(ciphertext, passwd, {
        mode: CryptoJS.mode.ECB,
        padding: CryptoJS.pad.Pkcs7,
    })
    const plaintext = CryptoJS.enc.Utf8.stringify(_0x21fe0c).toString()
    return plaintext
}
function enc_rsa(plain, pubkey) {
    const pubkey_obj = jsrsasign.KEYUTIL.getKey(pubkey)
    var ciphertext = jsrsasign.KJUR.crypto.Cipher.encrypt(plain, pubkey_obj)
    ciphertext = Object(jsrsasign.hextob64)(ciphertext)
    return ciphertext
}
function prepare_send_data(plain_msg) {
    if ('pk' === _0x10fe5c.a.state.pk) {
        return plain_msg
    }
    var aes_key = get_random_bytes(16),
        aes_key_hex = CryptoJS.enc.Utf8.parse(aes_key).toString(
            CryptoJS.enc.Hex
        ),
        post_data_msg = JSON.stringify(plain_msg)
    post_data_msg = encrypt_aes_128_ecb(post_data_msg, aes_key_hex)
    var post_data_md5 = CryptoJS.MD5(post_data_msg).toString()
    post_data_md5 = enc_rsa(post_data_md5 + aes_key, _0x10fe5c.a.state.pk)
    var post_data = {
        data: post_data_msg,
        md5: post_data_md5,
    }
    return post_data
}</code></pre><p>　　于是我们确定了发包流程：</p><ol><li>随机生成 16 字节的字符串，作为 AES key</li><li>对明文进行 AES 加密，得到 <code>data</code> 字段</li><li>对 <code>md5(data) + aes_key</code> 使用服务端公钥进行 PKCS#1 v1.5 RSA 加密，作为 <code>md5</code> 字段</li></ol><p>　　简而言之，这个加密体系是 encrypt-then-mac 外面套一层 RSA。那么，服务器在收到一条 <code>(data, md5)</code> 信息后，首先用自己的 RSA 私钥进行解密，获取 <code>aes_key</code> 和密文摘要；然后验证 <code>data</code> 字段的 MD5 值是否确实等同于 RSA 解密所获得的密文摘要，以保证消息不被篡改。</p><p>　　来考虑这个体系的安全性。只要攻击者不知道服务器端持有的私钥，那么他就无法解密出 <code>aes_key</code> ；而 <code>aes_key</code> 是客户端浏览器随机生成，信道上无法窃听到。因此，这个加密体系是比较安全的。当然，也存在改进的空间，例如 AES ECB 模式是不安全的，应当改为 CBC 等其他模式。</p><p>　　接下来考察 js 如何解密服务端发回的 HTTP response。这个函数就在发包代码的下面，反混淆之后得到：</p><pre><code class="language-js">function decrypt_response_data(resp) {
    if ('prik' === _0x10fe5c.a.state.priK) {
        return resp
    }
    if ('object' === typeof resp.data) {
        return resp
    }
    var aes_key = resp.md5.slice(-32)
    const result = decrypt_aes_128_ecb(resp.data, aes_key)
    return JSON.parse(result)
}</code></pre><p>　　它的逻辑是：</p><ol><li>取服务端返回数据中的 <code>md5</code> 字段，将其尾部 32 个十六进制字符转成一个 16 字节的 AES key</li><li>使用该 key 解密 <code>data</code> 字段。</li></ol><p>　　我们找个请求实例验证一下，信然。</p><figure class="kg-card kg-image-card"><img src="../content/images/2023/03/image-6.png" class="kg-image" alt loading="lazy" width="2000" height="936" srcset="../content/images/size/w600/2023/03/image-6.png 600w, ../content/images/size/w1000/2023/03/image-6.png 1000w, ../content/images/size/w1600/2023/03/image-6.png 1600w, ../content/images/2023/03/image-6.png 2264w" sizes="(min-width: 720px) 720px"></figure><p>　　应当指出，<strong>尽管浏览器发送请求的过程是密码学安全的，但服务端返回数据的过程却并非安全。</strong>信道上的窃听者可以直接从 <code>md5</code> 字段的尾部获取到 AES key，从而解密 <code>data</code> 获得 response 数据明文。</p><p>　　因此，我们接下来只需分析客户端如何获取服务端 pubkey，就能模拟这个 js 客户端发出网络请求。</p><h3 id="0x04-%E5%85%AC%E9%92%A5%E4%BB%8E%E4%BD%95%E5%A4%84%E6%9D%A5%EF%BC%9F">0x04 公钥从何处来？</h3><p>　　搜索 <code>public</code> 字样，发现 1083 行左右比较可疑，推测为密钥协商过程。</p><figure class="kg-card kg-image-card"><img src="../content/images/2023/03/image-7.png" class="kg-image" alt loading="lazy" width="1910" height="1243" srcset="../content/images/size/w600/2023/03/image-7.png 600w, ../content/images/size/w1000/2023/03/image-7.png 1000w, ../content/images/size/w1600/2023/03/image-7.png 1600w, ../content/images/2023/03/image-7.png 1910w" sizes="(min-width: 720px) 720px"></figure><p>　　观察这个 <code>await</code> 的写法，它很像是 fetch 或者 ajax 请求。另外，抓包发现有一个 HTTP 请求与之相关：</p><pre><code class="language-plaintext">POST http://venue-book.hit.edu.cn/school/signToken

payload = "pVba/9po2Wp/Yshc08EHhL52Igs6L3wATCIHk+mIzDltllrN6VBks6XoAoNFqmTL"
response = "aQW9W81+Vs96s4wIk/y4U7L3uvWzxDuQWgbucDDW+DWGwF0wbajm2+Er5viYBFIcKUA+JF5eg7Wrr6PS08SUsOXpvnIDGXYG7kIEV1h4ZC3XYD1PyVroRH1OnDbm+jtTKQdH0o7Hw6A3Tij+NOD7iQZF/UnNfnkJyrANbzq4XEyNhq9tZha5FxAepH+bVP91VV81IUyuTmA+3 uHUbZ3XR6eWSGQEoWVpANyev0x3uFZUOkYr1fPz1RuGH8UeXahKlRPpZ97R5iglFkiMTH2rCh8OtWnur+XDVF0yx5GDBQEEa9baARLbZ1bpuYsCWulONyHfuHYx0w7wbezq7CdAkWirudmhxzovJcsmrHgzXKReh5uPXaignXnEg5CsGtoTP1ppmoobjQPVcFnM+O1qGnPpxZzBge/GD4OevXfa8sa31fJAbn/FZSDcAColaO0e1XMP4/9 EZ5u+LVZ0q74O2BMwKl/Zm0nrp9buO1GXBR14IYca2dAsOsAJpm8OXZi1vyLp0mqz/Js+7 G1o+9 on0JaoLMbhKIOYqs21acIeCRDFIekJstKHWZ8qrorzlZMc4ERl0HKqgS0PHkJjFRddwVDyl92hkxsOoNeZIP2X4WXbxcZRDLIw70qsJ8mbioCmla9UurYNkuDEGER3wlzwM3kGCHBbqSH7imwqm1JiMqcx5/suHDM6NXPLxUlVwwfZod1dlvx0Gsybp0HjzQ44dhBNsRu7cqHl4P15hjV2stf3F9UB/4 Y3iqtsPlAccEGA09xjHpJK5wCPQ7T75Ndh7mIioilda5m5JjVuTAGxiYxk2tLKd643FjnJoO8jXn3vjTkiMkGf //B9I86mt9wj2gNVaCQcQjHIxQkKjMjJP0qn4Um3h8DgYCgmiuXjichFLrqp36jxQyJbJAephbZUJSnLTSOzp9Vgwk4z46i6NWH8vx3AkH/VCp8upoTnSN31YWVhLypkgECpJJ+lEvbGjTeonekBpFqon1hpMFclZ+XXZgvuxm9yMEZs1j7GOf77LEID2NHr/sG/C/JRrtdVhXYU429YVeG5RyrDESZ3FDMtV7IzmU6GWGQGz4O3YJJggg1Utefxs7FVRHkPb+KerZfIJaOOWrfi503Zh895usUElDY9PBunukmr7nPP7a/zwxe+JKjPISaInTknovJE24u4uM6HDviI3s/Vycp2QYtjvWTPl14uN38Jf97Wqw5J95g34/HpF4i9nuuruJA5Catj2uHOwS5wS1uO9cW2FILkfcZssE4mo68AkOaJMAxXIUQx85P8pJqzJBnQ5cyHxjbZiUqpp10YfrfFs+ccNbGrMPp9oY0yPNR0eEpZS60yARzHxYTetYLbIJAvbl2avodOBlBLfUteW/tfeeK2PJXEElq3I+7ZfhDr+ZEZEKQu5GFISD7BmHztuSI/1i2A5KsaXI3KzimJzDDDYR0v/oNXdplltAZLbDHvyKH5AEqBm3NUfEDG5nslwMXQRQE0U6E1oG4VU3aNgDyyZllJAsiTIEc0GM/uswPbjhlraaGp1MycSk/uPjRMzugfb810JA=="</code></pre><p>　　猜测这个地方的逻辑正是 RSA 密钥协商。做一些动态调试，得到：</p><pre><code class="language-js">async (_0x205365, _0x6eea42, _0x227762) =&gt; {
      if (
        ((document.title = _0x205365.meta.title),
        -1 !== _0x5e559f.indexOf(_0x205365.path))
      ) {
        return console.log('to.path', _0x205365.path), void _0x227762()
      }
      let local_storage_auth = localStorage.getItem('Authorization')
      const ticket_str = _0x24b86d('ticket')
      if (ticket_str &amp;&amp; !local_storage_auth) {
        const nonce_24 = Object(_0x54bf2a.e)(24)   // 生成 24 字节随机数
        let aes_key = nonce_24.substr(4, 16)
        aes_key = to_hex(aes_key)
        var ticket_obj = { ticket: ticket_str }
        let _ticket_obj = ticket_obj
        return (
          console.log('sendData', _ticket_obj),
          (_ticket_obj = JSON.stringify(_ticket_obj)),
          (_ticket_obj = Object(_0x54bf2a.b)(_ticket_obj, aes_key)),
          void Object(_0x5e516e.d)(_ticket_obj, nonce_24).then((resp) =&gt; {
            console.log('res1', resp)
            resp = Object(_0x54bf2a.a)(resp, aes_key)   // 解密
            console.log('res2', resp)
            resp = JSON.parse(resp)
            console.log('res3', resp)
            '0' == resp.code
              ? (localStorage.setItem(
                  'Authorization',
                  resp.data.Authorization
                ),
                localStorage.setItem('isSchool', '校内'),
                (window.location.search = window.location.search.replace(
                  /ticket=[\d\w-]*/,
                  ''
                )))
              : (console.log('login2 失败 转统一身份认证', resp),
                _0x1d1f98())
          })
        )
      }
      if (
        (ticket_str &amp;&amp;
          local_storage_auth &amp;&amp;
          ((window.location.search = window.location.search.replace(
            /ticket=[\d\w-]*/,
            ''
          )),
          _0x227762()),
        !local_storage_auth)
      ) {
        return _0x5f4c24(), void _0x227762()
      }
      if (_0x5bd004.a.state.hasKey) {
        return void _0x227762()
      }
      let random_bytes = Object(_0x54bf2a.e)(24),   // 生成 24 字节随机数
        key = random_bytes.substr(4, 16)
      key = to_hex(key)
      var token_obj = { token: local_storage_auth }
      let _token_obj = token_obj
      _token_obj = JSON.stringify(_token_obj)
      _token_obj = Object(_0x54bf2a.b)(_token_obj, key)   // AES 加密
      window.location.href.includes('mock') &amp;&amp;
        ((random_bytes = 'TBPf7wMVX27NXkSSnX7Grk8v'),
        (key = '7wMVX27NXkSSnX7G'),
        (key = to_hex(key)),
        (local_storage_auth = '7755ccc9d58d8bea8a8d580f0147a974'),
        (_token_obj = '{"token":"7755ccc9d58d8bea8a8d580f0147a974"}'))
      await Object(_0x5e516e.g)(_token_obj, random_bytes)
        .then((resp) =&gt; {
          if (
            ((resp = Object(_0x54bf2a.a)(resp, key)),
            (resp = JSON.parse(resp)),
            0 !== resp.code)
          ) {
            return '校外人员' === localStorage.getItem('isSchool')
              ? void (window.location.href = '#/external-users')
              : void _0x5f4c24()
          }
          _0x5bd004.a.state.pk =
            '-----BEGIN PUBLIC KEY-----' +
            resp.data.publicKey +
            '-----END PUBLIC KEY-----'
          _0x5bd004.a.state.priK =
            '-----BEGIN PRIVATE KEY-----' +
            resp.data.privateKey +
            '-----END PRIVATE KEY-----'
          _0x5bd004.a.state.hasKey = true
          _0x227762()
        })
        .catch((err) =&gt; {
          console.log('catch', err)
        })
    })</code></pre><p>　　于是，我们终于发现了公钥的生成方式：</p><ol><li>假如 <code>localStorage</code> 里面没有 Authorization 字段，则先通过 ticket 生成一个 auth code 并写入 <code>localStorage</code></li><li>生成一个 20 字节长度的 <code>random_bytes</code>，取后 16 个字节作为 AES key</li><li>对 auth code 进行 AES 加密，发送给服务端。<br><strong>这条 HTTP 请求的 header 中，有一个 <code>randomCode</code> 字段，即 <code>random_bytes</code></strong></li><li>服务端用同一个 AES key 加密 pubkey，返回给客户端</li></ol><p>　　<strong>这个通讯过程显然不是密码学安全的。</strong>攻击者只需从 HTTP header 中拿到 20 字节的 <code>randomCode</code> ，取后 16 位即为 AES key，接下来便能解密出 auth code。</p><p>　　那么，我们想要获取 pubkey，只需要掏出 auth code，以上述方式向服务器发包，即可获取服务器的 pubkey，进而便能伪装成 js 客户端向服务器发送请求。于是我们面临最后一个问题：如何获取 auth code？</p><h3 id="0x05-auth-code-%E4%BB%8E%E4%BD%95%E5%A4%84%E6%9D%A5%EF%BC%9F">0x05 auth code 从何处来？</h3><p>　　上一段代码里面已经发现，auth code 是通过 ticket 生成的。具体而言，js 向服务器提交 ticket，服务器返回一个 auth code，客户端将其保存进浏览器的 <code>localStorage</code>；以后与服务端通讯的时候，会带一个名为 <code>Authorization</code> 的 HTTP header。</p><p>　　那么，ticket 又是从何而来的？我们重新从登录过程开始抓一次包，发现 ticket 是哈工大统一身份认证系统（IDS）返回的。具体而言：</p><ol><li>用户向预约系统服务器请求登录，预约系统服务器将用户重定向到 IDS</li><li>IDS 接受用户登录，登陆完成之后将用户重定向到预约系统的 <code>/?ticket=ST-xxxx-xxxxx-xx</code> 位置</li><li>js 从 url 中看到 ticket，于是请预约系统服务器给出 auth code</li></ol><p>　　js 请服务器给出 auth code 的通讯过程，与请求 pubkey 的过程是一模一样的。至此我们分析完毕，可以写一个 Python 脚本来伪装成合法客户端，去与服务器通讯了。</p><h3 id="0x06-%E9%AA%8C%E8%AF%81">0x06 验证</h3><p>　　编写通讯脚本，对 <code>/school/api/place/time/area2</code> 进行 POST，查询 3 月 17 日 18:00 时段的乒乓球场占用情况：</p><pre><code class="language-json">{
  "placeId": 90,
  "sportId": 13,
  "date": "2023-03-17",
  "startTime": "18:00",
  "endTime": "19:30"
}
</code></pre><p>　　服务端返回请求：</p><pre><code class="language-json">{
    "code":0,
    "data":{
        "price":0.00,
        "allowbundling":1,
        "endtime":"19:30",
        "begintime":"18:00",
        "surplusNum":7,
        "state":1,
        "usedNum":11
    },
    "msg":"success."
}</code></pre><p>　　可见我们确实达成了目的。</p><h3 id="0x07-%E6%80%BB%E7%BB%93">0x07 总结</h3><p>　　在渗透测试时，笔者采用了人眼反混淆的方式，浪费了几个小时的时间。当时应该去寻找自动 js 反混淆工具。</p><p>　　网站开发者有一定的密码学基础，客户端向服务端发送的数据是安全的；但服务端返回的数据并不安全。</p><p>　　这是笔者第一次做 js 反混淆，感到动态调试的作用相当大。与之类似地，二进制可执行文件的逆向工程也常常可以通过动态调试获取到一些关键线索。</p>
                </div>
            </section>


            <div id="gitalk-container"></div>

            <link rel="stylesheet" href="https://cdn.staticfile.org/gitalk/1.6.2/gitalk.css">
            <script src="https://cdn.staticfile.org/gitalk/1.6.2/gitalk.min.js"></script>

            <script>
                const gitalk = new Gitalk({

                    proxy: 'https://cors.pion1eer.workers.dev/?https://github.com/login/oauth/access_token',

                    clientID: '9f7e67174f5ab8b1a2b9',
                    clientSecret: 'ddee425a0b50ed02a05fdedb1a4ea039e01b3170',
                    repo: 'blogComment',
                    owner: 'Ruanxingzhi',
                    admin: ['Ruanxingzhi'],
                    id: location.pathname,      // Ensure uniqueness and length less than 50
                    distractionFreeMode: false  // Facebook-like distraction free mode

                    });

                gitalk.render('gitalk-container');
            </script>

        </article>

    </div>
</main>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
                <article class="read-next-card">
                    <header class="read-next-card-header">
                        <h3><span>More in</span> <a href="../tag/reverse/index.html">reverse</a></h3>
                    </header>
                    <div class="read-next-card-content">
                        <ul>
                            <li>
                                <h4><a href="../airserver-reverse/index.html">AirServer 5.6.3.0 逆向工程</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="2022-02-27">27 Feb 2022</time> –
                                        19 min read</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="../tag/reverse/index.html">1 post
                            →</a>
                    </footer>
                </article>

                <article class="post-card post tag-fuzzing ">

    <a class="post-card-image-link" href="../afl-source-1/index.html">
        <img class="post-card-image"
            srcset="../content/images/size/w300/2023/05/output-2.jpg 300w,
                    ../content/images/size/w600/2023/05/output-2.jpg 600w,
                    ../content/images/size/w1000/2023/05/output-2.jpg 1000w,
                    ../content/images/size/w2000/2023/05/output-2.jpg 2000w"
            sizes="(max-width: 1000px) 400px, 700px"
            src="../content/images/size/w600/2023/05/output-2.jpg"
            alt="AFL源码阅读（一）：启程"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../afl-source-1/index.html">

            <header class="post-card-header">
                    <div class="post-card-primary-tag">Fuzzing</div>
                <h2 class="post-card-title">AFL源码阅读（一）：启程</h2>
            </header>

            <section class="post-card-excerpt">
                    <p>开始阅读 AFL 的源码。本文分析了 AFL 项目的文件结构，确定了阅读代码的顺序，并详细解释了 afl-gcc 和 afl-as 代码。</p>
            </section>

        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
            
                    <div class="author-name-tooltip">
                        Ruan Xingzhi
                    </div>
            
                    <a href="../author/blue/index.html" class="static-avatar">
                        <img class="author-profile-image" src="../content/images/size/w100/2020/05/blue.jpeg" alt="Ruan Xingzhi" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../author/blue/index.html">Ruan Xingzhi</a></span>
                <span class="post-card-byline-date"><time datetime="2023-05-07">7 May 2023</time> <span class="bull">&bull;</span> 25 min read</span>
            </div>
        </footer>

    </div>

</article>

                <article class="post-card post tag-oi ">

    <a class="post-card-image-link" href="../how-to-teach-oi/index.html">
        <img class="post-card-image"
            srcset="../content/images/size/w300/2023/02/output-6.jpg 300w,
                    ../content/images/size/w600/2023/02/output-6.jpg 600w,
                    ../content/images/size/w1000/2023/02/output-6.jpg 1000w,
                    ../content/images/size/w2000/2023/02/output-6.jpg 2000w"
            sizes="(max-width: 1000px) 400px, 700px"
            src="../content/images/size/w600/2023/02/output-6.jpg"
            alt="OI 教育漫谈（三）：如何教好基础算法"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="../how-to-teach-oi/index.html">

            <header class="post-card-header">
                    <div class="post-card-primary-tag">oi</div>
                <h2 class="post-card-title">OI 教育漫谈（三）：如何教好基础算法</h2>
            </header>

            <section class="post-card-excerpt">
                    <p>「OI 教育漫谈」系列的第三篇。分享 OI 教学的若干经验，为基础算法教师提供指导。</p>
            </section>

        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
            
                    <div class="author-name-tooltip">
                        Ruan Xingzhi
                    </div>
            
                    <a href="../author/blue/index.html" class="static-avatar">
                        <img class="author-profile-image" src="../content/images/size/w100/2020/05/blue.jpeg" alt="Ruan Xingzhi" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="../author/blue/index.html">Ruan Xingzhi</a></span>
                <span class="post-card-byline-date"><time datetime="2023-02-02">2 Feb 2023</time> <span class="bull">&bull;</span> 22 min read</span>
            </div>
        </footer>

    </div>

</article>
        </div>
    </div>
</aside>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="../index.html">Pion1eer</a> &copy; 2023</section>
                <nav class="site-footer-nav">
                    <a href="http://beian.miit.gov.cn/" target="_blank">湘ICP备20008720号-1</a>
                    <a href="../index.html">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

<!--

    <div class="subscribe-success-message">
        <a class="subscribe-close" href="javascript:;"></a>
        You've successfully subscribed to Pion1eer!
    </div>

    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-close" href="#"></a>
        <div class="subscribe-overlay-content">
            <div class="subscribe-form">
                <h1 class="subscribe-overlay-title">Subscribe to Pion1eer</h1>
                <p class="subscribe-overlay-description">Stay up to date! Get all the latest & greatest posts delivered straight to your inbox</p>
                <form data-members-form="subscribe">
                    <div class="form-group">
                        <input class="subscribe-email" data-members-email placeholder="youremail@example.com"
                            autocomplete="false" />
                        <button class="button primary" type="submit">
                            <span class="button-content">Subscribe</span>
                            <span class="button-loader"><svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
    y="0px" width="40px" height="40px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve">
    <path opacity="0.2" fill="#000" d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946
s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634
c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z" />
    <path fill="#000" d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0
C22.32,8.481,24.301,9.057,26.013,10.047z">
        <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 20 20" to="360 20 20"
            dur="0.5s" repeatCount="indefinite" />
    </path>
</svg></span>
                        </button>
                    </div>
                    <div class="message-success">
                        <strong>Great!</strong> Check your inbox and click the link to confirm your subscription.
                    </div>
                    <div class="message-error">
                        Please enter a valid email address!
                    </div>
                </form>
            </div>
        </div>
    </div>

-->

    <script
        src="https://cdn.ruanx.net/js/jquery.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
        crossorigin="anonymous">
    </script>
    <script src="../assets/built/casper%EF%B9%96v=792c672b3c.js"></script>

    <script>
        // Parse the URL parameter
        function getParameterByName(name, url) {
            if (!url) url = window.location.href;
            name = name.replace(/[\[\]]/g, "\\$&");
            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
            if (!results) return null;
            if (!results[2]) return '';
            return decodeURIComponent(results[2].replace(/\+/g, " "));
        }

        // Give the parameter a variable name
        var action = getParameterByName('action');

        $(document).ready(function () {
            if (action == 'subscribe') {
                $('body').addClass("subscribe-success");
            }

            $('.subscribe-success-message .subscribe-close').click(function () {
                $('.subscribe-success-message').addClass('close');
            });

            // Reset form on opening subscrion overlay
            $('.subscribe-button').click(function() {
                $('.subscribe-overlay form').removeClass();
                $('.subscribe-email').val('');
            });
        });
    </script>

    <script>
    $(document).ready(function () {
        // FitVids - start
        var $postContent = $(".post-full-content");
        $postContent.fitVids();
        // FitVids - end

        // Replace nav with title on scroll - start
        Casper.stickyNavTitle({
            navSelector: '.site-nav-main',
            titleSelector: '.post-full-title',
            activeClass: 'nav-post-title-active'
        });
        // Replace nav with title on scroll - end

        // Hover on avatar
        var hoverTimeout;
        $('.author-list-item').hover(function () {
            var $this = $(this);

            clearTimeout(hoverTimeout);

            $('.author-card').removeClass('hovered');
            $(this).children('.author-card').addClass('hovered');

        }, function () {
            var $this = $(this);

            hoverTimeout = setTimeout(function () {
                $this.children('.author-card').removeClass('hovered');
            }, 800);
        });
    });
</script>

<script src="https://cdn.staticfile.org/highlight.js/10.1.1/highlight.min.js"></script>
<script >hljs.initHighlightingOnLoad();</script>



    <style>.kg-bookmark-metadata > .kg-bookmark-publisher:before {
    content: "" !important; 
    margin: 0 !important;
}
</style>

</body>
</html>
