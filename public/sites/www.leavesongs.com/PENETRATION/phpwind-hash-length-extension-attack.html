

<html class="no-js">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="keywords" content="" />
    <meta name="description" content="phith0n的小站，长期存在与分享关于网络安全与各种编程的原创文章。" />
    <title>phpwind 利用哈希长度扩展攻击进行getshell | 离别歌</title>
    <link rel="alternate" type="application/atom+xml" href="../feed/index.rss" title="离别歌" />
    <link href="../static/deep/css/base.css" rel="stylesheet" type="text/css" />
    <link href="../static/deep/css/style.css" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="../static/deep/images/favicon.ico" />
    
<style>div.row .col-xs-4 {
  float: left;
  margin-left: 4px;
}
div.row .col-xs-4 img {
  margin-left: 5px;
}
</style>
<link href="https://cdn.staticfile.org/fancybox/2.1.7/css/jquery.fancybox.min.css" rel="stylesheet">
<link rel="stylesheet" href="../static/deep/css/code.css">

</head>
<body>
<!--[if lt IE 8]>
    <div class="browsehappy" role="dialog">当前网页 <strong>不支持</strong> 你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.</div>
<![endif]-->
<div id="header">
    <div class="container">
        <h1 class="h1-title">
            <a href="../index.html">
               <img src="../static/deep/images/logo.png" alt="离别歌" />
            </a>
        </h1>
        <div id="nav">
        <input type="checkbox" id="button">
        <label for="button" onclick>菜单</label>
        
        <ul>
            
            <li class="item ">
                <a href="../index.html" >首页</a>
            </li>
            
            <li class="item ">
                <a href="../list/index.html" >文章</a>
            </li>
            
            <li class="item ">
                <a href="../other/tinger.html" >关于</a>
            </li>
            
            <li class="item ">
                <a href="../other/friends-link.html" >友链</a>
            </li>
            
            <li class="item ">
                <a href="https://github.com/phith0n" target="_blank" >项目</a>
            </li>
            
            <li class="item ">
                <a href="https://www.leavesongs.com/PENETRATION/code-auditor-secret-group.html" target="_blank" >代码审计</a>
            </li>
            
        </ul>
        
        </div>
    </div>
</div>

<div class="banner-bar">
    <div class="container">
        <div class="col-12 columns">
            <div class="place">
                <a href="../index.html">首页</a>
                &raquo;
                
                网络安全 &raquo; <a href="phpwind-hash-length-extension-attack.html">phpwind 利用哈希长度扩展攻击进行getshell</a>
                
            </div>
        </div>
    </div>
</div>
<div class="container">
    <div class="col-11 columns" id="mainbody" role="main">
        <div class="post-single type-post">
            <h1 class="article-h1">phpwind 利用哈希长度扩展攻击进行getshell</h1>
            <div class="details-up">
  <span class="author">作者: None</span>
  
  <span class="category">分类: <a href="../sort/PENETRATION.html">网络安全</a></span>
  
  <span class="date">时间: 2016-5-24 8:33</span>
  <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl" href="#reply-list">18条评论</a></span>
  <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl" href="phpwind-hash-length-extension-attack.html">26826人看过</a></span>
  
  <span class="date">标签:
    
        <a href="../tag/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB.html">哈希长度扩展攻击</a>
    
        <a href="../tag/phpwind.html">phpwind</a>
    
        <a href="../tag/getshell.html">getshell</a>
    
  </span>
  
</div>
            <div class="entry">
                <p>一哥新发的漏洞，还是蛮屌的： <a href="http://www.wooyun.org/bugs/wooyun-2016-0210850"><a href="http://www.wooyun.org/bugs/wooyun-2016-0210850">http://www.wooyun.org/bugs/wooyun-2016-0210850</a></a>。分析补丁（ <a href="http://www.phpwind.net/read/3709549"><a href="http://www.phpwind.net/read/3709549">http://www.phpwind.net/read/3709549</a></a> ）加上一些风闻，我得知利用的是哈希长度扩展攻击。之前CTF中经常出境的MD5 Length Extension Attack，终于在实战中露了一次面。</p>
<p>今晚基本没睡觉，一直在调试这个漏洞，虽说不知道一哥后续getshell用的是什么方法，但我这个文章基本把该漏洞的原理讲清楚了。至于getshell的话，等漏洞公开了再看看吧。</p>
<h2 id="0x01"><a class="toclink" href="#0x01">0x01 漏洞点分析</a></h2>
<p>phpwind逻辑太冗杂了，一看就是java程序员开发的。</p>
<p>补丁文件修补了src/windid/service/base/WindidUtility.php的appKey函数。之前的appKey函数如下：</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">public</span> <span class="k">static</span> <span class="k">function</span> <span class="nf">appKey</span><span class="p">(</span><span class="nv">$apiId</span><span class="p">,</span> <span class="nv">$time</span><span class="p">,</span> <span class="nv">$secretkey</span><span class="p">,</span> <span class="nv">$get</span><span class="p">,</span> <span class="nv">$post</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 注意这里需要加上__data，因为下面的buildRequest()里加了。</span>
    <span class="nv">$array</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;windidkey&#39;</span><span class="p">,</span> <span class="s1">&#39;clientid&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;_json&#39;</span><span class="p">,</span> <span class="s1">&#39;jcallback&#39;</span><span class="p">,</span> <span class="s1">&#39;csrf_token&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;Filename&#39;</span><span class="p">,</span> <span class="s1">&#39;Upload&#39;</span><span class="p">,</span> <span class="s1">&#39;token&#39;</span><span class="p">,</span> <span class="s1">&#39;__data&#39;</span><span class="p">);</span>
    <span class="nv">$str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="nb">ksort</span><span class="p">(</span><span class="nv">$get</span><span class="p">);</span>
    <span class="nb">ksort</span><span class="p">(</span><span class="nv">$post</span><span class="p">);</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$get</span> <span class="k">AS</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$k</span><span class="p">,</span> <span class="nv">$array</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>
        <span class="nv">$str</span> <span class="o">.=</span><span class="nv">$k</span><span class="o">.</span><span class="nv">$v</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$post</span> <span class="k">AS</span> <span class="nv">$k</span><span class="o">=&gt;</span><span class="nv">$v</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">in_array</span><span class="p">(</span><span class="nv">$k</span><span class="p">,</span> <span class="nv">$array</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>
        <span class="nv">$str</span> <span class="o">.=</span><span class="nv">$k</span><span class="o">.</span><span class="nv">$v</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">md5</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$apiId</span><span class="o">.</span><span class="s1">&#39;||&#39;</span><span class="o">.</span><span class="nv">$secretkey</span><span class="p">)</span><span class="o">.</span><span class="nv">$time</span><span class="o">.</span><span class="nv">$str</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>可见，这里其实是一个『签名』函数，将GET、POST变量使用secrectkey进行签名，但签名的算法比较古老，直接用md5。</p>
<p>我们可以看看道哥在09年发的一篇博客： <a href="http://blog.chinaunix.net/uid-27070210-id-3255947.html"><a href="http://blog.chinaunix.net/uid-27070210-id-3255947.html">http://blog.chinaunix.net/uid-27070210-id-3255947.html</a></a></p>
<p>其中详尽的说明了哈希长度扩展攻击的原理及利用方法（所以我文章就不细说了），总结起来其实就一句话：</p>
<blockquote>
<p><strong>当知道 MD5(secret) 时，在不知道secret的情况下，可以很轻易的推算出 MD5(secret||padding||m')</strong></p>
</blockquote>
<p>当前phpwind的签名算法刚好符合上述的格式 <code>md5(md5($apiId.'||'.$secretkey).$time.$str)</code>。我们虽然不知道<code>md5($apiId.'||'.$secretkey)</code>，但<code>$time</code>和<code>$str</code>是可控的，可以进行哈希长度扩展攻击。</p>
<h2 id="0x02"><a class="toclink" href="#0x02">0x02 寻找已知哈希</a></h2>
<p>根据哈希长度扩展攻击的原理，也就是 <code>MD5(secret) --&gt; MD5(secret||padding||m')</code>，我们就需要先找到一个已知的secret。</p>
<p>src/windid/service/user/srv/WindidUserService.php showFlash函数：</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">showFlash</span><span class="p">(</span><span class="nv">$uid</span><span class="p">,</span> <span class="nv">$appId</span><span class="p">,</span> <span class="nv">$appKey</span><span class="p">,</span> <span class="nv">$getHtml</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$time</span> <span class="o">=</span> <span class="nx">Pw</span><span class="o">::</span><span class="na">getTime</span><span class="p">();</span>
    <span class="nv">$key</span> <span class="o">=</span> <span class="nx">WindidUtility</span><span class="o">::</span><span class="na">appKey</span><span class="p">(</span><span class="nv">$appId</span><span class="p">,</span> <span class="nv">$time</span><span class="p">,</span> <span class="nv">$appKey</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;uid&#39;</span><span class="o">=&gt;</span><span class="nv">$uid</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;flash&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;api&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;doAvatar&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;avatar&#39;</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;uid&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;undefined&#39;</span><span class="p">));</span>
    <span class="nv">$key2</span> <span class="o">=</span> <span class="nx">WindidUtility</span><span class="o">::</span><span class="na">appKey</span><span class="p">(</span><span class="nv">$appId</span><span class="p">,</span> <span class="nv">$time</span><span class="p">,</span> <span class="nv">$appKey</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;uid&#39;</span><span class="o">=&gt;</span><span class="nv">$uid</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;api&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;doAvatar&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;avatar&#39;</span><span class="p">),</span> <span class="k">array</span><span class="p">());</span>

    <span class="nv">$postUrl</span> <span class="o">=</span> <span class="s2">&quot;postAction=ra_postAction&amp;redirectURL=/&amp;requestURL=&quot;</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nx">Wekit</span><span class="o">::</span><span class="na">app</span><span class="p">(</span><span class="s1">&#39;windid&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">url</span><span class="o">-&gt;</span><span class="na">base</span> <span class="o">.</span> <span class="s2">&quot;/index.php?m=api&amp;c=avatar&amp;a=doAvatar&amp;uid=&quot;</span> <span class="o">.</span> <span class="nv">$uid</span> <span class="o">.</span> <span class="s1">&#39;&amp;windidkey=&#39;</span> <span class="o">.</span> <span class="nv">$key</span> <span class="o">.</span> <span class="s1">&#39;&amp;time=&#39;</span> <span class="o">.</span> <span class="nv">$time</span> <span class="o">.</span> <span class="s1">&#39;&amp;clientid=&#39;</span> <span class="o">.</span> <span class="nv">$appId</span> <span class="o">.</span> <span class="s1">&#39;&amp;type=flash&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&amp;avatar=&#39;</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getAvatar</span><span class="p">(</span><span class="nv">$uid</span><span class="p">,</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;?r=&#39;</span> <span class="o">.</span> <span class="nb">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">99999</span><span class="p">));</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>


<p>这里调用了WindidUtility::appKey生成key，并将这个key放入了url中。其实这个功能是前台用户头像上传，我们来到 <a href="http://10.211.55.3/phpwind/index.php?m=profile&amp;c=avatar&amp;_left=avatar"><a href="http://10.211.55.3/phpwind/index.php?m=profile&amp;c=avatar&amp;_left=avatar">http://10.211.55.3/phpwind/index.php?m=profile&amp;c=avatar&amp;_left=avatar</a></a> 右键源码即可查看到当前的key:</p>
<p><a href="../content/uploadfile/201605/6d281464050082.jpg"><img alt="14640455257307.jpg" src="../content/uploadfile/201605/thum-6d281464050082.jpg" title="点击查看原图" /></a></p>
<p>这个key，实际上是通过如下计算获得：</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nv">$get</span> <span class="o">=</span> <span class="nx">some_sort</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;uid&#39;</span><span class="o">=&gt;</span><span class="nv">$uid</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;flash&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;api&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;doAvatar&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;avatar&#39;</span><span class="p">));</span>
<span class="nv">$post</span> <span class="o">=</span> <span class="nx">some_sort</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;uid&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;undefined&#39;</span><span class="p">));</span>
<span class="nb">md5</span><span class="p">(</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$apiId</span><span class="o">.</span><span class="s1">&#39;||&#39;</span><span class="o">.</span><span class="nv">$secretkey</span><span class="p">)</span> <span class="o">.</span> <span class="nb">time</span><span class="p">()</span> <span class="o">.</span> <span class="nv">$get</span> <span class="o">.</span> <span class="nv">$post</span> <span class="p">)</span> 
</pre></div>


<p>也就是说，此时的secret其实是 <code>md5($apiId.'||'.$secretkey) . time() . $get . $post</code>，大概类似<code>md5(...) + 1464044063adoAvatarcavatarmapitypeflashuid2uidundefined</code><br />
在哈希长度扩展攻击中，我们是不需要知道这个secret的值的，只需要知道它的长度，上面这个字符串的长度很好算，md5固定32位，time时间戳10位，get和post两个数组也是固定的。<br />
所以，经过计算，uid=2的用户获得的secret长度为55位。</p>
<h2 id="0x03"><a class="toclink" href="#0x03">0x03 进行扩展攻击</a></h2>
<p>公式： <code>MD5(secret) --&gt; MD5(secret||padding||m')</code>，我们已经知道了MD5(secret)和secret的长度（55），现在可以推MD5(secret||padding||m')了。</p>
<p>因为secret的值为<code>md5(...) + 1464044063adoAvatarcavatarmapitypeflashuid2uidundefined</code>，所以下次增加的padding和m'必须放在1464044063adoAvatarcavatarmapitypeflashuid2uidundefined后面。</p>
<p>我们需要推导并绕过的是如下函数 src/applications/windidserver/api/controller/OpenBaseController.php beforeAction函数：</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">public</span>  <span class="k">function</span> <span class="nf">beforeAction</span><span class="p">(</span><span class="nv">$handlerAdapter</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">parent</span><span class="o">::</span><span class="na">beforeAction</span><span class="p">(</span><span class="nv">$handlerAdapter</span><span class="p">);</span>
    <span class="nv">$charset</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">;</span>
    <span class="nv">$_windidkey</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getInput</span><span class="p">(</span><span class="s1">&#39;windidkey&#39;</span><span class="p">,</span> <span class="s1">&#39;get&#39;</span><span class="p">);</span>
    <span class="nv">$_time</span> <span class="o">=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getInput</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;get&#39;</span><span class="p">);</span>
    <span class="nv">$_clientid</span> <span class="o">=</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getInput</span><span class="p">(</span><span class="s1">&#39;clientid&#39;</span><span class="p">,</span> <span class="s1">&#39;get&#39;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$_time</span> <span class="o">||</span> <span class="o">!</span><span class="nv">$_clientid</span><span class="p">)</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="nx">WindidError</span><span class="o">::</span><span class="na">FAIL</span><span class="p">);</span>
    <span class="nv">$clent</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_getAppDs</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getApp</span><span class="p">(</span><span class="nv">$_clientid</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$clent</span><span class="p">)</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="nx">WindidError</span><span class="o">::</span><span class="na">FAIL</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">WindidUtility</span><span class="o">::</span><span class="na">appKey</span><span class="p">(</span><span class="nv">$clent</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="nv">$_time</span><span class="p">,</span> <span class="nv">$clent</span><span class="p">[</span><span class="s1">&#39;secretkey&#39;</span><span class="p">],</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getRequest</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getGet</span><span class="p">(</span><span class="k">null</span><span class="p">),</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getRequest</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">getPost</span><span class="p">())</span> <span class="o">!=</span> <span class="nv">$_windidkey</span><span class="p">)</span>  <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="nx">WindidError</span><span class="o">::</span><span class="na">FAIL</span><span class="p">);</span>

    <span class="nv">$time</span> <span class="o">=</span> <span class="nx">Pw</span><span class="o">::</span><span class="na">getTime</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$time</span> <span class="o">-</span> <span class="nv">$_time</span> <span class="o">&gt;</span> <span class="mi">1200</span><span class="p">)</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">output</span><span class="p">(</span><span class="nx">WindidError</span><span class="o">::</span><span class="na">TIMEOUT</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">appid</span> <span class="o">=</span> <span class="nv">$_clientid</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>我们看到，这里计算出 <code>WindidUtility::appKey($clent['id'], $_time, $clent['secretkey'], $this-&gt;getRequest()-&gt;getGet(null), $this-&gt;getRequest()-&gt;getPost())</code> 的结果，与传入的windidkey进行比较，如果不相等，则函数报错。</p>
<p>我们需要先构造出1464044063adoAvatarcavatarmapitypeflashuid2uidundefined，才能够在后面增加我们需要的GET和POST值。</p>
<p>所以，我传入time=1464044063，而adoAvatarcavatarmapitypeflashuid2uidundefined作为一个GET数组的键传入。</p>
<p>这样，在appKey函数构造的过程中，就可以人为构造出secret，然后后面的内容就是可以利用的padding，如下图（s是未知的key，t是获取md5时的时间戳，R就是adoAvatarcavatarmapitypeflashuid2uidundefined）：</p>
<p><a href="../content/uploadfile/201605/18231464050083.jpg"><img alt="14640478360329.jpg" src="../content/uploadfile/201605/thum-18231464050083.jpg" title="点击查看原图" /></a></p>
<p>所以，我们构造出类似如下的数据包：</p>
<p><a href="../content/uploadfile/201605/711e1464050084.jpg"><img alt="14640481720300.jpg" src="../content/uploadfile/201605/thum-711e1464050084.jpg" title="点击查看原图" /></a></p>
<p>此时后端进行的加密如下：</p>
<div class="codehilite"><pre><span></span>MD5( key + 1464048076 + adoAvatarcavatarmapitypeflashuid2uidundefined + %80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%B8%02%00%00%00%00%00%00 + sort(a=get&amp;c=app&amp;m=api&amp;id=1) )
</pre></div>


<p>我之前获取的secret如下：</p>
<div class="codehilite"><pre><span></span>MD5( key + 1464048076 + adoAvatarcavatarmapitypeflashuid2uidundefined )
</pre></div>


<p>正好满足哈希长度扩展攻击的条件，成功绕过beforeAction中的验证。</p>
<h2 id="0x04-getshell"><a class="toclink" href="#0x04-getshell">0x04 获取敏感信息 + 修改管理员密码 + getshell</a></h2>
<p>我绕过了beforeAction的验证，其实效果类似于绕过了discuz中UC_KEY的验证过程。拿到了UC_KEY，就可以构造为任意用户做其权限（甚至是管理员权限）下的很多事情。<br />
比如，获取敏感信息：</p>
<p><a href="../content/uploadfile/201605/59961464050085.jpg"><img alt="14640484775768.jpg" src="../content/uploadfile/201605/thum-59961464050085.jpg" title="点击查看原图" /></a></p>
<p>获得所有系统配置信息（包括cookie加密的密钥）：</p>
<p><a href="../content/uploadfile/201605/f8c41464050087.jpg"><img alt="14640486498469.jpg" src="../content/uploadfile/201605/thum-f8c41464050087.jpg" title="点击查看原图" /></a></p>
<p>我写了一个脚本用来生成payload，我就不公开了。看懂的人自然会写，看不懂的人好好琢磨琢磨：</p>
<p><a href="../content/uploadfile/201605/25471464050088.jpg"><img alt="14640495312072.jpg" src="../content/uploadfile/201605/thum-25471464050088.jpg" title="点击查看原图" /></a></p>
<p>另外，利用该方法可以修改所有系统配置、增删改APP、增删改查用户、修改用户密码等等。phpwind有个奇怪的逻辑，其管理员分为『创始人』和『管理员』，而创始人如果要登录后台，需要一个保存在文件中的账号密码，而管理员登录后台需要的是数据库中的账号密码。</p>
<p>这个漏洞只能修改数据库中的账号密码，所以无法修改创始人的后台账号，但管理员权限也就够了，配合我之前发的phpwind后台getshell（ <a href="http://www.wooyun.org/bugs/wooyun-2010-0175815"><a href="http://www.wooyun.org/bugs/wooyun-2010-0175815">http://www.wooyun.org/bugs/wooyun-2010-0175815</a></a> ），即可完美拿下。</p>
            </div>
            <div itemprop="keywords" class="tags-meta">
                标签:
                
                    <a href="../tag/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB.html">哈希长度扩展攻击</a>
                
                    <a href="../tag/phpwind.html">phpwind</a>
                
                    <a href="../tag/getshell.html">getshell</a>
                
            </div>
            <br>
<!--MOB SHARE BEGIN-->
<div class="-mob-share-ui-button -mob-share-open">分享</div>
<div class="-mob-share-ui" style="display: none">
    <ul class="-mob-share-list">
        <li class="-mob-share-weibo"><p>新浪微博</p></li>
        <li class="-mob-share-qzone"><p>QQ空间</p></li>
        <li class="-mob-share-qq"><p>QQ好友</p></li>
        <li class="-mob-share-weixin"><p>微信</p></li>
        <li class="-mob-share-douban"><p>豆瓣</p></li>
        <li class="-mob-share-facebook"><p>Facebook</p></li>
        <li class="-mob-share-twitter"><p>Twitter</p></li>
        <li class="-mob-share-pocket"><p>Pocket</p></li>
        <li class="-mob-share-google"><p>Google+</p></li>
        <li class="-mob-share-youdao"><p>有道云笔记</p></li>
        <li class="-mob-share-mingdao"><p>明道</p></li>
        <li class="-mob-share-tumblr"><p>Tumblr</p></li>
        <li class="-mob-share-instapaper"><p>Instapaper</p></li>
        <li class="-mob-share-linkedin"><p>LinkedIn</p></li>
    </ul>
    <div class="-mob-share-close">取消</div>
</div>
<div class="-mob-share-ui-bg"></div>
<script id="-mob-share" src="https://f1.webshare.mob.com/code/mob-share.js?appkey=af155d9007c8"></script>
<!--MOB SHARE END-->

        <div class="qqlist">
          <h3>订阅本站<small>(RSS)</small></h3>
          <form method="post" target="_blank" action="https://list.qq.com/cgi-bin/qf_compose_send">
          <input type="hidden" value="qf_booked_feedback" name="t" />
          <input type="hidden" value="dace5c2b356504de449e7f3fc2bb59f3f6124d6563786446" name="id" />
          <input type="text" placeholder="E-mail" value="" class="rsstxt" name="to" id="to" />
          <button type="submit" >订阅&rarr;</button>
          </form>
        </div>


        </div>

        
        <div class="post-single type-post text-center">
            <h3 style="margin-top: 0">喜欢这篇文章，扫码和我成为赞友！</h3>
            <img src="../static/wx.jpg" width="280" alt="">
        </div>
        

        <!-- 评论位置 -->
        <div id="comments" class="comments">
          <h3>已有 18 条评论</h3>
            <ol class="comment-list">
            
            
              <li class="comment-body" id="comment-2354">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/9ac84ffb9a6dbd4364250491e518ec6a.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">xxlegend</a></div>
                    <p>请教：我使用md5 length Extension attack poc的时候校验的md5值不对，这里面有什么限制因素吗？我在chrome上的输出如下：<br>=== MD5 Length Extension Attack POC ====== by axis ===<br>[+] secret is :0.7104842912105351[+] length is :18<br>[+] message want to append is :axis is smart!<br>[+] Start calculating secret&#x27;s hash<br>[+] Calculate secret&#x27;s md5 hash: E1DD22A37AC6D24F6F1650DE1D5C7125<br>================================<br>[+] Start calculating new hash<br>[+] theory: h(m||p||m1)<br>[+] that is: md5_compression_function(&#x27;E1DD22A37AC6D24F6F1650DE1D5C7125&#x27;, &#x27;secret&#x27;s length&#x27;, &#x27;axis is smart! &#x27;)<br>run times: 1h3: -549672650h2: 1411096006h1: 377315664h0: 979963726run times: 1<br>h3: -549672650<br>h2: 1411096006<br>h1: 377315664<br>h0: 979963726<br>[+] padding(urlencode format) is: %80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%90%00%00%00%00%00%00%00<br>[+] guessing new hash is: 4e0f693a50617d16c69d1b5436a93cdf<br>================================<br>[+] now verifying the new hash<br>[+] new message(urlencode format) is: 0.7104842912105351%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%90%00%00%00%00%00%00%00axis%20is%20smart%21%0A<br>md5 of the new message is: 93342C3CCD05FBD7091C2287863278F8</p>
                    <span class="comment-time">时间: 2016-06-08 15:53</span>
                    <span class="comment-reply"><a href="#comment-2354" onclick="reply_to('2354','xxlegend')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2355">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/9ac84ffb9a6dbd4364250491e518ec6a.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">xxlegend</a></div>
                    <p>@xxlegend：手工用python库检测了一下md5值的输出，预测值是准确的，但是调用faultylabs.MD5(x1)的值却是有问题的</p>
                    <span class="comment-time">时间: 2016-06-08 16:24</span>
                    <span class="comment-reply"><a href="#comment-2355" onclick="reply_to('2355','xxlegend')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2356">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/c4267eb6d17276fa31c547ac71611e90.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="../index.html" target="_blank" rel="nofollow noopener">phithon</a></div>
                    <p>@xxlegend：可能是faultylabs.MD5这库使用方法不对吧。<br>建议用 https://github.com/bwall/HashPump ，可以直接生成</p>
                    <span class="comment-time">时间: 2016-06-08 17:44</span>
                    <span class="comment-reply"><a href="#comment-2356" onclick="reply_to('2356','phithon')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2363">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/9ac84ffb9a6dbd4364250491e518ec6a.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">xxlegend</a></div>
                    <p>@phithon：不错，我当时还想python怎么调起js库的呢？</p>
                    <span class="comment-time">时间: 2016-06-12 10:20</span>
                    <span class="comment-reply"><a href="#comment-2363" onclick="reply_to('2363','xxlegend')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2359">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/d5b234984190822adf2f31a4d5a371bb.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="http://joychou.org" target="_blank" rel="nofollow noopener">JoyChou</a></div>
                    <p>@xxlegend：刺文章中的js在验证md5有问题，建议有py版本的，可读性比js强。</p>
                    <span class="comment-time">时间: 2016-06-08 23:51</span>
                    <span class="comment-reply"><a href="#comment-2359" onclick="reply_to('2359','JoyChou')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2351">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/32e93a81618a48e927424e65e8575470.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="http://www.baidu.com" target="_blank" rel="nofollow noopener">菜鸟</a></div>
                    <p>phithon求源码:xiaoqiu19820@163.com</p>
                    <span class="comment-time">时间: 2016-06-07 19:57</span>
                    <span class="comment-reply"><a href="#comment-2351" onclick="reply_to('2351','菜鸟')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2334">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">iant</a></div>
                    <p>请教：我写了一个测试脚本<br>&lt;?php<br>$key = &#x27;safwefdsfsacxww&#x27;;<br><br>//假设a=11,b=22,k=b12a3ff0b11a5ea852840a632f533218<br>//根据提示我算出了padding=%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%98%00%00%00%00%00%00%00<br><br>$k = md5($key.$_GET[&#x27;a&#x27;].$_GET[&#x27;b&#x27;]);<br><br>if($_GET[&#x27;b&#x27;] === &#x27;123456&#x27; &amp;&amp; $k ===$_GET[&#x27;k&#x27;]){<br>	print &#x27;我成功绕过了&lt;/br&gt;&#x27;;<br>}else{<br>	print &#x27;我没有绕过&lt;/br&gt;&#x27;;<br>}<br>?&gt;<br>我请求：?a=1122%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%98%00%00%00%00%00%00%00&amp;b=123456&amp;k=b12a3ff0b11a5ea852840a632f533218<br>根据我自己测试，始终不能成功，我哪里写错了吗？还是我压根就理解错误了？</p>
                    <span class="comment-time">时间: 2016-05-26 17:37</span>
                    <span class="comment-reply"><a href="#comment-2334" onclick="reply_to('2334','iant')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2335">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/c4267eb6d17276fa31c547ac71611e90.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="../index.html" target="_blank" rel="nofollow noopener">phithon</a></div>
                    <p>@iant：第二次计算的md5怎么会和第一次算出来一样呢</p>
                    <span class="comment-time">时间: 2016-05-26 22:18</span>
                    <span class="comment-reply"><a href="#comment-2335" onclick="reply_to('2335','phithon')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2340">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">iant</a></div>
                    <p>@phithon：这里是我忽略了....<br>第二次的K我算出来是26ea8c899d259a02f1ae4b56d6a9213e<br>但是还是不对，能帮我瞅瞅是哪错了吗？<br>这个跟双向MD5加密应该没关系吧？</p>
                    <span class="comment-time">时间: 2016-05-27 16:55</span>
                    <span class="comment-reply"><a href="#comment-2340" onclick="reply_to('2340','iant')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2341">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/c4267eb6d17276fa31c547ac71611e90.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="../index.html" target="_blank" rel="nofollow noopener">phithon</a></div>
                    <p>@iant：$_GET[&#x27;a&#x27;] = urldecode(&quot;1122%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%98%00%00%00%00%00%00%00&quot;);<br>$_GET[&#x27;b&#x27;] = urldecode(&quot;123456&quot;);<br>echo md5($key.$_GET[&#x27;a&#x27;].$_GET[&#x27;b&#x27;]); <br>我算出来可不是26ea8c899d259a02f1ae4b56d6a9213e。</p>
                    <span class="comment-time">时间: 2016-05-27 18:17</span>
                    <span class="comment-reply"><a href="#comment-2341" onclick="reply_to('2341','phithon')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2342">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">iant</a></div>
                    <p>@phithon：感谢，明白了！</p>
                    <span class="comment-time">时间: 2016-05-27 20:10</span>
                    <span class="comment-reply"><a href="#comment-2342" onclick="reply_to('2342','iant')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2333">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/be7765a6f3ae32be6d6a6f68a5929061.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">黑皮</a></div>
                    <p>为什么我利用每次返回的都是 0</p>
                    <span class="comment-time">时间: 2016-05-26 15:54</span>
                    <span class="comment-reply"><a href="#comment-2333" onclick="reply_to('2333','黑皮')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2336">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/c4267eb6d17276fa31c547ac71611e90.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="../index.html" target="_blank" rel="nofollow noopener">phithon</a></div>
                    <p>@黑皮：返回0说明没做对。</p>
                    <span class="comment-time">时间: 2016-05-26 22:18</span>
                    <span class="comment-reply"><a href="#comment-2336" onclick="reply_to('2336','phithon')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2346">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">黑皮</a></div>
                    <p>@phithon：但是我完全复现的博客上的数据，返回还是0</p>
                    <span class="comment-time">时间: 2016-06-01 03:38</span>
                    <span class="comment-reply"><a href="#comment-2346" onclick="reply_to('2346','黑皮')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2347">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">黑皮</a></div>
                    <p>@黑皮：楼上的回复用自己id呀，借用我的id是个什么鬼????</p>
                    <span class="comment-time">时间: 2016-06-01 11:02</span>
                    <span class="comment-reply"><a href="#comment-2347" onclick="reply_to('2347','黑皮')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2348">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/c4267eb6d17276fa31c547ac71611e90.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="../index.html" target="_blank" rel="nofollow noopener">phithon</a></div>
                    <p>@黑皮：完全复现博客里的数据包肯定不对。我讲的是方法，数据包每个网站都不一样。</p>
                    <span class="comment-time">时间: 2016-06-01 14:31</span>
                    <span class="comment-reply"><a href="#comment-2348" onclick="reply_to('2348','phithon')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2332">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/d0746a8862e98489d9438d5faad4a6c6.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">阿呆</a></div>
                    <p>文章中secret的长度应该是87<br>请教：假设POST参数a=get&amp;c=app&amp;m=api&amp;id=1，后台padding我得到是agetcappid1mapi，但是自己扩展后得到的md5和后台生成的不一样？</p>
                    <span class="comment-time">时间: 2016-05-26 10:04</span>
                    <span class="comment-reply"><a href="#comment-2332" onclick="reply_to('2332','阿呆')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2337">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/c4267eb6d17276fa31c547ac71611e90.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="../index.html" target="_blank" rel="nofollow noopener">phithon</a></div>
                    <p>@阿呆：嗯，忘记加md5长度了，利用程序里是自动算的。<br>生成的一样的，不一样怎么绕过验证。。</p>
                    <span class="comment-time">时间: 2016-05-26 22:37</span>
                    <span class="comment-reply"><a href="#comment-2337" onclick="reply_to('2337','phithon')">回复</a></span>
                    </div>
                </div>
              </li>
            
            
            </ol>
            
        </div>

        <div id="reply"></div>
        <div id="comment-place">
            <div id="comment-post" class="respond none-resize">
             <div id="respond">
                <h3 id="response">添加新评论</h3>
                <form method="post" id="comment-form" role="form" action="#comments">
                    <p>
                        <label for="author" class="required">称呼</label>
                        <input type="text" name="nickname" placeholder="昵称" maxlength="64" required id="id_nickname">
                    </p>
                    <p>
                        <label for="mail">Email</label>
                        <input type="text" name="email" placeholder="邮箱（可留空）" maxlength="254" id="id_email">
                    </p>
                    <p>
                        <label for="url">网站</label>
                        <input type="text" name="url" placeholder="链接（可留空）" maxlength="200" id="id_url">
                    </p>
                    <p>
                        <label for="textarea" class="required">内容</label>
                        <textarea name="content" cols="40" rows="6" required id="id_content">
</textarea>
                    </p>
                    <p>
                        <label style="float:left;">验证码</label>
                        <div class="row gx-2" style="margin-top: 8px"><div class="col-6"><input autocomplete="off" id="id_captcha_1" name="captcha_1" type="text" placeholder="验证码" /> <input id="id_captcha_0" name="captcha_0" type="hidden" value="6be301313edb4b5c6b085ccc0cd96730e18a96dc" />
</div><div class="col-6">
<img src="../captcha/image/6be301313edb4b5c6b085ccc0cd96730e18a96dc/index.png" alt="captcha" class="captcha" /></div></div>
                    </p>
                    <p>
                        <button type="submit" class="submit">提交评论</button>
                        <input type="hidden" name="parent" id="id_parent">
                        <input type="hidden" name="archive" value="387" id="id_archive">
                        <input type="hidden" name="csrfmiddlewaretoken" value="ubHwgkxfFnTi5UxIBG4Vj24ozicLReHIgJ5nOp8Y3J71Dsl6DH1Ggv7tUFtWqQT0">
                    </p>
                </form>
                </div>
            </div>
        </div>

    </div>
    



<div  class="col-5 columns" id="sidebar" role="complementary">

  <div class="widget widget_search">
    <h3>搜索</h3>
    <form action="https://www.leavesongs.com/search/" id="searchform" method="get">
        <input type="text" id="searchkey" name="keyword" value="" class="searchkey" placeholder="Search..."/>
        <button type="submit"  id="searchsubmit">Go</button>
    </form>
  </div>

  
  <div class="widget">
	<h3 class="widget-title">最新评论</h3>
	<ul class="widget-list" id="recent-comment">
    
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>木木</cite>：<a href="../THINK/europe-trip-2022.html#comment-4523">虽然物价对比不出什么，但是还是觉得很高昂</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>dongdong4fei</cite>：<a href="../THINK/using-chatgpt-for-antispam.html#comment-4520">肯德基疯狂星期四！ 疯狂星期四！  https://m.kfc.com.cn/wechatco...</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>dongdong4fei</cite>：<a href="../THINK/using-chatgpt-for-antispam.html#comment-4519">小猪咪小猪咪小猪咪</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>sam</cite>：<a href="javascript-prototype-pollution-attack.html#comment-4518">还得是P神，文章一看就懂</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>程序</cite>：<a href="discuz72-sql-injection.html#comment-4517">很不错的文章</a></div>
        </li>
    
    </ul>
  </div>

  <div class="widget widget-category">
	<h3>分类</h3>
	<ul id="blogsort" class="widget-list">
    
    
    <li>
        <a href="../sort/PENETRATION.html">网络安全<em>143</em></a>
    </li>
    
    <li>
        <a href="../sort/C.html">C/C++<em>32</em></a>
    </li>
    
    <li>
        <a href="../sort/THINK.html">心得与体会<em>24</em></a>
    </li>
    
    <li>
        <a href="../sort/PYTHON.html">Python<em>19</em></a>
    </li>
    
    <li>
        <a href="../sort/SHARE.html">资源分享<em>16</em></a>
    </li>
    
    </ul>
  </div>

  <div class="widget widget-tag">
	<h3>随机标签</h3>
	<div class="tag-cloud">
        
        
        <a rel="tag" href="../tag/sqlite3_exec.html">sqlite3_exec</a>
        
        <a rel="tag" href="../tag/%E5%AF%92%E5%81%87.html">寒假</a>
        
        <a rel="tag" href="../tag/2019.html">2019</a>
        
        <a rel="tag" href="../tag/xss%E8%A0%95%E8%99%AB.html">xss蠕虫</a>
        
        <a rel="tag" href="../tag/%E5%91%BD%E4%BB%A4%E8%A1%8C.html">命令行</a>
        
        <a rel="tag" href="../tag/php.html">php</a>
        
        <a rel="tag" href="../tag/CRLF.html">CRLF</a>
        
        <a rel="tag" href="../tag/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E.html">反序列化漏洞</a>
        
        <a rel="tag" href="../tag/VS2010.html">VS2010</a>
        
        <a rel="tag" href="../tag/%E8%B7%A8%E7%9B%AE%E5%BD%95.html">跨目录</a>
        
        <a rel="tag" href="../tag/%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84.html">内存映射</a>
        
        <a rel="tag" href="../tag/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93.html">原型链污染</a>
        
        <a rel="tag" href="../tag/%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E.html">越权漏洞</a>
        
        <a rel="tag" href="../tag/%E9%98%BB%E6%AD%A2%E8%84%9A%E6%9C%AC%E8%BF%90%E8%A1%8C.html">阻止脚本运行</a>
        
        <a rel="tag" href="../tag/%E7%AD%94%E6%A1%88.html">答案</a>
        
        <a rel="tag" href="../tag/django.html">django</a>
        
        <a rel="tag" href="../tag/%E6%96%AD%E7%82%B9%E7%BB%AD%E4%BC%A0.html">断点续传</a>
        
        <a rel="tag" href="../tag/%E9%93%BE%E8%A1%A8.html">链表</a>
        
        <a rel="tag" href="../tag/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2.html">信息泄露</a>
        
        <a rel="tag" href="../tag/getshell.html">getshell</a>
        
        <a rel="tag" href="../tag/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.html">命令执行漏洞</a>
        
        <a rel="tag" href="../tag/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86.html">反向代理</a>
        
        <a rel="tag" href="../tag/360webscan.html">360webscan</a>
        
        <a rel="tag" href="../tag/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8.html">前端安全</a>
        
        <a rel="tag" href="../tag/scrapy.html">scrapy</a>
        
        <a rel="tag" href="../tag/API%E5%87%BD%E6%95%B0.html">API函数</a>
        
        <a rel="tag" href="../tag/%E6%9D%A1%E4%BB%B6%E7%AB%9E%E4%BA%89.html">条件竞争</a>
        
        <a rel="tag" href="../tag/webshell.html">webshell</a>
        
        <a rel="tag" href="../tag/%E8%84%B1%E8%A3%A4.html">脱裤</a>
        
        <a rel="tag" href="../tag/SQL.html">SQL</a>
        
    </div>
  </div>

  <div class="widget widget-recent-entries">
	<h3 class="widget-title">热门日志</h3>
	<ul id="hotlog" class="widget-list">
    
    
        <li><a href="../other/tinger.html">About.Me</a></li>
    
        <li><a href="detect-django.html">如何判断目标站点是否为Django开发</a></li>
    
        <li><a href="webshell-without-alphanum-advanced.html">无字母数字webshell之提高篇</a></li>
    
        <li><a href="webshell-without-alphanum.html">一些不包含数字和字母的webshell</a></li>
    
        <li><a href="php-filter-magic.html">谈一谈php://filter的妙用</a></li>
    
    </ul>
  </div>
  

</div>
</div>

<div id="footer">
	<!-- copyright -->
	<div class="container">
		<div class="row remove-bottom">
			<div class="col-6 columns">
			<h3>Little About</h3>
			<p>Phithon 非强迫症小青年  <br>
现居先 <br>
爱好：种花、买书、收藏明信片 <br>
欢迎各大组织收留 <br>
E-mail：root@leavesongs.com </p>
			</div>

			<div class="col-10 columns">

				<h3 class="mobile-hide">Follow me</h3>
        <div id="social-links">
          <a href="http://weibo.com/101yx" class="sweibo" target="_blank" title="新浪微博">新浪微博</a>
          <a href="javascript:alert(/没有腾讯微博哟/)" class="qweibo" target="_blank" title="腾讯微博">腾讯微博</a>
          <a href="javascript:alert(/墙外有什么/);window.open('http://google.com')" class="google" target="_blank" title="墙外的世界">google+</a>
          <a href="https://github.com/phith0n" class="github" target="_blank" title="Github">github</a>
          <a href="javascript:confirm(/mailto:root#leavesongs.com/)" class="mail" target="_blank" title="私信给我">私信给我</a>
          <a href="../feed/index.rss" target="_blank" class="rss" title="离别歌">RSS订阅</a>
        </div>
        <div class="bot-line"></div>
				<p class="copyright">
	Copyright &copy; Powered by talkbook
				&nbsp;&nbsp;<i>Designed and built with all the love in the world by <a href="../index.html" target="_blank">Phithon</a> && deepsky </i>
                    <a href="../index.html">更换模板</a>
				</p>
			</div>
		</div>
	</div>
	<!-- /copyright -->
</div>
<a href="#" id="go-top">Top ↑</a>
<script src="https://cdn.staticfile.org/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/jquery.appear/0.4.1/jquery.appear.min.js"></script>
<script src="../static/deep/js/common_tpl.js" type="text/javascript"></script>
<script src="../static/deep/js/config.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FF5KPQ1CZ6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FF5KPQ1CZ6');
</script>

<script src="https://cdn.staticfile.org/fancybox/2.1.7/js/jquery.fancybox.min.js"></script>
<script>
$(document).ready(function () {
    $(".entry a").each(function (i, e) {
        if(e.host != 'www.leavesongs.com') {
            e.target = '_blank';
        }
    });
    $(".entry img").each(function (i, e) {
        if(e.parentNode.tagName.toUpperCase() != 'A') {
            $(e).wrap('<a href="'+escapeHtml(e.src)+'" class="fancybox"></a>');
        } else {
            $(e.parentNode).addClass('fancybox');
        }
    });
    $('.fancybox').fancybox();
})
</script>

</body>

</html>