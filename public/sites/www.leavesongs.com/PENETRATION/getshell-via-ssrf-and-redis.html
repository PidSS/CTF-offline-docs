

<html class="no-js">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="keywords" content="" />
    <meta name="description" content="phith0n的小站，长期存在与分享关于网络安全与各种编程的原创文章。" />
    <title>Python安全 - 从SSRF到命令执行惨案 | 离别歌</title>
    <link rel="alternate" type="application/atom+xml" href="../feed/index.rss" title="离别歌" />
    <link href="../static/deep/css/base.css" rel="stylesheet" type="text/css" />
    <link href="../static/deep/css/style.css" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="../static/deep/images/favicon.ico" />
    
<style>div.row .col-xs-4 {
  float: left;
  margin-left: 4px;
}
div.row .col-xs-4 img {
  margin-left: 5px;
}
</style>
<link href="https://cdn.staticfile.org/fancybox/2.1.7/css/jquery.fancybox.min.css" rel="stylesheet">
<link rel="stylesheet" href="../static/deep/css/code.css">

</head>
<body>
<!--[if lt IE 8]>
    <div class="browsehappy" role="dialog">当前网页 <strong>不支持</strong> 你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.</div>
<![endif]-->
<div id="header">
    <div class="container">
        <h1 class="h1-title">
            <a href="../index.html">
               <img src="../static/deep/images/logo.png" alt="离别歌" />
            </a>
        </h1>
        <div id="nav">
        <input type="checkbox" id="button">
        <label for="button" onclick>菜单</label>
        
        <ul>
            
            <li class="item ">
                <a href="../index.html" >首页</a>
            </li>
            
            <li class="item ">
                <a href="../list/index.html" >文章</a>
            </li>
            
            <li class="item ">
                <a href="../other/tinger.html" >关于</a>
            </li>
            
            <li class="item ">
                <a href="../other/friends-link.html" >友链</a>
            </li>
            
            <li class="item ">
                <a href="https://github.com/phith0n" target="_blank" >项目</a>
            </li>
            
            <li class="item ">
                <a href="https://www.leavesongs.com/PENETRATION/code-auditor-secret-group.html" target="_blank" >代码审计</a>
            </li>
            
        </ul>
        
        </div>
    </div>
</div>

<div class="banner-bar">
    <div class="container">
        <div class="col-12 columns">
            <div class="place">
                <a href="../index.html">首页</a>
                &raquo;
                
                网络安全 &raquo; <a href="getshell-via-ssrf-and-redis.html">Python安全 - 从SSRF到命令执行惨案</a>
                
            </div>
        </div>
    </div>
</div>
<div class="container">
    <div class="col-11 columns" id="mainbody" role="main">
        <div class="post-single type-post">
            <h1 class="article-h1">Python安全 - 从SSRF到命令执行惨案</h1>
            <div class="details-up">
  <span class="author">作者: phithon</span>
  
  <span class="category">分类: <a href="../sort/PENETRATION.html">网络安全</a></span>
  
  <span class="date">时间: 2017-6-27 2:07</span>
  <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl" href="#reply-list">15条评论</a></span>
  <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl" href="getshell-via-ssrf-and-redis.html">38691人看过</a></span>
  
  <span class="date">标签:
    
        <a href="../tag/ssrf%E6%BC%8F%E6%B4%9E.html">ssrf漏洞</a>
    
        <a href="../tag/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.html">命令执行漏洞</a>
    
  </span>
  
</div>
            <div class="entry">
                <p>前两天遇到的一个问题，起源是在某个数据包里看到<code>url=</code>这个关键字，当时第一想到会不会有SSRF漏洞。</p>
<p>以前乌云上有很多从SSRF打到内网并执行命令的案例，比如有通过SSRF+S2-016漏洞漫游内网的案例，十分经典。不过当时拿到这个目标，我只是想确认一下他是不是SSRF漏洞，没想到后面找到了很多有趣的东西。截图不多（有的是后面补得），大家凑合看吧。</p>
<h2 id="0x01-ssrf"><a class="toclink" href="#0x01-ssrf">0x01 判断SSRF漏洞</a></h2>
<p>目标<code>example.com</code>，根据其中csrf_token的样式，我猜测其为flask开发（当然也可能是一个我不太熟悉的框架使用了和flaskwtf相似的代码）：</p>
<p><a href="../media/attachment/2017/06/27/5b3457f1-4c8a-4a8b-8629-e84e911f117f.png"><img alt="04.png" src="../media/attachment/2017/06/27/5b3457f1-4c8a-4a8b-8629-e84e911f117f.05c1eb5fb6bc.png" /></a></p>
<p>开着代理浏览了一遍整个网站的功能，功能点不多，比较小众的一个分享型站点。偶然间在数据包里看到<code>url=</code>，看了一下发现是一个本地化外部图片这么一个功能。这种功能很容易出现两种漏洞：</p>
<ol>
<li>SSRF漏洞</li>
<li>XSS漏洞</li>
</ol>
<p>SSRF漏洞就不用多说了，在拉取外部资源的时候没有检查URL，导致可以向内网发送请求；XSS漏洞容易被忽略，拉取到目标后储存的时候没有过滤特殊字符，就可能导致XSS漏洞。</p>
<p>简单fuzz一下，依次访问<code>http://127.0.0.1:80/</code>、<code>http://127.0.0.1:80/404404404not_found</code>、<code>http://127.0.0.1:12321/</code></p>
<p><a href="../media/attachment/2017/06/27/f8ec9626-74c1-4871-b7e0-4036a47367ac.png"><img alt="01.png" src="../media/attachment/2017/06/27/f8ec9626-74c1-4871-b7e0-4036a47367ac.1dd1b88c2ca1.png" /></a></p>
<p><a href="../media/attachment/2017/06/27/0f7da787-c380-423a-9096-a6906b05b0d8.png"><img alt="02.png" src="../media/attachment/2017/06/27/0f7da787-c380-423a-9096-a6906b05b0d8.4d9f15ff3518.png" /></a></p>
<p><a href="../media/attachment/2017/06/27/dc32de21-9d03-43a5-9c3f-bc19dc5c69c5.png"><img alt="03.png" src="../media/attachment/2017/06/27/dc32de21-9d03-43a5-9c3f-bc19dc5c69c5.169c0cf4ab61.png" /></a></p>
<p>依次返回了error和两个500，这三个结果分别代表什么？</p>
<p>因为平时做Python开发比较多，这种500的情况也见的比较多，通常是因为代码没有捕捉异常导致返回500。感觉第二个可能是HTTP请求404导致抛出异常，而第三个可能是TCP连接被拒绝（12321端口未开放）导致抛出异常。</p>
<p>虽然我还没理清目标的代码逻辑，但我能肯定这其中存在SSRF漏洞。</p>
<h2 id="0x02-redis"><a class="toclink" href="#0x02-redis">0x02 鸡肋redis服务？</a></h2>
<p>经过简单的测试，我发现目标站点下载外部资源后，会检查资源类型是否是图片，不是图片则返回error。这样就很尴尬了，这是一个没有回显的SSRF漏洞。</p>
<p>这时候我突然想到，既然是判断图片，会不会是用imagemagick组件来判断的？然后我将imagetragick的POC保存到外网的某个poc.gif里，然后让其访问：</p>
<p><a href="../media/attachment/2017/06/27/cf6c2b63-7c20-4b3c-bd71-f92555d0f66a.png"><img alt="05.png" src="../media/attachment/2017/06/27/cf6c2b63-7c20-4b3c-bd71-f92555d0f66a.61d61b462c62.png" /></a></p>
<p>直接把内容返回了，没出现error，也没500，但命令也没执行成功。</p>
<p>当时没想清楚目标究竟是怎么判断图片的，后来拿到shell以后看了源码才知道：目标是判断返回包的content-type，如果不是图片就直接返回error，我想的太复杂了。</p>
<p>imagemagick这条路死了，我就没再研究这块逻辑。因为我不知道目标内网IP段，所以准备先探测一下127.0.0.1的端口，我列了一些常用端口，用Burp跑了一下：</p>
<p><a href="../media/attachment/2017/06/27/36ae58ff-21f6-4008-b4e7-daf288959098.png"><img alt="06.png" src="../media/attachment/2017/06/27/36ae58ff-21f6-4008-b4e7-daf288959098.59ec986334ab.png" /></a></p>
<p>看到6379是200的时候，我着实激动了一下，众所周知，在渗透中遇到redis是一件很愉快的事情。</p>
<p>不过我很快发现，GET请求我没法控制Redis的命令。</p>
<p>科普一下，Redis的协议是简单的文本流，比如我可以向6379端口发送如下TCP流：</p>
<div class="codehilite"><pre><span></span>SET x 1
SET y 2
</pre></div>


<p>每行代表一个命令，上述数据包执行了两条<code>set</code>命令。但现在尴尬的是，普通GET请求的数据包如下：</p>
<div class="codehilite"><pre><span></span><span class="nf">GET</span> <span class="nn">/</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">example.com</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">*/*</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">en</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>
</pre></div>


<p>我控制不了任意一行的起始部分，也就没法自定义redis命令了，非常鸡肋……</p>
<h2 id="0x03-cve-2016-5699"><a class="toclink" href="#0x03-cve-2016-5699">0x03 CVE-2016-5699 化腐朽为神奇</a></h2>
<p>真的鸡肋么？</p>
<p>去年，Python的urllib库曾出过一个头注入的漏洞，CVE-2016-5699（ <a href="http://blog.neargle.com/SecNewsBak/drops/Python%20urllib%20HTTP%E5%A4%B4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html">http://blog.neargle.com/SecNewsBak/drops/Python%20urllib%20HTTP%E5%A4%B4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html</a> ）</p>
<p>因为在CTF里有过类似的思路，所以我基本第一时间就想到了。我在外网服务器用nc开了个端口，在目标web页面传入<code>http://[vps-ip]%0d%0aX-injected:%20header:12345/foo</code>，发现果然注入成功了：</p>
<p><a href="../media/attachment/2017/06/27/22fe73d9-0c22-409a-9353-de75297587cd.png"><img alt="07.png" src="../media/attachment/2017/06/27/22fe73d9-0c22-409a-9353-de75297587cd.2803333c1351.png" /></a></p>
<p>有点小激动，因为之前只是听说过这个漏洞，没有真实案例的依托，这次真遇到了。如果我们能注入HTTP头，也就能控制发送往Redis的数据包的某一行，这样就能执行任意Redis命令了。</p>
<p>有点怕影响目标站，我先在本地搭了个类似的环境。</p>
<p>攻击Redis有几个思路，核心就在于写文件。在本地测试，发现了几个巨坑：</p>
<ol>
<li><code>CONFIG SET dir /tmp</code>，传递斜线<code>/</code>的时候必须进行二次编码（<code>%252f</code>），否则urllib2会抛出<code>URLError: &lt;urlopen error no host given&gt;</code>的异常。</li>
<li>url过长会导致抛出<code>UnicodeError: label empty or too long</code>的异常，所以我需要依次传入<code>CONFIG SET</code>、<code>SAVE</code>等几个命令。</li>
</ol>
<p>最后，我依次发送<code>http://127.0.0.1%0d%0aCONFIG%20SET%20dir%20%252ftmp%0d%0a:6379/foo</code>、<code>http://127.0.0.1%0d%0aCONFIG%20SET%20dbfilename%20evil%0d%0a:6379/foo</code>、<code>http://127.0.0.1%0d%0aSET%20foo%20bar%0d%0aSAVE%0d%0a:6379/foo</code>，最后成功在本地写入<code>/tmp/evil</code>文件。</p>
<p><a href="../media/attachment/2017/06/27/d0db6f0f-e2dd-4fdf-8177-397659db7bb2.png"><img alt="08.png" src="../media/attachment/2017/06/27/d0db6f0f-e2dd-4fdf-8177-397659db7bb2.d21b707fbd5d.png" /></a></p>
<p>不过目标环境就有点蛋疼了，一是完全没有回显，我无法知道我是否写入成功；二是失败原因我无法预测，有可能是redis有密码，或redis是普通权限，或config set命令被禁用等等。</p>
<p>感觉又是一个比较蛋疼和鸡肋的情境。</p>
<h2 id="0x04-python"><a class="toclink" href="#0x04-python">0x04 Python反序列化逆袭</a></h2>
<p>果然在线上环境尝试写入cron文件，都没成功反弹回shell。</p>
<p>在这个地方卡了很久，思路一直在考虑“是否真的成功写入文件”这个问题，如果“成功写入了文件”，为什么没有反弹到shell；如果没有成功写入文件，是不是没有权限，是否可以写入python的webshell？总结起来有几个思路：</p>
<ol>
<li>写入ssh key进行getshell。但扫端口发现似乎并没有开放22，推测是更换了ssh端口并进行的IP限制，或者直接没有运行sshd。</li>
<li>写入cron尝试反弹shell，但没成功。也许是redis没权限，也许是因为目标是ubuntu或debian，这两个系统对于cron文件格式限制会比较严，很难用redis反弹shell。</li>
<li>写入python的webshell，但可能也会遇到文件格式要求过严导致python运行失败，而且通常写入python脚本需要重启服务器才能奏效</li>
<li>写入jinja2模板文件，并通过模板引擎支持的语法执行命令。</li>
</ol>
<p>总结起来，第4个方法最靠谱，因为模板文件对格式要求不严，只要我需要执行的语句放在类似<code>{{ }}</code>的标签中即可。但经过测试，还是有几个问题：一是web路径（关键是存放模板文件的路径）和模板名称都需要猜，这个太难；二是redis如果是从源进行安装，一般是redis用户运行，一般无法写入web目录。</p>
<p>吃个夜宵再回来想想，我觉得首先得解决“是否真的成功写入文件”这个问题。后面fuzz了一下，测试了一堆目录，发现成功在<code>/var/www/html/static</code>下写入了文件，并通过<code>http://example.com/static/xxxfile</code>直接可以访问！</p>
<p>下载刚写入的文件，其实这个文件即为redis的导出文件。我将之导入到自己本地的redis环境中，又是一个惊喜：</p>
<p><a href="../media/attachment/2017/06/27/fc95e74b-592d-4d3c-915c-16c2fc1dfc1e.png"><img alt="09.png" src="../media/attachment/2017/06/27/fc95e74b-592d-4d3c-915c-16c2fc1dfc1e.2999561af28a.png" /></a></p>
<p>看到这个样式的数据，我就知道这一定是反序列化数据，而且是Python2.7的反序列化数据。</p>
<blockquote>
<p>这里科普一下，Python2.7和3.5默认使用的序列化格式有所区别，一般带有括号和换行的序列化数据是2.7使用的，而包含<code>\x00</code>的一般是3.5使用的。</p>
</blockquote>
<p>后续利用就和 <a href="zhangyue-python-web-code-execute.html">https://www.leavesongs.com/PENETRATION/zhangyue-python-web-code-execute.html</a> 这篇文章一个套路。目标站使用redis存储session数据，且session数据使用序列化保存，我们可以通过反序列化来执行任意命令。</p>
<p>使用python2.7构造一个执行反弹shell脚本的序列化数据，并通过SSRF漏洞设置成<code>session:hacker</code>的值，然后访问目标站点的时候设置Cookie <code>session=hacker</code>。</p>
<p>不过有一点需要注意，就是SSRF时URL太长的话会抛出错误（之前本地测试的时候说过），所以需要曲线救国，使用redis的append命令，将数据一段一段写入，类似于这样：</p>
<p><a href="../media/attachment/2017/06/27/7efacb2b-545d-4a47-85ac-def1609d8eef.png"><img alt="10.png" src="../media/attachment/2017/06/27/7efacb2b-545d-4a47-85ac-def1609d8eef.31ea4ba6a92e.png" /></a></p>
<p>另外还有个坑，写入的时候，特殊字符（如换行）需要转义：<code>http://127.0.0.1%0d%0aAPPEND%20session:hacker%20"(S'id'\np1\ntp2\nRp3\n."%0d%0aSAVE%0d%0a:6379/</code>，而且只有值被引号包裹时转义符才能转义，否则转义符又会被转义……这个把我坑了好久，差点就以为功亏一篑了。</p>
<p>最后感觉，挖漏洞思路还是得跳，之前一直在考虑怎么通过redis写文件来进行getshell，却没想到通过读取redis的备份文件，找到了突破口。</p>
<p>成功反弹shell：</p>
<p><a href="../media/attachment/2017/06/27/bfd2a961-a2d3-4b2d-b0f0-a8042c49903b.png"><img alt="11.png" src="../media/attachment/2017/06/27/bfd2a961-a2d3-4b2d-b0f0-a8042c49903b.c459905d5e11.png" /></a></p>
<h2 id="_1"><a class="toclink" href="#_1">总结</a></h2>
<p>这一次案例，出现漏洞的根本原因有几个：</p>
<ol>
<li>Web层面出现SSRF漏洞</li>
<li>Python版本过低，存在CVE-2016-5699头注入漏洞</li>
<li>Redis版本过低，新版Redis写入的文件权限一般是660，可以极大程度上避免写文件造成的漏洞</li>
</ol>
<p>拿到shell以后我看了下源码，其逻辑是这样：获取用户传入的url参数，直接发送HTTP请求并拿到返回对象，判断返回对象的Content-Type是否包含image，如果包含则离线数据并显示出来，否则返回error。</p>
<p>这就导致HTTP请求一旦出现错误，服务器就会抛出500，而返回error是手工判断的结果，所以状态码还是200。</p>
<p>另外还有个感想，我怕把目标环境搞坏了，整个过程中多次用到了本地环境进行测试，而所有本地环境都是用docker启动的 ，非常方便。</p>
<p>之后我应该会模拟一下这个目标，做一个vulhub环境给大家，有时间再说吧……</p>
            </div>
            <div itemprop="keywords" class="tags-meta">
                标签:
                
                    <a href="../tag/ssrf%E6%BC%8F%E6%B4%9E.html">ssrf漏洞</a>
                
                    <a href="../tag/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.html">命令执行漏洞</a>
                
            </div>
            <br>
<!--MOB SHARE BEGIN-->
<div class="-mob-share-ui-button -mob-share-open">分享</div>
<div class="-mob-share-ui" style="display: none">
    <ul class="-mob-share-list">
        <li class="-mob-share-weibo"><p>新浪微博</p></li>
        <li class="-mob-share-qzone"><p>QQ空间</p></li>
        <li class="-mob-share-qq"><p>QQ好友</p></li>
        <li class="-mob-share-weixin"><p>微信</p></li>
        <li class="-mob-share-douban"><p>豆瓣</p></li>
        <li class="-mob-share-facebook"><p>Facebook</p></li>
        <li class="-mob-share-twitter"><p>Twitter</p></li>
        <li class="-mob-share-pocket"><p>Pocket</p></li>
        <li class="-mob-share-google"><p>Google+</p></li>
        <li class="-mob-share-youdao"><p>有道云笔记</p></li>
        <li class="-mob-share-mingdao"><p>明道</p></li>
        <li class="-mob-share-tumblr"><p>Tumblr</p></li>
        <li class="-mob-share-instapaper"><p>Instapaper</p></li>
        <li class="-mob-share-linkedin"><p>LinkedIn</p></li>
    </ul>
    <div class="-mob-share-close">取消</div>
</div>
<div class="-mob-share-ui-bg"></div>
<script id="-mob-share" src="https://f1.webshare.mob.com/code/mob-share.js?appkey=af155d9007c8"></script>
<!--MOB SHARE END-->

        <div class="qqlist">
          <h3>订阅本站<small>(RSS)</small></h3>
          <form method="post" target="_blank" action="https://list.qq.com/cgi-bin/qf_compose_send">
          <input type="hidden" value="qf_booked_feedback" name="t" />
          <input type="hidden" value="dace5c2b356504de449e7f3fc2bb59f3f6124d6563786446" name="id" />
          <input type="text" placeholder="E-mail" value="" class="rsstxt" name="to" id="to" />
          <button type="submit" >订阅&rarr;</button>
          </form>
        </div>


        </div>

        
        <div class="post-single type-post text-center">
            <h3 style="margin-top: 0">喜欢这篇文章，扫码和我成为赞友！</h3>
            <img src="../static/wx.jpg" width="280" alt="">
        </div>
        

        <!-- 评论位置 -->
        <div id="comments" class="comments">
          <h3>已有 15 条评论</h3>
            <ol class="comment-list">
            
            
              <li class="comment-body" id="comment-3602">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">bfpiaoran</a></div>
                    <p>https://python-security.readthedocs.io/vuln/http-header-injection-method.html<br>之前的修复不完全 反馈了下 原来去年又更新了</p>
                    <span class="comment-time">时间: 2021-01-21 16:54</span>
                    <span class="comment-reply"><a href="#comment-3602" onclick="reply_to('3602','bfpiaoran')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3601">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/a4713bf189382bbb1fc7d45fff99bfba.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">bfpiaoran</a></div>
                    <p>今天碰到差不多的环境 很奇怪 在win下面 可以写入 linux死活不行 http://127.0.0.1:6379/%0d%0aSET%20sec%20test%0d%0a:6379/foo#1.jpg<br><br>用的这玩意from django.utils.six.moves.urllib.request import urlopen</p>
                    <span class="comment-time">时间: 2021-01-20 14:47</span>
                    <span class="comment-reply"><a href="#comment-3601" onclick="reply_to('3601','bfpiaoran')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3363">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">Magic_Zero</a></div>
                    <p>和 Orange 挖掘到的github 这个RCE 很相似。<br>http://blog.orange.tw/2017/07/how-i-chained-4-vulnerabilities-on.html</p>
                    <span class="comment-time">时间: 2019-06-11 19:02</span>
                    <span class="comment-reply"><a href="#comment-3363" onclick="reply_to('3363','Magic_Zero')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3204">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/32aec855af00c965d1bb6fb661dc82f0.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="https://www.pangookj.com" target="_blank" rel="nofollow noopener">天津网站建设</a></div>
                    <p>感谢博主分享</p>
                    <span class="comment-time">时间: 2018-11-03 15:24</span>
                    <span class="comment-reply"><a href="#comment-3204" onclick="reply_to('3204','天津网站建设')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3205">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/c4267eb6d17276fa31c547ac71611e90.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="../index.html" target="_blank" rel="nofollow noopener">phithon</a></div>
                    <p>@天津网站建设 链接增加了nofollow，以后不必来这留无意义的言了。</p>
                    <span class="comment-time">时间: 2018-11-03 16:48</span>
                    <span class="comment-reply"><a href="#comment-3205" onclick="reply_to('3205','phithon')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2913">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">&lt;audio src=x onerror=alert(&#x27;audio&#x27;);&gt;</a></div>
                    <p>&lt;audio src=x onerror=alert(&#x27;audio&#x27;);&gt;<br>煮屎者</p>
                    <span class="comment-time">时间: 2017-09-14 16:23</span>
                    <span class="comment-reply"><a href="#comment-2913" onclick="reply_to('2913','\u003Caudio src\u003Dx onerror\u003Dalert(\u0027audio\u0027)\u003B\u003E')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2819">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">whynot</a></div>
                    <p>p师傅v587</p>
                    <span class="comment-time">时间: 2017-07-19 18:01</span>
                    <span class="comment-reply"><a href="#comment-2819" onclick="reply_to('2819','whynot')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2806">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">SONAR</a></div>
                    <p>厉害，希望可以做成一个vulhub的环境！！！</p>
                    <span class="comment-time">时间: 2017-06-29 20:41</span>
                    <span class="comment-reply"><a href="#comment-2806" onclick="reply_to('2806','SONAR')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2805">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/76af196f20bcdf0ccbf12c09c54f3001.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="http://triplekill.org" target="_blank" rel="nofollow noopener">xiaocheng</a></div>
                    <p>大佬 666666666</p>
                    <span class="comment-time">时间: 2017-06-28 19:21</span>
                    <span class="comment-reply"><a href="#comment-2805" onclick="reply_to('2805','xiaocheng')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2804">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">Mr.Bingo</a></div>
                    <p>很牛逼💯。 服</p>
                    <span class="comment-time">时间: 2017-06-28 18:10</span>
                    <span class="comment-reply"><a href="#comment-2804" onclick="reply_to('2804','Mr.Bingo')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2802">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">RZ</a></div>
                    <p>P神，这一连串的漏洞分析流弊翻了</p>
                    <span class="comment-time">时间: 2017-06-28 15:11</span>
                    <span class="comment-reply"><a href="#comment-2802" onclick="reply_to('2802','RZ')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2801">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="http://www.baidu.com" target="_blank" rel="nofollow noopener">hello</a></div>
                    <p>博主的md排版需要整理下啊，一旦遇到长的url，前面的内容间隔就不对了。。。</p>
                    <span class="comment-time">时间: 2017-06-27 23:58</span>
                    <span class="comment-reply"><a href="#comment-2801" onclick="reply_to('2801','hello')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2800">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">小花</a></div>
                    <p>厉害了</p>
                    <span class="comment-time">时间: 2017-06-27 18:27</span>
                    <span class="comment-reply"><a href="#comment-2800" onclick="reply_to('2800','小花')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2799">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/18c2a35549a5a800616613bceeb47234.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="http://godot.win" target="_blank" rel="nofollow noopener">Godot</a></div>
                    <p>好厉害，之前看师父在乌云的反序列化就五体投地过一次，这次看到师父这种姿势又一次被震惊到了。</p>
                    <span class="comment-time">时间: 2017-06-27 18:20</span>
                    <span class="comment-reply"><a href="#comment-2799" onclick="reply_to('2799','Godot')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2798">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">helloE</a></div>
                    <p>感觉有点牛逼了，如果不熟悉python的话，可能就无法利用这么多python的漏洞以及特性来触发redis反弹了</p>
                    <span class="comment-time">时间: 2017-06-27 09:55</span>
                    <span class="comment-reply"><a href="#comment-2798" onclick="reply_to('2798','helloE')">回复</a></span>
                    </div>
                </div>
              </li>
            
            
            </ol>
            
        </div>

        <div id="reply"></div>
        <div id="comment-place">
            <div id="comment-post" class="respond none-resize">
             <div id="respond">
                <h3 id="response">添加新评论</h3>
                <form method="post" id="comment-form" role="form" action="#comments">
                    <p>
                        <label for="author" class="required">称呼</label>
                        <input type="text" name="nickname" placeholder="昵称" maxlength="64" required id="id_nickname">
                    </p>
                    <p>
                        <label for="mail">Email</label>
                        <input type="text" name="email" placeholder="邮箱（可留空）" maxlength="254" id="id_email">
                    </p>
                    <p>
                        <label for="url">网站</label>
                        <input type="text" name="url" placeholder="链接（可留空）" maxlength="200" id="id_url">
                    </p>
                    <p>
                        <label for="textarea" class="required">内容</label>
                        <textarea name="content" cols="40" rows="6" required id="id_content">
</textarea>
                    </p>
                    <p>
                        <label style="float:left;">验证码</label>
                        <div class="row gx-2" style="margin-top: 8px"><div class="col-6"><input autocomplete="off" id="id_captcha_1" name="captcha_1" type="text" placeholder="验证码" /> <input id="id_captcha_0" name="captcha_0" type="hidden" value="dae082c86882f1577e48f839ce65c317e9a502d1" />
</div><div class="col-6">
<img src="../captcha/image/dae082c86882f1577e48f839ce65c317e9a502d1/index.png" alt="captcha" class="captcha" /></div></div>
                    </p>
                    <p>
                        <button type="submit" class="submit">提交评论</button>
                        <input type="hidden" name="parent" id="id_parent">
                        <input type="hidden" name="archive" value="421" id="id_archive">
                        <input type="hidden" name="csrfmiddlewaretoken" value="RoPEffnObz4hMXHe0tdMnwxwVxEcM3BKDWdvNkYxzVi0kvvC2uaxkZABgUVnlFN2">
                    </p>
                </form>
                </div>
            </div>
        </div>

    </div>
    



<div  class="col-5 columns" id="sidebar" role="complementary">

  <div class="widget widget_search">
    <h3>搜索</h3>
    <form action="https://www.leavesongs.com/search/" id="searchform" method="get">
        <input type="text" id="searchkey" name="keyword" value="" class="searchkey" placeholder="Search..."/>
        <button type="submit"  id="searchsubmit">Go</button>
    </form>
  </div>

  
  <div class="widget">
	<h3 class="widget-title">最新评论</h3>
	<ul class="widget-list" id="recent-comment">
    
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>木木</cite>：<a href="../THINK/europe-trip-2022.html#comment-4523">虽然物价对比不出什么，但是还是觉得很高昂</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>dongdong4fei</cite>：<a href="../THINK/using-chatgpt-for-antispam.html#comment-4520">肯德基疯狂星期四！ 疯狂星期四！  https://m.kfc.com.cn/wechatco...</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>dongdong4fei</cite>：<a href="../THINK/using-chatgpt-for-antispam.html#comment-4519">小猪咪小猪咪小猪咪</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>sam</cite>：<a href="javascript-prototype-pollution-attack.html#comment-4518">还得是P神，文章一看就懂</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>程序</cite>：<a href="discuz72-sql-injection.html#comment-4517">很不错的文章</a></div>
        </li>
    
    </ul>
  </div>

  <div class="widget widget-category">
	<h3>分类</h3>
	<ul id="blogsort" class="widget-list">
    
    
    <li>
        <a href="../sort/PENETRATION.html">网络安全<em>143</em></a>
    </li>
    
    <li>
        <a href="../sort/C.html">C/C++<em>32</em></a>
    </li>
    
    <li>
        <a href="../sort/THINK.html">心得与体会<em>24</em></a>
    </li>
    
    <li>
        <a href="../sort/PYTHON.html">Python<em>19</em></a>
    </li>
    
    <li>
        <a href="../sort/SHARE.html">资源分享<em>16</em></a>
    </li>
    
    </ul>
  </div>

  <div class="widget widget-tag">
	<h3>随机标签</h3>
	<div class="tag-cloud">
        
        
        <a rel="tag" href="../tag/%E5%A4%A7%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86.html">大文件处理</a>
        
        <a rel="tag" href="../tag/%E5%9B%9E%E8%B0%83%E5%90%8E%E9%97%A8.html">回调后门</a>
        
        <a rel="tag" href="../tag/iOS.html">iOS</a>
        
        <a rel="tag" href="../tag/%E4%BD%8D%E8%BF%90%E7%AE%97.html">位运算</a>
        
        <a rel="tag" href="../tag/%E6%A1%A5%E6%8E%A5.html">桥接</a>
        
        <a rel="tag" href="../tag/writeup.html">writeup</a>
        
        <a rel="tag" href="../tag/IIS.html">IIS</a>
        
        <a rel="tag" href="../tag/WTForm.html">WTForm</a>
        
        <a rel="tag" href="../tag/apache.html">apache</a>
        
        <a rel="tag" href="../tag/web%E6%8C%87%E7%BA%B9.html">web指纹</a>
        
        <a rel="tag" href="../tag/%E6%B1%89%E8%AF%BA%E5%A1%94.html">汉诺塔</a>
        
        <a rel="tag" href="../tag/cmd%E5%90%8E%E9%97%A8.html">cmd后门</a>
        
        <a rel="tag" href="../tag/Linux.html">Linux</a>
        
        <a rel="tag" href="../tag/CSP.html">CSP</a>
        
        <a rel="tag" href="../tag/%E5%9B%A2%E9%98%9F.html">团队</a>
        
        <a rel="tag" href="../tag/phpwind.html">phpwind</a>
        
        <a rel="tag" href="../tag/%E6%80%BB%E7%BB%93.html">总结</a>
        
        <a rel="tag" href="../tag/%E9%81%8D%E5%8E%86%E7%9B%AE%E5%BD%95.html">遍历目录</a>
        
        <a rel="tag" href="../tag/C-FREE.html">C-FREE</a>
        
        <a rel="tag" href="../tag/var_dump.html">var_dump</a>
        
        <a rel="tag" href="../tag/disable_functions.html">disable_functions</a>
        
        <a rel="tag" href="../tag/%E6%8A%A5%E7%BA%B8.html">报纸</a>
        
        <a rel="tag" href="../tag/%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E.html">越权漏洞</a>
        
        <a rel="tag" href="../tag/web%E5%BA%94%E7%94%A8.html">web应用</a>
        
        <a rel="tag" href="../tag/360webscan.html">360webscan</a>
        
        <a rel="tag" href="../tag/asyncore.html">asyncore</a>
        
        <a rel="tag" href="../tag/%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87.html">沙盒绕过</a>
        
        <a rel="tag" href="../tag/fckeditor.html">fckeditor</a>
        
        <a rel="tag" href="../tag/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%80%9F%E5%BA%A6.html">数据库速度</a>
        
        <a rel="tag" href="../tag/kali.html">kali</a>
        
    </div>
  </div>

  <div class="widget widget-recent-entries">
	<h3 class="widget-title">热门日志</h3>
	<ul id="hotlog" class="widget-list">
    
    
        <li><a href="../other/tinger.html">About.Me</a></li>
    
        <li><a href="detect-django.html">如何判断目标站点是否为Django开发</a></li>
    
        <li><a href="webshell-without-alphanum-advanced.html">无字母数字webshell之提高篇</a></li>
    
        <li><a href="webshell-without-alphanum.html">一些不包含数字和字母的webshell</a></li>
    
        <li><a href="php-filter-magic.html">谈一谈php://filter的妙用</a></li>
    
    </ul>
  </div>
  

</div>
</div>

<div id="footer">
	<!-- copyright -->
	<div class="container">
		<div class="row remove-bottom">
			<div class="col-6 columns">
			<h3>Little About</h3>
			<p>Phithon 非强迫症小青年  <br>
现居先 <br>
爱好：种花、买书、收藏明信片 <br>
欢迎各大组织收留 <br>
E-mail：root@leavesongs.com </p>
			</div>

			<div class="col-10 columns">

				<h3 class="mobile-hide">Follow me</h3>
        <div id="social-links">
          <a href="http://weibo.com/101yx" class="sweibo" target="_blank" title="新浪微博">新浪微博</a>
          <a href="javascript:alert(/没有腾讯微博哟/)" class="qweibo" target="_blank" title="腾讯微博">腾讯微博</a>
          <a href="javascript:alert(/墙外有什么/);window.open('http://google.com')" class="google" target="_blank" title="墙外的世界">google+</a>
          <a href="https://github.com/phith0n" class="github" target="_blank" title="Github">github</a>
          <a href="javascript:confirm(/mailto:root#leavesongs.com/)" class="mail" target="_blank" title="私信给我">私信给我</a>
          <a href="../feed/index.rss" target="_blank" class="rss" title="离别歌">RSS订阅</a>
        </div>
        <div class="bot-line"></div>
				<p class="copyright">
	Copyright &copy; Powered by talkbook
				&nbsp;&nbsp;<i>Designed and built with all the love in the world by <a href="../index.html" target="_blank">Phithon</a> && deepsky </i>
                    <a href="../index.html">更换模板</a>
				</p>
			</div>
		</div>
	</div>
	<!-- /copyright -->
</div>
<a href="#" id="go-top">Top ↑</a>
<script src="https://cdn.staticfile.org/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/jquery.appear/0.4.1/jquery.appear.min.js"></script>
<script src="../static/deep/js/common_tpl.js" type="text/javascript"></script>
<script src="../static/deep/js/config.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FF5KPQ1CZ6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FF5KPQ1CZ6');
</script>

<script src="https://cdn.staticfile.org/fancybox/2.1.7/js/jquery.fancybox.min.js"></script>
<script>
$(document).ready(function () {
    $(".entry a").each(function (i, e) {
        if(e.host != 'www.leavesongs.com') {
            e.target = '_blank';
        }
    });
    $(".entry img").each(function (i, e) {
        if(e.parentNode.tagName.toUpperCase() != 'A') {
            $(e).wrap('<a href="'+escapeHtml(e.src)+'" class="fancybox"></a>');
        } else {
            $(e.parentNode).addClass('fancybox');
        }
    });
    $('.fancybox').fancybox();
})
</script>

</body>

</html>