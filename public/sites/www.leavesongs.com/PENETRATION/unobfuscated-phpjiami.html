

<html class="no-js">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="keywords" content="" />
    <meta name="description" content="phith0n的小站，长期存在与分享关于网络安全与各种编程的原创文章。" />
    <title>phpjiami 数种解密方法 | 离别歌</title>
    <link rel="alternate" type="application/atom+xml" href="../feed/index.rss" title="离别歌" />
    <link href="../static/deep/css/base.css" rel="stylesheet" type="text/css" />
    <link href="../static/deep/css/style.css" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="../static/deep/images/favicon.ico" />
    
<style>div.row .col-xs-4 {
  float: left;
  margin-left: 4px;
}
div.row .col-xs-4 img {
  margin-left: 5px;
}
</style>
<link href="https://cdn.staticfile.org/fancybox/2.1.7/css/jquery.fancybox.min.css" rel="stylesheet">
<link rel="stylesheet" href="../static/deep/css/code.css">

</head>
<body>
<!--[if lt IE 8]>
    <div class="browsehappy" role="dialog">当前网页 <strong>不支持</strong> 你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.</div>
<![endif]-->
<div id="header">
    <div class="container">
        <h1 class="h1-title">
            <a href="../index.html">
               <img src="../static/deep/images/logo.png" alt="离别歌" />
            </a>
        </h1>
        <div id="nav">
        <input type="checkbox" id="button">
        <label for="button" onclick>菜单</label>
        
        <ul>
            
            <li class="item ">
                <a href="../index.html" >首页</a>
            </li>
            
            <li class="item ">
                <a href="../list/index.html" >文章</a>
            </li>
            
            <li class="item ">
                <a href="../other/tinger.html" >关于</a>
            </li>
            
            <li class="item ">
                <a href="../other/friends-link.html" >友链</a>
            </li>
            
            <li class="item ">
                <a href="https://github.com/phith0n" target="_blank" >项目</a>
            </li>
            
            <li class="item ">
                <a href="https://www.leavesongs.com/PENETRATION/code-auditor-secret-group.html" target="_blank" >代码审计</a>
            </li>
            
        </ul>
        
        </div>
    </div>
</div>

<div class="banner-bar">
    <div class="container">
        <div class="col-12 columns">
            <div class="place">
                <a href="../index.html">首页</a>
                &raquo;
                
                网络安全 &raquo; <a href="unobfuscated-phpjiami.html">phpjiami 数种解密方法</a>
                
            </div>
        </div>
    </div>
</div>
<div class="container">
    <div class="col-11 columns" id="mainbody" role="main">
        <div class="post-single type-post">
            <h1 class="article-h1">phpjiami 数种解密方法</h1>
            <div class="details-up">
  <span class="author">作者: phithon</span>
  
  <span class="category">分类: <a href="../sort/PENETRATION.html">网络安全</a></span>
  
  <span class="date">时间: 2017-9-23 22:13</span>
  <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl" href="#reply-list">17条评论</a></span>
  <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl" href="unobfuscated-phpjiami.html">43460人看过</a></span>
  
  <span class="date">标签:
    
        <a href="../tag/%E8%A7%A3%E5%AF%86.html">解密</a>
    
        <a href="../tag/phpjiami.html">phpjiami</a>
    
  </span>
  
</div>
            <div class="entry">
                <p>Pwnhub公开赛出了个简单的PHP代码审计题目，考点有两个：</p>
<ol>
<li>由 <a href="http://www.phpjiami.com/">http://www.phpjiami.com/</a> 加密过的源码还原</li>
<li>上传取后缀方式不同导致的文件上传漏洞</li>
</ol>
<p>如果说仅为了做出题目拿到flag，这个题目太简单，后台也有数十名选手提交了答案和writeup。但深入研究一下这两个知识点，还是很有意思的。</p>
<p>首先通过简单的目录扫描，找到备份文件index.php.bak。下载后发现文件是经过了混淆加密处理的，大部分同学是直接网上找了付费解密的网站给解的，也有少数几个人说明了解密方法，我挑几种方法说一下。</p>
<h2 id="0x01-phpjiami"><a class="toclink" href="#0x01-phpjiami">0x01 phpjiami 代码分析破解法</a></h2>
<p>这种方法我最佩服了，作者甚至给出了解密脚本，文章如下： <a href="http://sec2hack.com/web/phpjiami-decode.html">http://sec2hack.com/web/phpjiami-decode.html</a> 。</p>
<p>我自己在出题目之前也进行过分析，但后面并没有耐心写一个完整的脚本出来，所以我十分佩服这个作者。</p>
<p>我们分析phpjiami后的文件，可以看到他有如下特点：</p>
<ol>
<li>函数名、变量名全部变成“乱码”</li>
<li>改动任意一个地方，将导致文件不能运行</li>
</ol>
<p>之所以函数名、变量名可以变成“乱码”，是因为PHP的函数名、变量名是支持除了特殊符号以外大部分字符的，比如汉字等。利用这一特点，phpjiami就将所有正常的英文变量给转换了一下形式，其实没有什么特别的奥秘。</p>
<p>那么，为了方便分析，我们可以想办法再将其转换回英文和数字。比如，作者使用的是 <a href="http://zhaoyuanma.com/phpcodefix.html">http://zhaoyuanma.com/phpcodefix.html</a> 对混淆过的代码进行美化；而我是使用 <a href="https://github.com/nikic/PHP-Parser">https://github.com/nikic/PHP-Parser</a> 对整个代码进行了结构化的分析，并将所有变量和函数名进行了美化。</p>
<p>方法一的好处是我不需要写任何代码，就可以大致进行美化，但显然，美化后的代码是有错误的，原文中也提到了这一点；方法二，虽然需要自己写代码，但美化后的代码没有语法错误，看起来更加直观，并且我还能进一步的进行美化，比如将字符串中的乱码转换成<code>\x</code>的形式。</p>
<p>我美化后的代码如下：</p>
<p><a href="../media/attachment/2017/09/23/4001b879-104c-4ef3-871c-ea676fe5ee85.jpg"><img alt="15061083980622.jpg" src="../media/attachment/2017/09/23/4001b879-104c-4ef3-871c-ea676fe5ee85.48dcf6113f2a.jpg" /></a></p>
<p>后续的操作和上文也差不多，通过源码的分析，正如上文中所说，phpjiami加密源码的整个流程是：</p>
<blockquote>
<p>加密流程：源码 -&gt; 加密处理（压缩，替换，BASE64，转义）-&gt; 安全处理（验证文件 MD5 值，限制 IP、限域名、限时间、防破解、防命令行调试）-&gt; 加密程序成品，再简单的说：源码 + 加密外壳 == 加密程序 (该段出处)</p>
</blockquote>
<p>所以，其实这种方法并没有对源码进行混淆，只是对“解密源码的壳”进行了混淆。所以你看到的中文变量、中文函数，其实是一个壳，去掉这层壳，我可以拿到完整的PHP源码。</p>
<p>所以呀，后台提交的writeup里，有的同学想当然地认为修改eval为echo就能输出源码了……实际上根本没实际试过，改动文件是会导致不能运行的；还有同学认为这里仅是将源码混淆为用户体验极差的代码，导致人眼无法阅读，并没有理解这里其实混淆的不是源码。</p>
<h2 id="0x02-hook-eval"><a class="toclink" href="#0x02-hook-eval">0x02 HOOK EVAL法</a></h2>
<p>0x01中说到的方法固然是很美好的，但是假如加密者随意改动一点加密的逻辑，可能导致我们需要重新分析加密方法，写解密脚本。我们有没有更通用的方法？</p>
<p>HOOK EVAL应该是被提到过最多的方法，我也看到了Medici.Yan发布的一篇文章： <a href="http://blog.evalbug.com/2017/09/21/phpdecode_01/">http://blog.evalbug.com/2017/09/21/phpdecode_01/</a></p>
<p>我前文说过，phpjiami其实是只是混淆了壳，这个壳的作用是执行真正的源码。那么，执行源码必然是会经过eval之类的“函数”（当然也不尽然），那么，如果我们能够有办法将eval给替换掉，不就可以获得源码了么？</p>
<p>遗憾的是，如果我们仅仅简单地将eval替换成echo，将导致整个脚本不能运行——因为phpjiami检测了文件是否被修改。</p>
<p>那么，我们可以寻求更底层的方法。就是很多人以前提到过的，将PHP底层的函数 <code>zend_compile_string</code>给拦截下来，并输出值。Medici.Yan的文章中说的很清楚，也给出了参考文档和源码，我就不再赘述了。</p>
<p>我自己简单写了一个扩展，并用php5.6编译： <a href="https://drive.google.com/open?id=0B4uxE69uafD5anVTZ1VwNXN0WEU">https://drive.google.com/open?id=0B4uxE69uafD5anVTZ1VwNXN0WEU</a></p>
<p>下载之，在php.ini中添加<code>extension=hookeval.so</code>，然后直接访问加密过的php代码即可（当时参考tool.lu的站长xiaozi的代码 <a href="http://type.so/c/php-dump-eval.html">http://type.so/c/php-dump-eval.html</a> ，所以分隔符里有关键字）：</p>
<p><a href="../media/attachment/2017/09/23/199b6b4c-810c-440f-a712-c8b24694a1db.jpg"><img alt="15061016184332.jpg" src="../media/attachment/2017/09/23/199b6b4c-810c-440f-a712-c8b24694a1db.410db46724c7.jpg" /></a></p>
<p>16年kuuki曾分享过一个在线解密的工具： <a href="https://xianzhi.aliyun.com/forum/read/64.html">https://xianzhi.aliyun.com/forum/read/64.html</a> ，但测试了一下phpjiami解密不了。原因是，phpjiami在解密的时候会进行验证：</p>
<div class="codehilite"><pre><span></span><span class="x">php_sapi_name() == &#39;cli&#39; ? die():&#39;&#39;;</span>
</pre></div>


<p>所以如果这个源码是在命令行下运行，在执行这条语句的时候就die了。所以，即使你编译好了hookeval.so并开启了这个扩展，也需要在Web环境下运行。</p>
<blockquote>
<p>提高篇：有没有什么简单的办法在命令行下也能模拟web环境呢？方法我先不说，大家可以自己思考思考。</p>
</blockquote>
<h2 id="0x03-dump"><a class="toclink" href="#0x03-dump">0x03 手工dump法</a></h2>
<p>那么有的同学说：php扩展太难了，我不会写C语言，怎么办？</p>
<p>不会写C语言也没关系，你只需要会写PHP即可。这是我凤凰师傅提到的一个方法，也是我理想中的一个解，非常简单，两行代码搞定，解密用时比你去网上花钱解密还短：</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">include</span> <span class="s2">&quot;index.php&quot;</span><span class="p">;</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nb">get_defined_vars</span><span class="p">());</span>
</pre></div>


<p>原理其实也很简单。phpjiami的壳在解密源码并执行后，遗留下来一些变量，这些变量里就包含了解密后的源码。</p>
<p>虽然我们不能直接修改index.php，将这些变量打印出来，但是我们可以动态包含之，并打印下所有变量，其中必定有我们需要的源码（<code>var_dump</code>输出的不完整，只是用它举个例子）：</p>
<p><a href="../media/attachment/2017/09/23/0b5be7e7-0ff7-4020-847a-bba05f9aee9b.jpg"><img alt="15061033809201.jpg" src="../media/attachment/2017/09/23/0b5be7e7-0ff7-4020-847a-bba05f9aee9b.e6295ae498a2.jpg" /></a></p>
<p>当然，这个方法虽然简单，但有个很严重的问题：假如在执行源码的过程中<code>exit()</code>了，我们就执行不到打印变量的地方了。</p>
<p>所以，这个方法并不一定适用于所有情景，但对于本题来说，已经足够了。</p>
<h2 id="0x04"><a class="toclink" href="#0x04">0x04 动态调试法</a></h2>
<p>那么，如果我们遇到0x03解决不了的情况怎么办？</p>
<p>这时候就要祭出动态调试武器了。尽管加密后的文件看起来乱七八糟，但其仍然是一个符合php语法的php文件，那么我们就可以直接利用动态调试工具进行单步调试，拿到源码。</p>
<p>简单拿xdebug进行调试，不停单步调试后，就可以发现我们需要的源码已经在上下文变量中的：</p>
<p><a href="../media/attachment/2017/09/23/cf588158-a05a-4c0a-956a-52693deaa76f.jpg"><img alt="15061202727840.jpg" src="../media/attachment/2017/09/23/cf588158-a05a-4c0a-956a-52693deaa76f.3cab4cff20df.jpg" /></a></p>
<p>右键“复制值”，即可拿到源码。这也算一个比较简单的方法了。</p>
<p>当然，假如有一天phpjiami修改了混淆流程，源码不再储存于变量中，那么就需要分析一下代码执行的流程。所谓万变不离其中，最终断在eval的那一步，一定有你需要的源码。</p>
<h2 id="0x05-getshell"><a class="toclink" href="#0x05-getshell">0x05 代码审计Getshell</a></h2>
<p>后面的部分反而比较简单。拿到index.php的源码后，发现其包含了FileUpload.class.php，所以再次下载这个文件的源码进行解密。</p>
<p>分析FileUpload类，发现其取后缀有两种方式：将文件名用<code>.</code>分割成数组<code>$arr</code>，一是用<code>$arr[count($arr)-1]</code>的方式取数组最后一个元素，二是用<code>end($arr)</code>的方式取数组最后一个元素。</p>
<p>正常来说，字符串用<code>.</code>分割成的数组，用这两种方法取到的末元素应该是相同的。但取文件名的时候，如果我们已经传入的是数组，则不会再次进行分割：</p>
<div class="codehilite"><pre><span></span><span class="x">$filename = $_POST[...];</span>
<span class="x">if(!is_array($filename)) {</span>
<span class="x">    $filename = explode(&#39;.&#39;, $filename);</span>
<span class="x">}</span>
</pre></div>


<p>也就是说我能控制<code>$filename</code>这个数组。所以，我只需要找到<code>$arr[count($arr)-1]</code>和<code>end($arr)</code>的区别，即可绕过后缀检查。</p>
<p>显然，前者是取根据数组下标来取的值，后者取的永远是数组里最后一个元素。所以，我们只需要让下标等于<code>count($arr)-1</code>的元素不是数组最后一个元素即可。</p>
<p>比如：<code>[1=&gt;'gif', 0=&gt;'php']</code>或者<code>['0'=&gt;'abc', '2'=&gt;'gif', '100'=&gt;'php']</code>。</p>
<h2 id="0x06"><a class="toclink" href="#0x06">0x06 总结</a></h2>
<p>最后想说一句话：不求甚解是阻碍部分人进步的一大阻力。共勉。</p>
            </div>
            <div itemprop="keywords" class="tags-meta">
                标签:
                
                    <a href="../tag/%E8%A7%A3%E5%AF%86.html">解密</a>
                
                    <a href="../tag/phpjiami.html">phpjiami</a>
                
            </div>
            <br>
<!--MOB SHARE BEGIN-->
<div class="-mob-share-ui-button -mob-share-open">分享</div>
<div class="-mob-share-ui" style="display: none">
    <ul class="-mob-share-list">
        <li class="-mob-share-weibo"><p>新浪微博</p></li>
        <li class="-mob-share-qzone"><p>QQ空间</p></li>
        <li class="-mob-share-qq"><p>QQ好友</p></li>
        <li class="-mob-share-weixin"><p>微信</p></li>
        <li class="-mob-share-douban"><p>豆瓣</p></li>
        <li class="-mob-share-facebook"><p>Facebook</p></li>
        <li class="-mob-share-twitter"><p>Twitter</p></li>
        <li class="-mob-share-pocket"><p>Pocket</p></li>
        <li class="-mob-share-google"><p>Google+</p></li>
        <li class="-mob-share-youdao"><p>有道云笔记</p></li>
        <li class="-mob-share-mingdao"><p>明道</p></li>
        <li class="-mob-share-tumblr"><p>Tumblr</p></li>
        <li class="-mob-share-instapaper"><p>Instapaper</p></li>
        <li class="-mob-share-linkedin"><p>LinkedIn</p></li>
    </ul>
    <div class="-mob-share-close">取消</div>
</div>
<div class="-mob-share-ui-bg"></div>
<script id="-mob-share" src="https://f1.webshare.mob.com/code/mob-share.js?appkey=af155d9007c8"></script>
<!--MOB SHARE END-->

        <div class="qqlist">
          <h3>订阅本站<small>(RSS)</small></h3>
          <form method="post" target="_blank" action="https://list.qq.com/cgi-bin/qf_compose_send">
          <input type="hidden" value="qf_booked_feedback" name="t" />
          <input type="hidden" value="dace5c2b356504de449e7f3fc2bb59f3f6124d6563786446" name="id" />
          <input type="text" placeholder="E-mail" value="" class="rsstxt" name="to" id="to" />
          <button type="submit" >订阅&rarr;</button>
          </form>
        </div>


        </div>

        
        <div class="post-single type-post text-center">
            <h3 style="margin-top: 0">喜欢这篇文章，扫码和我成为赞友！</h3>
            <img src="../static/wx.jpg" width="280" alt="">
        </div>
        

        <!-- 评论位置 -->
        <div id="comments" class="comments">
          <h3>已有 17 条评论</h3>
            <ol class="comment-list">
            
            
              <li class="comment-body" id="comment-3668">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="http://dabao.iby.pub/" target="_blank" rel="nofollow noopener">小飞</a></div>
                    <p>受益匪浅，学到了，推荐1100个PS4游戏全集，总体积达20TB，包含目前99.9%的PS4游戏<br>有了这个合集您将再也不需要到处寻找游戏<br>1100个PS4游戏全集，总体积达20TB，包含目前99.9%的PS4游戏<br>附带升级补丁、DLC等<br>20G以内游戏直接提供PKG格式，无需解压，20G以上游戏含恢复记录，避免解压出错<br>文档式下载，每个游戏单独下载地址，一次购买永久保存，即使网站关闭也不影响下载。<br>下载地址：http://t.miip.cn/xVaPt2<br>下载地址：http://dabao.iby.pub/psgame.html</p>
                    <span class="comment-time">时间: 2021-07-09 11:53</span>
                    <span class="comment-reply"><a href="#comment-3668" onclick="reply_to('3668','小飞')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3327">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/275001fe309c5e5a6dda01fc5f0a0332.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">123</a></div>
                    <p>比如将字符串中的乱码转换成\x的形式。 这个怎么转换</p>
                    <span class="comment-time">时间: 2019-04-12 12:03</span>
                    <span class="comment-reply"><a href="#comment-3327" onclick="reply_to('3327','123')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3307">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">script</a></div>
                    <p>厉害，作者是个大牛。</p>
                    <span class="comment-time">时间: 2019-03-19 08:55</span>
                    <span class="comment-reply"><a href="#comment-3307" onclick="reply_to('3307','script')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3146">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/32aec855af00c965d1bb6fb661dc82f0.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="https://www.pangookj.com" target="_blank" rel="nofollow noopener">天津网站建设</a></div>
                    <p>感谢博主分享</p>
                    <span class="comment-time">时间: 2018-09-18 21:40</span>
                    <span class="comment-reply"><a href="#comment-3146" onclick="reply_to('3146','天津网站建设')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2943">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/246245eeb6a94006f0bd8c8b72f5c1ba.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="http://199508.com" target="_blank" rel="nofollow noopener">大雄</a></div>
                    <p>膜拜大牛！</p>
                    <span class="comment-time">时间: 2017-10-18 17:58</span>
                    <span class="comment-reply"><a href="#comment-2943" onclick="reply_to('2943','大雄')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2940">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">J1ink</a></div>
                    <p>P牛啊，你的博客玩我更换了一下模板，改成以前的了，现在开你的网站都是以前的模板，怎么改回去啊233</p>
                    <span class="comment-time">时间: 2017-10-12 18:37</span>
                    <span class="comment-reply"><a href="#comment-2940" onclick="reply_to('2940','J1ink')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2941">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/c4267eb6d17276fa31c547ac71611e90.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="../index.html" target="_blank" rel="nofollow noopener">phithon</a></div>
                    <p>@J1ink 仍然是右下角切换模板，背景有点灰，看不清。</p>
                    <span class="comment-time">时间: 2017-10-12 20:28</span>
                    <span class="comment-reply"><a href="#comment-2941" onclick="reply_to('2941','phithon')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2935">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">php小白   希望答下凝问</a></div>
                    <p>我们只需要让下标等于count($arr)-1的元素不是数组最后一个元素即可。<br><br>能否详说下，想不明白喔</p>
                    <span class="comment-time">时间: 2017-10-04 13:57</span>
                    <span class="comment-reply"><a href="#comment-2935" onclick="reply_to('2935','php小白   希望答下凝问')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2936">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/c4267eb6d17276fa31c547ac71611e90.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="../index.html" target="_blank" rel="nofollow noopener">phithon</a></div>
                    <p>@php小白  <br>因为php里的数组准确来说是一个map，也就是key=&gt;value对。数组下标是可以自定义的，比如一个数组可以只有两个元素，下标0对应&#x27;a&#x27;，下标100对应&#x27;b&#x27;，下标并不必须是连续的。</p>
                    <span class="comment-time">时间: 2017-10-04 20:17</span>
                    <span class="comment-reply"><a href="#comment-2936" onclick="reply_to('2936','phithon')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2934">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">php小白   希望答下凝问</a></div>
                    <p>但取文件名的时候，如果我们已经传入的是数组，则不会再次进行分割<br><br>怎么样传入数组的文件名？ burpsuit 修改为 filename[]= abc.gif.php<br><br><br>我们只需要让下标等于count($arr)-1的元素不是数组最后一个元素即可。<br>这个是怎么做到的？ 想不通啊！<br>count($arr) 不是计算元素的个数吗？ 总的元素个数 -1 就是数组的边界下标，边界下标不是数组最后的一个吗（除了0外）？</p>
                    <span class="comment-time">时间: 2017-10-04 13:55</span>
                    <span class="comment-reply"><a href="#comment-2934" onclick="reply_to('2934','php小白   希望答下凝问')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2930">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">Dropzero</a></div>
                    <p>曾经傻呵呵的一步一步调过。。</p>
                    <span class="comment-time">时间: 2017-09-27 22:01</span>
                    <span class="comment-reply"><a href="#comment-2930" onclick="reply_to('2930','Dropzero')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2919">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">M1a0</a></div>
                    <p>P牛 思考题 用cli-server可以嘛</p>
                    <span class="comment-time">时间: 2017-09-24 18:34</span>
                    <span class="comment-reply"><a href="#comment-2919" onclick="reply_to('2919','M1a0')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2920">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/c4267eb6d17276fa31c547ac71611e90.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="../index.html" target="_blank" rel="nofollow noopener">phithon</a></div>
                    <p>@M1a0 built-in server说到底还是web server，我的意思是不启动web server，直接在命令行运行。</p>
                    <span class="comment-time">时间: 2017-09-24 23:06</span>
                    <span class="comment-reply"><a href="#comment-2920" onclick="reply_to('2920','phithon')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2922">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">M1a0</a></div>
                    <p>@phithon 那用php-cgi直接调用php可以么</p>
                    <span class="comment-time">时间: 2017-09-25 00:03</span>
                    <span class="comment-reply"><a href="#comment-2922" onclick="reply_to('2922','M1a0')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2923">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/c4267eb6d17276fa31c547ac71611e90.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="../index.html" target="_blank" rel="nofollow noopener">phithon</a></div>
                    <p>@M1a0 可以的，这是一个方法。但在执行前还需要设置一下$_SERVER变量，因为phpjiami会检查$_SERVER[&#x27;REMOTE_ADDR&#x27;]等变量。</p>
                    <span class="comment-time">时间: 2017-09-25 00:06</span>
                    <span class="comment-reply"><a href="#comment-2923" onclick="reply_to('2923','phithon')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2924">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">fizz</a></div>
                    <p>@M1a0 你说的是 php -S localhost:8080这种的吧？</p>
                    <span class="comment-time">时间: 2017-09-25 13:36</span>
                    <span class="comment-reply"><a href="#comment-2924" onclick="reply_to('2924','fizz')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2917">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">233333</a></div>
                    <p>不求甚解是阻碍部分人进步的一大阻力</p>
                    <span class="comment-time">时间: 2017-09-24 00:52</span>
                    <span class="comment-reply"><a href="#comment-2917" onclick="reply_to('2917','233333')">回复</a></span>
                    </div>
                </div>
              </li>
            
            
            </ol>
            
        </div>

        <div id="reply"></div>
        <div id="comment-place">
            <div id="comment-post" class="respond none-resize">
             <div id="respond">
                <h3 id="response">添加新评论</h3>
                <form method="post" id="comment-form" role="form" action="#comments">
                    <p>
                        <label for="author" class="required">称呼</label>
                        <input type="text" name="nickname" placeholder="昵称" maxlength="64" required id="id_nickname">
                    </p>
                    <p>
                        <label for="mail">Email</label>
                        <input type="text" name="email" placeholder="邮箱（可留空）" maxlength="254" id="id_email">
                    </p>
                    <p>
                        <label for="url">网站</label>
                        <input type="text" name="url" placeholder="链接（可留空）" maxlength="200" id="id_url">
                    </p>
                    <p>
                        <label for="textarea" class="required">内容</label>
                        <textarea name="content" cols="40" rows="6" required id="id_content">
</textarea>
                    </p>
                    <p>
                        <label style="float:left;">验证码</label>
                        <div class="row gx-2" style="margin-top: 8px"><div class="col-6"><input autocomplete="off" id="id_captcha_1" name="captcha_1" type="text" placeholder="验证码" /> <input id="id_captcha_0" name="captcha_0" type="hidden" value="ff9f29535fa7f387719e25226a992ca4fbd39710" />
</div><div class="col-6">
<img src="../captcha/image/ff9f29535fa7f387719e25226a992ca4fbd39710/index.png" alt="captcha" class="captcha" /></div></div>
                    </p>
                    <p>
                        <button type="submit" class="submit">提交评论</button>
                        <input type="hidden" name="parent" id="id_parent">
                        <input type="hidden" name="archive" value="427" id="id_archive">
                        <input type="hidden" name="csrfmiddlewaretoken" value="3btGUrQkXDt5rXyAxBju2dzQeuqH7OYQPJRxswr3lZHOZvmYzCgfZGCVzRHSGqa8">
                    </p>
                </form>
                </div>
            </div>
        </div>

    </div>
    



<div  class="col-5 columns" id="sidebar" role="complementary">

  <div class="widget widget_search">
    <h3>搜索</h3>
    <form action="https://www.leavesongs.com/search/" id="searchform" method="get">
        <input type="text" id="searchkey" name="keyword" value="" class="searchkey" placeholder="Search..."/>
        <button type="submit"  id="searchsubmit">Go</button>
    </form>
  </div>

  
  <div class="widget">
	<h3 class="widget-title">最新评论</h3>
	<ul class="widget-list" id="recent-comment">
    
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>木木</cite>：<a href="../THINK/europe-trip-2022.html#comment-4523">虽然物价对比不出什么，但是还是觉得很高昂</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>dongdong4fei</cite>：<a href="../THINK/using-chatgpt-for-antispam.html#comment-4520">肯德基疯狂星期四！ 疯狂星期四！  https://m.kfc.com.cn/wechatco...</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>dongdong4fei</cite>：<a href="../THINK/using-chatgpt-for-antispam.html#comment-4519">小猪咪小猪咪小猪咪</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>sam</cite>：<a href="javascript-prototype-pollution-attack.html#comment-4518">还得是P神，文章一看就懂</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>程序</cite>：<a href="discuz72-sql-injection.html#comment-4517">很不错的文章</a></div>
        </li>
    
    </ul>
  </div>

  <div class="widget widget-category">
	<h3>分类</h3>
	<ul id="blogsort" class="widget-list">
    
    
    <li>
        <a href="../sort/PENETRATION.html">网络安全<em>143</em></a>
    </li>
    
    <li>
        <a href="../sort/C.html">C/C++<em>32</em></a>
    </li>
    
    <li>
        <a href="../sort/THINK.html">心得与体会<em>24</em></a>
    </li>
    
    <li>
        <a href="../sort/PYTHON.html">Python<em>19</em></a>
    </li>
    
    <li>
        <a href="../sort/SHARE.html">资源分享<em>16</em></a>
    </li>
    
    </ul>
  </div>

  <div class="widget widget-tag">
	<h3>随机标签</h3>
	<div class="tag-cloud">
        
        
        <a rel="tag" href="../tag/%E5%A4%A7%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86.html">大文件处理</a>
        
        <a rel="tag" href="../tag/%E5%9B%9E%E8%B0%83%E5%90%8E%E9%97%A8.html">回调后门</a>
        
        <a rel="tag" href="../tag/iOS.html">iOS</a>
        
        <a rel="tag" href="../tag/%E4%BD%8D%E8%BF%90%E7%AE%97.html">位运算</a>
        
        <a rel="tag" href="../tag/%E6%A1%A5%E6%8E%A5.html">桥接</a>
        
        <a rel="tag" href="../tag/writeup.html">writeup</a>
        
        <a rel="tag" href="../tag/IIS.html">IIS</a>
        
        <a rel="tag" href="../tag/WTForm.html">WTForm</a>
        
        <a rel="tag" href="../tag/apache.html">apache</a>
        
        <a rel="tag" href="../tag/web%E6%8C%87%E7%BA%B9.html">web指纹</a>
        
        <a rel="tag" href="../tag/%E6%B1%89%E8%AF%BA%E5%A1%94.html">汉诺塔</a>
        
        <a rel="tag" href="../tag/cmd%E5%90%8E%E9%97%A8.html">cmd后门</a>
        
        <a rel="tag" href="../tag/Linux.html">Linux</a>
        
        <a rel="tag" href="../tag/CSP.html">CSP</a>
        
        <a rel="tag" href="../tag/%E5%9B%A2%E9%98%9F.html">团队</a>
        
        <a rel="tag" href="../tag/phpwind.html">phpwind</a>
        
        <a rel="tag" href="../tag/%E6%80%BB%E7%BB%93.html">总结</a>
        
        <a rel="tag" href="../tag/%E9%81%8D%E5%8E%86%E7%9B%AE%E5%BD%95.html">遍历目录</a>
        
        <a rel="tag" href="../tag/C-FREE.html">C-FREE</a>
        
        <a rel="tag" href="../tag/var_dump.html">var_dump</a>
        
        <a rel="tag" href="../tag/disable_functions.html">disable_functions</a>
        
        <a rel="tag" href="../tag/%E6%8A%A5%E7%BA%B8.html">报纸</a>
        
        <a rel="tag" href="../tag/%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E.html">越权漏洞</a>
        
        <a rel="tag" href="../tag/web%E5%BA%94%E7%94%A8.html">web应用</a>
        
        <a rel="tag" href="../tag/360webscan.html">360webscan</a>
        
        <a rel="tag" href="../tag/asyncore.html">asyncore</a>
        
        <a rel="tag" href="../tag/%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87.html">沙盒绕过</a>
        
        <a rel="tag" href="../tag/fckeditor.html">fckeditor</a>
        
        <a rel="tag" href="../tag/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%80%9F%E5%BA%A6.html">数据库速度</a>
        
        <a rel="tag" href="../tag/kali.html">kali</a>
        
    </div>
  </div>

  <div class="widget widget-recent-entries">
	<h3 class="widget-title">热门日志</h3>
	<ul id="hotlog" class="widget-list">
    
    
        <li><a href="../other/tinger.html">About.Me</a></li>
    
        <li><a href="detect-django.html">如何判断目标站点是否为Django开发</a></li>
    
        <li><a href="webshell-without-alphanum-advanced.html">无字母数字webshell之提高篇</a></li>
    
        <li><a href="webshell-without-alphanum.html">一些不包含数字和字母的webshell</a></li>
    
        <li><a href="php-filter-magic.html">谈一谈php://filter的妙用</a></li>
    
    </ul>
  </div>
  

</div>
</div>

<div id="footer">
	<!-- copyright -->
	<div class="container">
		<div class="row remove-bottom">
			<div class="col-6 columns">
			<h3>Little About</h3>
			<p>Phithon 非强迫症小青年  <br>
现居先 <br>
爱好：种花、买书、收藏明信片 <br>
欢迎各大组织收留 <br>
E-mail：root@leavesongs.com </p>
			</div>

			<div class="col-10 columns">

				<h3 class="mobile-hide">Follow me</h3>
        <div id="social-links">
          <a href="http://weibo.com/101yx" class="sweibo" target="_blank" title="新浪微博">新浪微博</a>
          <a href="javascript:alert(/没有腾讯微博哟/)" class="qweibo" target="_blank" title="腾讯微博">腾讯微博</a>
          <a href="javascript:alert(/墙外有什么/);window.open('http://google.com')" class="google" target="_blank" title="墙外的世界">google+</a>
          <a href="https://github.com/phith0n" class="github" target="_blank" title="Github">github</a>
          <a href="javascript:confirm(/mailto:root#leavesongs.com/)" class="mail" target="_blank" title="私信给我">私信给我</a>
          <a href="../feed/index.rss" target="_blank" class="rss" title="离别歌">RSS订阅</a>
        </div>
        <div class="bot-line"></div>
				<p class="copyright">
	Copyright &copy; Powered by talkbook
				&nbsp;&nbsp;<i>Designed and built with all the love in the world by <a href="../index.html" target="_blank">Phithon</a> && deepsky </i>
                    <a href="../index.html">更换模板</a>
				</p>
			</div>
		</div>
	</div>
	<!-- /copyright -->
</div>
<a href="#" id="go-top">Top ↑</a>
<script src="https://cdn.staticfile.org/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/jquery.appear/0.4.1/jquery.appear.min.js"></script>
<script src="../static/deep/js/common_tpl.js" type="text/javascript"></script>
<script src="../static/deep/js/config.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FF5KPQ1CZ6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FF5KPQ1CZ6');
</script>

<script src="https://cdn.staticfile.org/fancybox/2.1.7/js/jquery.fancybox.min.js"></script>
<script>
$(document).ready(function () {
    $(".entry a").each(function (i, e) {
        if(e.host != 'www.leavesongs.com') {
            e.target = '_blank';
        }
    });
    $(".entry img").each(function (i, e) {
        if(e.parentNode.tagName.toUpperCase() != 'A') {
            $(e).wrap('<a href="'+escapeHtml(e.src)+'" class="fancybox"></a>');
        } else {
            $(e.parentNode).addClass('fancybox');
        }
    });
    $('.fancybox').fancybox();
})
</script>

</body>

</html>