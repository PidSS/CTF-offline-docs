
<!DOCTYPE html>
<html lang=en>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <meta name="description" content="phith0n的小站，长期存在与分享关于网络安全与各种编程的原创文章。">
  <meta name="keywords" content="phith0n,网络安全,代码审计,信息安全,漏洞挖掘,php,C++,mysql,python">
  <link rel="shortcut icon" href="../static/cactus/images/favicon.ico">
  <link rel="icon" type="image/png" href="../static/cactus/images/favicon-192x192.png" sizes="192x192">
  <link rel="apple-touch-icon" sizes="180x180" href="../static/cactus/images/apple-touch-icon.png">
  <link rel="alternate" type="application/atom+xml" href="../feed/index.rss" title="离别歌"/>

  <title>3DS userland漏洞那些事 | 离别歌</title>
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.staticfile.org/bootstrap/5.1.3/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="../static/cactus/css/style%EF%B9%96v=20220521.css">
  
  <link rel="stylesheet" href="../static/cactus/css/code%EF%B9%96v=20211026.css">
  <link href="https://cdn.staticfile.org/fancybox/2.1.7/css/jquery.fancybox.min.css" rel="stylesheet">

</head>
<body>



  <div class="sticky">
    <a href="#" id="menu-icon" class="menu-icon active"><i class="fa fa-bars fa-lg"></i></a>
    <div class="menu">
      <ul>
        <li><a href="../index.html">主页</a></li>
        <li><a href="javascript:history.back(-1)">返回</a></li>
      </ul>
      <br>
    </div>
    <div class="clearfix"></div>
    <div class="info" style="position: fixed">
      <span id="i-top" style="display: none">Back to top</span>
      <span id="i-share" style="display: none">Share post</span>
    </div>
    <ul class="actions">
      <li><a class="icon" href="#" id="back-top"><i
          class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();"
          onmouseout="$('#i-top').toggle();"></i></a></li>
      <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true"
                                      onmouseover="$('#i-share').toggle();"
                                      onmouseout="$('#i-share').toggle();"
                                      onclick="$('#share').toggleClass('hidden');return false;"></i></a></li>
    </ul>
    <div id="share" class="hidden">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3A//www.leavesongs.com/PENETRATION/talk-about-3ds-userland-flaw.html"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https%3A//www.leavesongs.com/PENETRATION/talk-about-3ds-userland-flaw.html&amp;text=3DS%20userland%E6%BC%8F%E6%B4%9E%E9%82%A3%E4%BA%9B%E4%BA%8B"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3A//www.leavesongs.com/PENETRATION/talk-about-3ds-userland-flaw.html&amp;title=3DS%20userland%E6%BC%8F%E6%B4%9E%E9%82%A3%E4%BA%9B%E4%BA%8B"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3A//www.leavesongs.com/PENETRATION/talk-about-3ds-userland-flaw.html&amp;is_video=false&amp;description=3DS%20userland%E6%BC%8F%E6%B4%9E%E9%82%A3%E4%BA%9B%E4%BA%8B"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=3DS%20userland%E6%BC%8F%E6%B4%9E%E9%82%A3%E4%BA%9B%E4%BA%8B&amp;body=Check out this article: https%3A//www.leavesongs.com/PENETRATION/talk-about-3ds-userland-flaw.html"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https%3A//www.leavesongs.com/PENETRATION/talk-about-3ds-userland-flaw.html&amp;title=3DS%20userland%E6%BC%8F%E6%B4%9E%E9%82%A3%E4%BA%9B%E4%BA%8B"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https%3A//www.leavesongs.com/PENETRATION/talk-about-3ds-userland-flaw.html&amp;title=3DS%20userland%E6%BC%8F%E6%B4%9E%E9%82%A3%E4%BA%9B%E4%BA%8B"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3A//www.leavesongs.com/PENETRATION/talk-about-3ds-userland-flaw.html&amp;title=3DS%20userland%E6%BC%8F%E6%B4%9E%E9%82%A3%E4%BA%9B%E4%BA%8B"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https%3A//www.leavesongs.com/PENETRATION/talk-about-3ds-userland-flaw.html&amp;title=3DS%20userland%E6%BC%8F%E6%B4%9E%E9%82%A3%E4%BA%9B%E4%BA%8B"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https%3A//www.leavesongs.com/PENETRATION/talk-about-3ds-userland-flaw.html&amp;name=3DS%20userland%E6%BC%8F%E6%B4%9E%E9%82%A3%E4%BA%9B%E4%BA%8B&amp;description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>
    </div>
  </div>

  <div class="container-md">
    <div class="article row justify-content-center min-height">
      <div class="col-lg-8 col-md-10 col-sm-12">
        <article itemscope itemtype="http://schema.org/BlogPosting">
          <header class="post-header">
            <h1 class="color-main h1 mb-0" itemprop="name headline">3DS userland漏洞那些事</h1>
            <div class="meta">
              <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <span itemprop="name">phithon</span>
              </span>

              <div class="postdate">
                <time datetime="2023年6月10日 01:48" itemprop="datePublished">
                  2023 六月 10 01:48
                </time>
              </div>

              <div class="article-tag">
                阅读：5047
              </div>

              
                <div class="article-tag">
                  <i class="fa fa-bookmark"></i>
                  <a class="tag-link" href="../sort/PENETRATION.html">网络安全</a>
                </div>
              

              
                <div class="article-tag">
                  <i class="fa fa-tag"></i>
                  
                    <a class="tag-link" href="../tag/%E7%A0%B4%E8%A7%A3.html">破解</a>,
                  
                  
                    <a class="tag-link" href="../tag/3ds.html">3ds</a>
                  
                </div>
              
            </div>
          </header>
          <div class="content" itemprop="articleBody">
            <p>我与掌机结缘是从初中时代就开始了，但严格意义上来讲，在我的少年时代，我是没有拥有过掌机的。小时候家里没有给我买过任何游戏机，但我曾拥有过一台学习机——名人Windows CE。虽然被冠以“学习机”的名义，但实际上这是一台搭载Windows CE系统的掌上电脑（PDA），在2008年那个智能手机还没有出世的年代，我竟拥有了一台跨时代的智能大屏设备。</p>
<p>当时我在CE上装了很多原生的Windows游戏，也装了不少模拟器，包括GBA、NES等等，这些游戏陪初中的我度过了许多个日夜。当然，这些就是另一个故事了，以后有机会再讲。</p>
<p>就是因为这段经历，所以我对掌机游戏其实一直有爱好，所以大概在2015年我买了自己人生第一台掌机，就是新大三（New 3DSLL）。当时在电玩巴士淘宝店购买的，到手就是破解好的状态。但当时的我对3DS破解这块一窍不通，以至于一度不敢随便升级它的系统，忍受老系统一堆堆的Bug，直到疫情期间我才摸索着研究了如何将它从A9LH升级到B9S破解，并升级了最新的系统。</p>
<p>今年（2023年）三月我去了趟东京，在中古店花了差不多国内一半的价钱拿下了一台老小三（Old 3DS）和一台新小三（New 3DS），至此我就拥有三台不同型号的3DS了。</p>
<p><a href="../media/attachment/2023/06/10/1fbdc6ac-42f3-4ad4-8fb2-916edaf4af26.jpg"><img alt="3b9f5bd30cb2cbe665cd72b0b567a85.jpg" src="../media/attachment/2023/06/10/1fbdc6ac-42f3-4ad4-8fb2-916edaf4af26.fac8c5fa23a0.jpg" /></a></p>
<p>差不多也就在这个月，任天堂正式关闭了3DS的eShop服务器，也就意味着3DS这款设备已经走向了生命周期的尽头。那么如今，回看十多年来安全研究者和任天堂官方的博弈，其实还是蛮有趣的。</p>
<p>自从有了游戏机，“破解”就一定是一个无法跳过的话题，现如今3DS的破解已经比较成熟了，大部分情况下都可以“软破解”——即在无需任何硬件辅助或修改的情况下完成破解。</p>
<p>这些软破解主要使用到了两层漏洞：</p>
<ul>
<li>用户级（Userland）漏洞，攻击者需要首先通过一些用户级漏洞获取系统权限，才能进一步利用内核漏洞</li>
<li>内核级（Kernel）漏洞，利用内核漏洞即可加载自定义固件，最后再安装破解游戏</li>
</ul>
<p>Boot9Strap就是利用内核级漏洞，在系统启动的Boot9阶段加载自定义代码，最后接管系统的控制权，进入用户自定义固件完成破解。这里面涉及的漏洞是硬件原因导致的，所以任天堂官方无法通过升级系统版本的方式修复Boot9Strap。</p>
<p>那么对于官方来讲，如果要与破解行为做对抗，则必须从用户级漏洞入手，让用户无法获得系统权限，也就无法安装Boot9Strap了。</p>
<p>本篇文章就来简单介绍一下，我们破解3DS的过程中都有使用到哪些用户级漏洞，以及官方与安全研究者的对抗过程。</p>
<h2 id="soundhax"><a class="toclink" href="#soundhax">Soundhax</a></h2>
<p>参考：</p>
<ul>
<li><a href="https://3ds.hacks.guide/installing-boot9strap-(soundhax)" target="_blank">https://3ds.hacks.guide/installing-boot9strap-(soundhax)</a></li>
<li><a href="https://github.com/nedwill/soundhax" target="_blank">https://github.com/nedwill/soundhax</a></li>
</ul>
<p>Soundhax漏洞是3DS中第一个免费、离线、稳定的漏洞与利用方法，利用涵盖了11.3以前的所有版本。</p>
<p>Soundhax实际上是一个Sound应用的堆溢出漏洞，Sound是3DS中的播放器，在播放恶意的m4a文件的过程中存在堆溢出漏洞，利用该漏洞就可以方便地在应用层执行任意代码。</p>
<p>我在日本买的Old 3DS就是通过这个方式破解，过程非常美妙。</p>
<p>该漏洞适配的3ds版本如下：</p>
<table>
<thead>
<tr>
<th>Version</th>
<th>N3DS/N2DS</th>
<th>O3DS/2DS</th>
</tr>
</thead>
<tbody>
<tr>
<td>US 1.0-11.3</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr>
<td>JPN 1.0-11.3</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr>
<td>EUR 1.0-11.3</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr>
<td>KOR 4.0-11.3</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr>
<td>CHN 4.0-11.3</td>
<td>N/A</td>
<td>✓</td>
</tr>
<tr>
<td>TWN 4.1-11.3</td>
<td>N/A</td>
<td>✓</td>
</tr>
</tbody>
</table>
<h2 id="browserhaxssloth"><a class="toclink" href="#browserhaxssloth">Browserhax+SSLoth</a></h2>
<p>参考：</p>
<ul>
<li><a href="https://mrnbayoh.github.io/blog/exploiting-the-3ds-browsers-p1/" target="_blank">https://mrnbayoh.github.io/blog/exploiting-the-3ds-browsers-p1/</a></li>
<li><a href="https://mrnbayoh.github.io/blog/exploiting-the-3ds-browsers-p2/" target="_blank">https://mrnbayoh.github.io/blog/exploiting-the-3ds-browsers-p2/</a></li>
<li><a href="https://github.com/zoogie/old-browserhax" target="_blank">https://github.com/zoogie/old-browserhax</a></li>
<li><a href="https://github.com/zoogie/new-browserhax" target="_blank">https://github.com/zoogie/new-browserhax</a></li>
<li><a href="https://github.com/MrNbaYoh/3ds-ssloth" target="_blank">https://github.com/MrNbaYoh/3ds-ssloth</a></li>
</ul>
<p>这是以下三个漏洞的集合：</p>
<ul>
<li>old-browserhax</li>
<li>new-browserhax</li>
<li>ssloth</li>
</ul>
<p>其中，old-browserhax和new-browserhax分别是Old 3DS和New 3DS使用的利用方式。虽然Old 3DS和New 3DS使用的浏览器存在区别（SPIDER和SKATER），但二者均基于老版本的Webkit，所以通过浏览器漏洞进行破解是常见操作。</p>
<p>old-browserhax对应的漏洞是<a href="https://github.com/mrnbayoh" target="_blank">mrnbayoh</a>通过fuzz找到的UAF漏洞，new-browserhax对应的漏洞是<a href="https://bugs.chromium.org/p/chromium/issues/detail?id=240124" target="_blank">CVE-2013-2857</a>。</p>
<p>由于使用了Webkit内核，3DS浏览器需要遵守LGPL开源协议将<a href="https://www.nintendo.co.jp/support/oss/index.html" target="_blank">源码</a>开放下载，导致大量安全研究者可以直接通过代码审计的方式寻找漏洞。</p>
<p>对于层出不穷的浏览器漏洞，任天堂官方在9.9.0系统中增加了浏览器版本检查——3DS只有在升级了最新版系统后才能使用浏览器，这导致很多基于老版本浏览器漏洞的破解方式受到影响。</p>
<p><strong>SSLoth</strong>漏洞就用来解决这个问题，它是存在于系统SSL模块中的一个漏洞，允许攻击者伪造证书，进而伪造任天堂官方服务器进行中间人攻击，让机器认为自己当前版本就是最新版，这样就可以使用浏览器了。</p>
<p>互联网上有一个使用了SSLoth搭建的公开代理服务器<code>192.9.234.11:8080</code>，只要将系统代理设置成这个服务器，即可完成版本欺骗攻击。结合这两个漏洞，打开浏览器即可触发漏洞。</p>
<p>SSLoth漏洞影响版本：</p>
<table>
<thead>
<tr>
<th>Firmware</th>
<th>Version</th>
<th>N3DS/N2DS</th>
<th>O3DS/2DS</th>
</tr>
</thead>
<tbody>
<tr>
<td>SAFE_FIRM（3DS安全模式）</td>
<td>&lt;11.15</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr>
<td>NATIVE_FIRM</td>
<td>1.0-11.13</td>
<td>✓</td>
<td>✓</td>
</tr>
<tr>
<td>NATIVE_FIRM</td>
<td>&gt; 11.13</td>
<td>✗</td>
<td>✗</td>
</tr>
</tbody>
</table>
<p>old-browserhax影响版本：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">11.9.0</span><span class="o">-</span><span class="mf">42</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">11.13.0</span><span class="o">-</span><span class="mf">45</span><span class="w"> </span><span class="kr">for</span><span class="w"> </span><span class="n">USA</span><span class="p">,</span><span class="w"> </span><span class="n">EUROPE</span><span class="p">,</span><span class="w"> </span><span class="n">JAPAN</span><span class="p">,</span><span class="w"> </span><span class="n">KOREA</span><span class="p">,</span><span class="w"> </span><span class="n">CHINA</span><span class="p">,</span><span class="w"> </span><span class="n">TAIWAN</span><span class="w"> </span><span class="p">(</span><span class="n">hbmenu</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">boot9strap</span><span class="p">)</span>
<span class="mf">11.10.0</span><span class="o">-</span><span class="mf">43</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">11.13.0</span><span class="o">-</span><span class="mf">45</span><span class="w"> </span><span class="n">EUROPE</span><span class="w"> </span><span class="p">(</span><span class="n">hbmenu</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">boot9strap</span><span class="p">)</span>
<span class="mf">11.4.0</span><span class="o">-</span><span class="mf">37</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">11.8.0</span><span class="o">-</span><span class="mf">41</span><span class="w"> </span><span class="kr">for</span><span class="w"> </span><span class="n">USA</span><span class="p">,</span><span class="w"> </span><span class="n">EUROPE</span><span class="p">,</span><span class="w"> </span><span class="n">JAPAN</span><span class="w"> </span><span class="p">(</span><span class="n">boot9strap</span><span class="w"> </span><span class="kr">on</span><span class="n">ly</span><span class="p">)</span>
</code></pre></div>

<p>new-browserhax影响版本：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">11.9.0</span><span class="o">-</span><span class="mf">42</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">11.13.0</span><span class="o">-</span><span class="mf">45</span><span class="w"> </span><span class="kr">for</span><span class="w"> </span><span class="n">USA</span><span class="p">,</span><span class="w"> </span><span class="n">JAPAN</span><span class="w"> </span><span class="p">(</span><span class="n">hbmenu</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">boot9strap</span><span class="p">)</span>
<span class="mf">11.10.0</span><span class="o">-</span><span class="mf">43</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">11.13.0</span><span class="o">-</span><span class="mf">45</span><span class="w"> </span><span class="kr">for</span><span class="w"> </span><span class="n">EUROPE</span><span class="w"> </span><span class="p">(</span><span class="n">hbmenu</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">boot9strap</span><span class="p">)</span>
<span class="mf">11.9.0</span><span class="o">-</span><span class="mf">36</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">11.13.0</span><span class="o">-</span><span class="mf">39</span><span class="w"> </span><span class="kr">for</span><span class="w"> </span><span class="n">KOREA</span><span class="w"> </span><span class="p">(</span><span class="n">hbmenu</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">boot9strap</span><span class="p">)</span>
<span class="mf">11.4.0</span><span class="o">-</span><span class="mf">37</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">11.8.0</span><span class="o">-</span><span class="mf">41</span><span class="w"> </span><span class="kr">for</span><span class="w"> </span><span class="n">USA</span><span class="p">,</span><span class="w"> </span><span class="n">EUROPE</span><span class="p">,</span><span class="w"> </span><span class="n">JAPAN</span><span class="w"> </span><span class="p">(</span><span class="n">boot9strap</span><span class="w"> </span><span class="kr">on</span><span class="n">ly</span><span class="p">)</span>
</code></pre></div>

<h2 id="browserhax-xlssloth"><a class="toclink" href="#browserhax-xlssloth">browserhax-XL+SSLoth</a></h2>
<p>参考：</p>
<ul>
<li><a href="https://github.com/zoogie/old-browserhax-XL/" target="_blank">https://github.com/zoogie/old-browserhax-XL/</a></li>
<li><a href="https://github.com/zoogie/new-browserhax-XL" target="_blank">https://github.com/zoogie/new-browserhax-XL</a></li>
</ul>
<p>这个利用是old-browserhax和new-browserhax的继任者，因为这两个漏洞在11.14系统版本中被修复了，所以作者先尝试继续进行fuzz，并在SPIDER和SKATER中分别找到两个新的UAF漏洞并编写了利用。</p>
<p>当然，因为同样是浏览器漏洞，所以需要配合SSLoth使用。</p>
<p>值得注意的一点是，在11.14版本中其实SSLoth漏洞已经被修复了，无法直接在正常系统模式下使用；但是3DS有个安全模式（SAFE_FIRM）仍然存在这个问题，我们重启系统时按住L+R+Up+A即可进入安全模式并联网更新。此时使用SSLoth漏洞劫持更新服务器，运行我们的利用即可。</p>
<p>这两个新漏洞生命周期都很短，只影响<code>11.14.0-46</code>，很快被修复。</p>
<h2 id="seedminerbannerbomb3"><a class="toclink" href="#seedminerbannerbomb3">Seedminer+BannerBomb3</a></h2>
<p>参考：</p>
<ul>
<li><a href="https://github.com/zoogie/Bannerbomb3" target="_blank">https://github.com/zoogie/Bannerbomb3</a></li>
<li><a href="https://seedminer.hacks.guide/" target="_blank">https://seedminer.hacks.guide/</a></li>
</ul>
<p>BannerBomb3是利用主机DSiWare数据管理中的一个漏洞，我们构造恶意的DSiWare备份并让主机加载，即可触发漏洞。</p>
<p>但是构造恶意DSiWare备份需要计算（爆破）出主机的加密密钥，需要一定的算力支持，可以在上面的网站中进行云爆破。</p>
<p>完整破解过程如下：</p>
<ol>
<li>数据收集： 首先，需要收集一些关键信息，包括用户的3DS友好码（Friend Code）和设备的可移动（movable）种子（一个关键的加密数据文件）。</li>
<li>种子破解（Bruteforce）： 这一步是Seedminer破解的核心。这里利用一个称为“bruteforcemovable”的工具，通过尝试大量的可能性来破解用户可移动种子的LFCS（Local Friend Code Seed）。这个过程可能需要一些时间，因为需要在多个可能的种子中找到正确的一个。这是一个暴力破解（bruteforce）过程，通常需要借助GPU计算能力来加速。</li>
<li>安装自制启动器（boot9strap）： 成功获取可移动种子后，使用一个名为“Frogtool”的工具将种子注入到一个特定的DSiWare游戏中。在这个过程中，会将DSiWare游戏修改为一个能够引导自制固件（如Luma3DS）的启动器。用户需要将这个修改过的游戏安装到3DS设备上。</li>
<li>安装自制固件（如Luma3DS）： 通过修改的DSiWare游戏启动后，用户需要安装一个自制固件，通常是Luma3DS。自制固件允许用户运行未经任天堂官方认证的软件和游戏，实现更多的自定义功能。</li>
</ol>
<p>原本这个Seedminer的漏洞是所有3DS破解的终极解，任何系统不用考虑前面所有的利用方法，直接将系统升级到最新版即可使用该方式破解。</p>
<p>但是2023年5月23日，任地狱突然给走向生命终结的3DS更新了新版系统11.17.0，在US/EU/JP地区修复了BannerBomb3漏洞。所以该漏洞最终影响版本仅为：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">VERSION</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">11</span>.<span class="mi">17</span>.<span class="mi">0</span><span class="o">-</span><span class="mi">50</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">US</span><span class="o">/</span><span class="nv">EU</span><span class="o">/</span><span class="nv">JP</span>
</code></pre></div>

<h2 id="super-skaterhax"><a class="toclink" href="#super-skaterhax">super-skaterhax</a></h2>
<p>参考：<a href="https://github.com/zoogie/super-skaterhax" target="_blank">https://github.com/zoogie/super-skaterhax</a></p>
<p>前面的new-browserhax-XL被修复后，作者继续努力，找到了新的漏洞。不过这次作者只研究了New 3DS的浏览器SKATER，所以super-skaterhax这个利用仅限于New 3DS中。</p>
<p>这虽然仍是一个浏览器的UAF漏洞，但因为这个漏洞截止到今天（2023年6月9日）为止的最新版本11.17.0都没有修复，所以我们只需要把系统升级到最新版本即可，不再需要配合SSLoth漏洞使用。</p>
<p>漏洞影响版本：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">11.15</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">11.17</span><span class="w"> </span><span class="kr">on</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="mf">4</span><span class="w"> </span><span class="kr">new</span><span class="mf">3</span><span class="n">ds</span><span class="w"> </span><span class="n">regions</span><span class="w"> </span><span class="n">US</span><span class="p">,</span><span class="n">EU</span><span class="p">,</span><span class="n">JP</span><span class="p">,</span><span class="n">KR</span>
</code></pre></div>

<p>这个漏洞就是目前为止New 3DS的终极解。</p>
<h2 id="safecerthax"><a class="toclink" href="#safecerthax">safecerthax</a></h2>
<p>参考：</p>
<ul>
<li><a href="https://github.com/MrNbaYoh/safecerthax" target="_blank">https://github.com/MrNbaYoh/safecerthax</a></li>
<li><a href="https://safecerthax.rocks/" target="_blank">https://safecerthax.rocks/</a></li>
</ul>
<p>Old 3DS的安全模式（SAFE_FIRM）基于非常老的3.0系统版本，所以很多新版本已经修复的漏洞可以通过安全模式继续利用。</p>
<p>safecerthax就是利用这个原理，在进入Old 3DS安全模式后，利用了5.0.0以前存在的一处漏洞（<code>PXIAM:ImportCertificates</code>堆溢出），在ARM9 CPU上执行任意代码（3DS有两块CPU，ARM9和ARM11）。</p>
<p>漏洞影响版本：</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Model</th>
<th style="text-align: left;">Firmware</th>
<th style="text-align: left;">Version</th>
<th style="text-align: left;">Vulnerable?</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">O3DS/2DS</td>
<td style="text-align: left;">SAFE_FIRM</td>
<td style="text-align: left;">&lt;11.15.0</td>
<td style="text-align: left;">✓</td>
</tr>
<tr>
<td style="text-align: left;">O3DS/2DS</td>
<td style="text-align: left;">NATIVE_FIRM</td>
<td style="text-align: left;">1.0.0-4.4.0</td>
<td style="text-align: left;">✓</td>
</tr>
<tr>
<td style="text-align: left;">O3DS/2DS</td>
<td style="text-align: left;">NATIVE_FIRM</td>
<td style="text-align: left;">&gt;=5.0.0</td>
<td style="text-align: left;">✗</td>
</tr>
<tr>
<td style="text-align: left;">N3DS/N2DS</td>
<td style="text-align: left;">all</td>
<td style="text-align: left;">all</td>
<td style="text-align: left;">✗</td>
</tr>
</tbody>
</table>
<p>但这个漏洞也不是Old 3DS的终极解决方案，在11.15.0后被修掉。（修掉的应该是SSLoth，这点我不太确定）</p>
<p>所以，截止到2023年6月9日，在BannerBomb3不能使用的最新版11.17.0中，Old 3DS是无法软破解的。所以，如果你的机器是在这个版本以下，千万不要升级最新版。</p>
<h2 id="ntrbootr4"><a class="toclink" href="#ntrbootr4">ntrboot+R4烧录卡硬破</a></h2>
<p>参考：</p>
<ul>
<li><a href="https://3ds.hacks.guide/ntrboot" target="_blank">https://3ds.hacks.guide/ntrboot</a></li>
</ul>
<p>这个就是最后的办法，如果上面的所有软破解方法都不能使用，比如最新版本Old 3DS，那么就只能使用硬破解的方式。</p>
<p>如果之前买过R4烧录卡，那么就不用在买额外的硬件设备，可以直接将ntrboot安装进烧录卡中。</p>
<p>然后通过磁铁，让3DS在启动时引导加载带ntrboot的固件，最后完成漏洞利用。</p>
          </div>
        </article>

        
          <h1 class="h1 color-main">赞赏</h1>
          <div class="zan text-center">
            <p>喜欢这篇文章？打赏1元</p>
            <p class="m-0"><img src="../static/wx.jpg" width="280" alt=""></p>
          </div>
        

        <div id="reply-list">
          <h1 class="h1 color-main">评论</h1>
          
            
          
        </div>

        

        <form method="post" enctype="multipart/form-data" action="#reply" id="reply" class="mb-4">
          <div class="container-fluid px-0">
            
            <div class="row">
              <div class="col">
                <textarea name="content" cols="40" rows="6" required id="id_content">
</textarea>
              </div>
            </div>
            <div class="row gx-2">
              <div class="col-4">
                <input type="text" name="nickname" placeholder="昵称" maxlength="64" required id="id_nickname">
              </div>
              <div class="col-4">
                <input type="text" name="email" placeholder="邮箱（可留空）" maxlength="254" id="id_email">
              </div>
              <div class="col-4">
                <input type="text" name="url" placeholder="链接（可留空）" maxlength="200" id="id_url">
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-4">
              <div class="row gx-2" style="margin-top: 8px"><div class="col-6"><input autocomplete="off" id="id_captcha_1" name="captcha_1" type="text" placeholder="验证码" /> <input id="id_captcha_0" name="captcha_0" type="hidden" value="5fcd91710e307b2c7ec68a1291ec654b3ce7699d" />
</div><div class="col-6">
<img src="../captcha/image/5fcd91710e307b2c7ec68a1291ec654b3ce7699d/index.png" alt="captcha" class="captcha" /></div></div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <input type="submit" class="ui-button ui-button-sgreen" value="提交">
            </div>
          </div>
          <input type="hidden" name="archive" value="493" id="id_archive">
          <input type="hidden" name="parent" id="id_parent">
          <input type="hidden" name="csrfmiddlewaretoken" value="k3CZBXaPGceHc6lDQ8CTyc9fDO6blwUg6B0Q92Ly4ysqKE91S9zEvFckYbnmU86y">
        </form>
      </div>
    </div>
    <div class="row justify-content-center">
      <div class="col-lg-7 col-md-10 col-sm-12">
        <footer class="footer mx-auto">
  <div class="footer-left">
    Copyright &copy; 2023 Powered by talkbook
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <li><a href="../index.html">首页</a></li>
        <li><a href="../feed/index.rss" target="_blank">RSS订阅</a></li>
        <li><a href="http://weibo.com/101yx" target="_blank">微博</a></li>
        <li><a href="https://github.com/phith0n" target="_blank">项目</a></li>
        <li><a href="../index.html">更换模板</a></li>
      </ul>
    </nav>
  </div>
</footer>
      </div>
    </div>
  </div>

<script src="https://cdn.staticfile.org/jquery/2.2.4/jquery.min.js"></script>
<script src="../static/cactus/js/main%EF%B9%96v=2021102502.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FF5KPQ1CZ6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FF5KPQ1CZ6');
</script>

  <script src="https://cdn.staticfile.org/fancybox/2.1.7/js/jquery.fancybox.min.js"></script>
  <script>
      $(document).ready(function () {
          $(".content a").each(function (i, e) {
              if (e.host != 'www.leavesongs.com') {
                  e.target = '_blank';
              }
          });
          $(".content img").each(function (i, e) {
              if (e.parentNode.tagName.toUpperCase() != 'A') {
                  $(e).wrap('<a href="' + escapeHtml(e.src) + '" class="fancybox"></a>');
              } else {
                  $(e.parentNode).addClass('fancybox');
              }
          });
          $('.fancybox').fancybox();
      })
  </script>

</body>
</html>