

<html class="no-js">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="keywords" content="" />
    <meta name="description" content="phith0n的小站，长期存在与分享关于网络安全与各种编程的原创文章。" />
    <title>Wordpress4.2.3提权与SQL注入漏洞(CVE-2015-5623)分析 | 离别歌</title>
    <link rel="alternate" type="application/atom+xml" href="../feed/index.rss" title="离别歌" />
    <link href="../static/deep/css/base.css" rel="stylesheet" type="text/css" />
    <link href="../static/deep/css/style.css" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="../static/deep/images/favicon.ico" />
    
<style>div.row .col-xs-4 {
  float: left;
  margin-left: 4px;
}
div.row .col-xs-4 img {
  margin-left: 5px;
}
</style>
<link href="https://cdn.staticfile.org/fancybox/2.1.7/css/jquery.fancybox.min.css" rel="stylesheet">
<link rel="stylesheet" href="../static/deep/css/code.css">

</head>
<body>
<!--[if lt IE 8]>
    <div class="browsehappy" role="dialog">当前网页 <strong>不支持</strong> 你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.</div>
<![endif]-->
<div id="header">
    <div class="container">
        <h1 class="h1-title">
            <a href="../index.html">
               <img src="../static/deep/images/logo.png" alt="离别歌" />
            </a>
        </h1>
        <div id="nav">
        <input type="checkbox" id="button">
        <label for="button" onclick>菜单</label>
        
        <ul>
            
            <li class="item ">
                <a href="../index.html" >首页</a>
            </li>
            
            <li class="item ">
                <a href="../list/index.html" >文章</a>
            </li>
            
            <li class="item ">
                <a href="../other/tinger.html" >关于</a>
            </li>
            
            <li class="item ">
                <a href="../other/friends-link.html" >友链</a>
            </li>
            
            <li class="item ">
                <a href="https://github.com/phith0n" target="_blank" >项目</a>
            </li>
            
            <li class="item ">
                <a href="https://www.leavesongs.com/PENETRATION/code-auditor-secret-group.html" target="_blank" >代码审计</a>
            </li>
            
        </ul>
        
        </div>
    </div>
</div>

<div class="banner-bar">
    <div class="container">
        <div class="col-12 columns">
            <div class="place">
                <a href="../index.html">首页</a>
                &raquo;
                
                网络安全 &raquo; <a href="cve-2015-5623-and-wordpress-sql-injection.html">Wordpress4.2.3提权与SQL注入漏洞(CVE-2015-5623)分析</a>
                
            </div>
        </div>
    </div>
</div>
<div class="container">
    <div class="col-11 columns" id="mainbody" role="main">
        <div class="post-single type-post">
            <h1 class="article-h1">Wordpress4.2.3提权与SQL注入漏洞(CVE-2015-5623)分析</h1>
            <div class="details-up">
  <span class="author">作者: None</span>
  
  <span class="category">分类: <a href="../sort/PENETRATION.html">网络安全</a></span>
  
  <span class="date">时间: 2015-8-18 14:22</span>
  <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl" href="#reply-list">4条评论</a></span>
  <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl" href="cve-2015-5623-and-wordpress-sql-injection.html">14990人看过</a></span>
  
  <span class="date">标签:
    
        <a href="../tag/%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E.html">越权漏洞</a>
    
        <a href="../tag/wordpress.html">wordpress</a>
    
        <a href="../tag/%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html">注入漏洞</a>
    
  </span>
  
</div>
            <div class="entry">
                <p>这是我在TSRC实习期间的研究任务X号：<a href="http://security.tencent.com/index.php/blog/msg/93"><a href="http://security.tencent.com/index.php/blog/msg/93">http://security.tencent.com/index.php/blog/msg/93</a></a></p>
<p>这是这几天一直关注的漏洞了，wordpress上个礼拜发布的4.2.4版本，其中提到修补了可能存在的SQL漏洞和多个XSS。</p>
<p>Check point也很快发出了分析，我也来分析与复现一下最新的这个漏洞。</p>
<h2 id="0x01-gp"><a class="toclink" href="#0x01-gp">0x01 GP混用造成的越权漏洞</a></h2>
<p>首先，说明一下背景。wordpress中用户权限分为订阅者、投稿者、作者、编辑和管理员。</p>
<p>权限最低的是订阅者，订阅者只有订阅文章的权限，wordpress开启注册后默认注册的用户就是订阅者。国内很多知名网站，如Freebuf，用户注册后身份即为“订阅者”。</p>
<p>我们先看到一个提权漏洞，通过这个提权漏洞，我们作为一个订阅者，可以越权在数据库里插入一篇文章。</p>
<p>Wordpress检查用户权限是调用current_user_can函数，我们看到这个函数：</p>
<p><a href="../content/uploadfile/201508/29551439879078.png"><img alt="image001.png" src="../content/uploadfile/201508/thum-29551439879078.png" /></a> </p>
<p>调用的has_cap方法，跟进</p>
<p><a href="../content/uploadfile/201508/25ae1439879079.png"><img alt="image003.png" src="../content/uploadfile/201508/thum-25ae1439879079.png" /></a></p>
<p>再次跟进map_meta_cap函数：</p>
<p><a href="../content/uploadfile/201508/f3c81439879079.png"><img alt="image005.png" src="../content/uploadfile/201508/thum-f3c81439879079.png" /></a> </p>
<p>可以见到，这个函数是真正检查权限的。出错误的代码在检查’edit_post’和’edit_page’的部分：</p>
<p><a href="../content/uploadfile/201508/46071439879080.png"><img alt="image007.png" src="../content/uploadfile/201508/thum-46071439879080.png" /></a> </p>
<p>可见，这里当$post不存在的时候，直接break出switch逻辑了，后面所有检查的代码都没有执行。</p>
<p>$post是要编辑的文章的ID，也就是说，如果我要编辑一篇不存在的文章，这里不检查权限直接返回。</p>
<p>正常情况下是没有问题的，因为不存在的文章也没有编辑一说了。</p>
<p>我们再看到后台编辑文章的部分：/wp-admin/post.php</p>
<p><a href="../content/uploadfile/201508/7dfd1439879080.png"><img alt="image009.png" src="../content/uploadfile/201508/thum-7dfd1439879080.png" /></a> </p>
<p>这里首先获取$_GET['post']，找不到才获取$_POST['post_ID']，也就是可以说此时的$post_ID是来自GET的。</p>
<p>但我们后面调用current_user_can函数时传入的post_ID却是来自POST的：</p>
<p><a href="../content/uploadfile/201508/e1fb1439879081.png"><img alt="image011.png" src="../content/uploadfile/201508/thum-e1fb1439879081.png" /></a></p>
<p>这里就是一个逻辑问题，当我们在GET参数中传入正确的postid（这样在get_post的时候不会产生错误），而在POST参数中传入一个不存在的postid，那么就能够绕过检查edit_post权限的步骤。</p>
<p>但是这个逻辑错误暂时不能造成严重的危害，因为实际上编辑文章的代码在edit_post函数中，而这个函数取的post_ID来自$_POST。</p>
<h2 id="0x02_wpnoncecsrf"><a class="toclink" href="#0x02_wpnoncecsrf">0x02获取_wpnonce绕过CSRF防御</a></h2>
<p>wordpress对于CSRF漏洞的防御措施是使用_wpnonce（也就是token），而且它的token很严格，不同的操作有不同的token。</p>
<p>比如我们这里，如果想调用edit_post函数，需要经过以下逻辑：</p>
<p><a href="../content/uploadfile/201508/47c11439879081.png"><img alt="image013.png" src="../content/uploadfile/201508/thum-47c11439879081.png" /></a></p>
<p>check_admin_referer就是检查_wpnonce的函数，当$post_type==’postajaxpost’的时候，此时_wpnonce的名字就是“add-postajaxpost”。</p>
<p>那么怎么获取名字为”add-postajaxpost”的_wpnonce呢？</p>
<p>看到上面一点的位置：</p>
<p><a href="../content/uploadfile/201508/4c4f1439879082.png"><img alt="image015.png" src="../content/uploadfile/201508/thum-4c4f1439879082.png" /></a></p>
<p>有个post-quickdraft-save操作。这个操作是用来临时储存草稿的，只要用户访问这个操作，就会在数据库post表中插入一个status为auto-draft的新文章。</p>
<p>如上图画出来的步骤，因为我们不知道名字为”add-post”的_wpnonce，所以进入到wp_dashboard_quick_press函数，跟进：</p>
<p><a href="../content/uploadfile/201508/37991439879082.png"><img alt="image017.png" src="../content/uploadfile/201508/thum-37991439879082.png" /></a> </p>
<p>见上图，很幸运的是，在这个函数中wordpress居然自己把此时的_wpnonce输出在表单里了。</p>
<p>所以，只要我们访问一次post-quickdraft-save，就可以获得add-post的_wpnonce，从而绕过check_admin_referer函数。</p>
<h2 id="0x03"><a class="toclink" href="#0x03">0x03 竞争漏洞导致的逻辑漏洞</a></h2>
<p>这一节实际上是这个提权洞的真正核心，在我们拿到_wpnonce后，进入edit_post函数。</p>
<p>我们目的是去update一篇文章，但刚才0x01中说到，如果要绕过权限检查的函数，需要传入一个“不存在”的文章id。那么即使可以执行update，我们也不可能修改已经存在的文章呀？</p>
<p>这里实际上涉及到一个由竞争造成的逻辑漏洞。看到edit_post函数代码：</p>
<p><a href="../content/uploadfile/201508/d7151439879085.png"><img alt="image019.png" src="../content/uploadfile/201508/thum-d7151439879085.png" /></a> </p>
<p><a href="../content/uploadfile/201508/b2691439879088.png"><img alt="image021.png" src="../content/uploadfile/201508/thum-b2691439879088.png" /></a></p>
<p>上面两个图应该很直观了。在0x01中说到的current_user_can被绕过以后，到最终执行update语句中间，这一段代码的执行时间是真空的。</p>
<p>比如我们传入的tax_input=1,2,3,4…10000，那么实际上那条查询语句就要执行10000次，这是需要执行很长时间的。（在我自己的虚拟机上测试，执行10000次这条语句，大概需要5~10秒左右）</p>
<p>那么假设在这段时间内，有新插入的文章，那么我们之前那个“不存在”的id，不就可能可以存在了吗（只需要把id设置为最新一篇文章id+1）？</p>
<p>但有个问题是，我们怎么在这段时间内插入一篇新的文章？因为在0x02中为了获取_wpnonce，已经执行过post-quickdraft-save了。执行post-quickdraft-save可以在数据库插入一篇status为auto-draft的文章，但每个用户最多只会插入一篇文章。</p>
<p>在check-point的原文中，它提到的方法是，等待一个星期，wordpress会自动将这篇文章删除，而_wpnonce会多保留一天，这样在这天我们再次执行post-quickdraft-save又可以插入一篇文章了。</p>
<p>我自己想了一下，其实没必要这么麻烦。如果我们能够再注册一个身份为订阅者的账号，就可以再插入一篇文章了，所以我的POC是不需要等待一个礼拜的。</p>
<p>这三个漏洞组合起来，造成了一个提权漏洞。针对第一篇文章描述的提权漏洞，我写了一个EXP，执行后订阅者就可以在垃圾桶内插入一篇文章：</p>
<p><a href="../content/uploadfile/201508/65041439879089.png"><img alt="image023.png" src="../content/uploadfile/201508/thum-65041439879089.png" /></a></p>
<p>访问文章编辑页面可以看到这篇文章：</p>
<p><a href="../content/uploadfile/201508/db8f1439879092.png"><img alt="image025.png" src="../content/uploadfile/201508/thum-db8f1439879092.png" /></a> </p>
<h2 id="0x04-untrashsql"><a class="toclink" href="#0x04-untrashsql">0x04 untrash文章时造成的SQL注入漏洞</a></h2>
<p>那么，仅仅是一个这样的提权漏洞，实际上没有太大意义。Check-point第二篇文章里提到了一个因为这个提权漏洞导致的SQL注入。</p>
<p>先说这个注入的原理。</p>
<p>/wp-includes/post.php</p>
<p><a href="../content/uploadfile/201508/ae3c1439879141.png"><img alt="image027.png" src="../content/uploadfile/201508/thum-ae3c1439879141.png" /></a></p>
<p>如上图。Wordpress很多地方执行SQL语句使用的预编译，但仅限于直接接受用户输入的地方。而上图中明显是一个二次操作，先用get_post_meta函数从数据库中取出meta，之后以字符串拼接的方式插入SQL语句。</p>
<p>这个地方造成一个二次注入。</p>
<p>我们来看看第一次是如何入库的。首先wp_trash_post是将文章删除的方法，其中删除文章后又调用wp_trash_post_comments将文章下的评论也删除了：</p>
<p><a href="../content/uploadfile/201508/3ac41439879141.png"><img alt="image029.png" src="../content/uploadfile/201508/thum-3ac41439879141.png" /></a></p>
<p>跟进wp_trash_post_comments函数：</p>
<p><a href="../content/uploadfile/201508/7d891439879142.png"><img alt="image031.png" src="../content/uploadfile/201508/thum-7d891439879142.png" /></a> </p>
<p>如上图，可以看到这个“comment_approved”其实也是从数据库中取出来的。所以这个注入我称之为“三次注入”。</p>
<p>那么我再继续跟进，看看最早的comment_approved是从哪来的。</p>
<p>实际上看到图中的SQL语句就大概知道了，这个comment_approved是comments（评论）表的一个字段，我分别看了新增评论、修改评论两个函数，发现修改评论的函数（edit_comment）中，有涉及到这个字段：</p>
<p><a href="../content/uploadfile/201508/70a31439879625.png"><img alt="image033.png" src="../content/uploadfile/201508/thum-70a31439879625.png" /></a> </p>
<p>所以，这一连串操作最后造成的结果就是一个SQL注入漏洞。</p>
<p>总结一下123，整个利用过程如下：</p>
<p>利用快速草稿插入文章-&gt;越权编辑文章-&gt;插入评论-&gt;修改评论（恶意数据入库）-&gt;删除文章（恶意数据进入另一个库）-&gt;反删除文章（恶意数据被取出，直接插入SQL语句导致注入）</p>
<h2 id="0x05"><a class="toclink" href="#0x05">0x05 原文隐藏的部分与真实利用过程的研究</a></h2>
<p>这里不得不提到check-point的原文，原文的第二篇全文只字未提wordpress的token也就是_wpnonce，但wordpress后台几乎所有操作都需要特定的_wpnonce。在第一步中我们通过一处泄露点获取了“add-postajaxpost”的_wpnonce，但实际上后面的每一步（增加、编辑评论、trash文章、untrash文章）都需要不同的_wpnonce，那么这些_wpnonce我们怎么获得？</p>
<p>经过我的分析，最后实在找不到在订阅者权限下怎么获得“增加评论”和“反删除文章”的_wpnonce，而“修改评论”、“删除文章”的_wpnonce倒是可以在后台找到。</p>
<p>另外，虽然前台也可以增加评论，但前台增加评论会检查所属文章是否是草稿、状态是否是public或private，我们没法给这篇文章以及其派生的预览文章增加评论。</p>
<p>所以我把基础账号的权限提升一下，提升到可以发表文章与编辑文章的作者权限，再来对注入漏洞进行复现。</p>
<p><a href="../content/uploadfile/201508/b7721439879143.png"><img alt="image035.png" src="../content/uploadfile/201508/thum-b7721439879143.png" /></a></p>
<p>首先发表一篇文章，并在该文下回复一条评论：</p>
<p><a href="../content/uploadfile/201508/f1ab1439879144.png"><img alt="image037.png" src="../content/uploadfile/201508/thum-f1ab1439879144.png" /></a> </p>
<p>我们再来修改这条评论：</p>
<p><a href="../content/uploadfile/201508/e9f61439879144.png"><img alt="image039.png" src="../content/uploadfile/201508/thum-e9f61439879144.png" /></a> </p>
<p>在文章编辑页面找到trash的_wpnonce，将该评论所属的文章丢入垃圾箱：</p>
<p><a href="../content/uploadfile/201508/9f851439879145.png"><img alt="image041.png" src="../content/uploadfile/201508/thum-9f851439879145.png" /></a> </p>
<p><a href="../content/uploadfile/201508/e9441439879146.png"><img alt="image043.png" src="../content/uploadfile/201508/thum-e9441439879146.png" /></a></p>
<p>再找到反删除的_wpnonce，从垃圾箱里反删除这篇文章： </p>
<p><a href="../content/uploadfile/201508/e4411439879147.png"><img alt="image045.png" src="../content/uploadfile/201508/thum-e4411439879147.png" /></a> </p>
<p><a href="../content/uploadfile/201508/b8c51439879149.png"><img alt="image047.png" src="../content/uploadfile/201508/thum-b8c51439879149.png" /></a> </p>
<p>查看SQL执行记录，发现已经注入成功，引入单引号：</p>
<p><a href="../content/uploadfile/201508/c5a91439879150.png"><img alt="image049.png" src="../content/uploadfile/201508/thum-c5a91439879150.png" /></a></p>
<p>最后，我来总结一下这个漏洞。</p>
<p>这个漏洞有两个核心点，一是利用一个竞争条件逻辑错误，造成的一个越权漏洞；二是利用一个三次操作，导致最后的SQL注入漏洞。</p>
<p>这两个核心技术点都是很有代表性的，通篇学习下来，不得不佩服洞主的思路和对wordpress的研究深度。</p>
<p>但我也很遗憾，没能分析出在最低权限下怎样去注入，主要还是_wpnonce的获取导致漏洞利用上出现了一些问题。</p>
<p>另外，该SQL注入有一个不得不说的鸡肋点，在污染数据第一次入库的时候，数据库中保存这个数据的字段只有20字符长度，所以导致最后我们的注入点是一个“存在长度限制”的注入点，对于这个长度限制的利用，我也暂时没有相处更好的方法。</p>
<p>虽然存在长度限制，但因为注入点出现在update语句的评论表中，所以通过这个漏洞，可以将一整个站的评论全部置为0，对于像Freebuf这类社交性质的网站来说危害还是巨大的。</p>
<p>所以，我对这个SQL注入的评价是：利用上（可能）比较鸡肋，但思路是绝对一流的，值得学习。</p>
<h2 id="_1"><a class="toclink" href="#_1">参考链接</a></h2>
<p><a href="http://blog.checkpoint.com/2015/08/11/finding-vulnerabilities-in-core-wordpress-a-bug-hunters-trilogy-part-ii-supremacy/"><a href="http://blog.checkpoint.com/2015/08/11/finding-vulnerabilities-in-core-wordpress-a-bug-hunters-trilogy-part-ii-supremacy/">http://blog.checkpoint.com/2015/08/11/finding-vulnerabilities-in-core-wordpress-a-bug-hunters-trilogy-part-ii-supremacy/</a></a></p>
<p><a href="http://blog.checkpoint.com/2015/08/04/wordpress-vulnerabilities-1/"><a href="http://blog.checkpoint.com/2015/08/04/wordpress-vulnerabilities-1/">http://blog.checkpoint.com/2015/08/04/wordpress-vulnerabilities-1/</a></a></p>
            </div>
            <div itemprop="keywords" class="tags-meta">
                标签:
                
                    <a href="../tag/%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E.html">越权漏洞</a>
                
                    <a href="../tag/wordpress.html">wordpress</a>
                
                    <a href="../tag/%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html">注入漏洞</a>
                
            </div>
            <br>
<!--MOB SHARE BEGIN-->
<div class="-mob-share-ui-button -mob-share-open">分享</div>
<div class="-mob-share-ui" style="display: none">
    <ul class="-mob-share-list">
        <li class="-mob-share-weibo"><p>新浪微博</p></li>
        <li class="-mob-share-qzone"><p>QQ空间</p></li>
        <li class="-mob-share-qq"><p>QQ好友</p></li>
        <li class="-mob-share-weixin"><p>微信</p></li>
        <li class="-mob-share-douban"><p>豆瓣</p></li>
        <li class="-mob-share-facebook"><p>Facebook</p></li>
        <li class="-mob-share-twitter"><p>Twitter</p></li>
        <li class="-mob-share-pocket"><p>Pocket</p></li>
        <li class="-mob-share-google"><p>Google+</p></li>
        <li class="-mob-share-youdao"><p>有道云笔记</p></li>
        <li class="-mob-share-mingdao"><p>明道</p></li>
        <li class="-mob-share-tumblr"><p>Tumblr</p></li>
        <li class="-mob-share-instapaper"><p>Instapaper</p></li>
        <li class="-mob-share-linkedin"><p>LinkedIn</p></li>
    </ul>
    <div class="-mob-share-close">取消</div>
</div>
<div class="-mob-share-ui-bg"></div>
<script id="-mob-share" src="https://f1.webshare.mob.com/code/mob-share.js?appkey=af155d9007c8"></script>
<!--MOB SHARE END-->

        <div class="qqlist">
          <h3>订阅本站<small>(RSS)</small></h3>
          <form method="post" target="_blank" action="https://list.qq.com/cgi-bin/qf_compose_send">
          <input type="hidden" value="qf_booked_feedback" name="t" />
          <input type="hidden" value="dace5c2b356504de449e7f3fc2bb59f3f6124d6563786446" name="id" />
          <input type="text" placeholder="E-mail" value="" class="rsstxt" name="to" id="to" />
          <button type="submit" >订阅&rarr;</button>
          </form>
        </div>


        </div>

        
        <div class="post-single type-post text-center">
            <h3 style="margin-top: 0">喜欢这篇文章，扫码和我成为赞友！</h3>
            <img src="../static/wx.jpg" width="280" alt="">
        </div>
        

        <!-- 评论位置 -->
        <div id="comments" class="comments">
          <h3>已有 4 条评论</h3>
            <ol class="comment-list">
            
            
              <li class="comment-body" id="comment-3148">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/32aec855af00c965d1bb6fb661dc82f0.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="https://www.pangookj.com" target="_blank" rel="nofollow noopener">天津网站建设</a></div>
                    <p>又来啦哈哈，博主好</p>
                    <span class="comment-time">时间: 2018-09-26 17:17</span>
                    <span class="comment-reply"><a href="#comment-3148" onclick="reply_to('3148','天津网站建设')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2246">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">依旧路人甲</a></div>
                    <p>思路漂亮，BTW  P牛的个人分析也很赞！！</p>
                    <span class="comment-time">时间: 2015-11-02 13:29</span>
                    <span class="comment-reply"><a href="#comment-2246" onclick="reply_to('2246','依旧路人甲')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2197">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/52eb673b25924a1233bb9304a643fab1.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">badboy</a></div>
                    <p>膜拜。虽然懂PHP，但是挖不到这么深</p>
                    <span class="comment-time">时间: 2015-08-24 15:36</span>
                    <span class="comment-reply"><a href="#comment-2197" onclick="reply_to('2197','badboy')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-2195">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/525c5760293913bfc5cbabe28c4f62b8.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="http://www.wangshifu.net" target="_blank" rel="nofollow noopener">王师傅装修</a></div>
                    <p>赶紧回去升级去。</p>
                    <span class="comment-time">时间: 2015-08-23 18:47</span>
                    <span class="comment-reply"><a href="#comment-2195" onclick="reply_to('2195','王师傅装修')">回复</a></span>
                    </div>
                </div>
              </li>
            
            
            </ol>
            
        </div>

        <div id="reply"></div>
        <div id="comment-place">
            <div id="comment-post" class="respond none-resize">
             <div id="respond">
                <h3 id="response">添加新评论</h3>
                <form method="post" id="comment-form" role="form" action="#comments">
                    <p>
                        <label for="author" class="required">称呼</label>
                        <input type="text" name="nickname" placeholder="昵称" maxlength="64" required id="id_nickname">
                    </p>
                    <p>
                        <label for="mail">Email</label>
                        <input type="text" name="email" placeholder="邮箱（可留空）" maxlength="254" id="id_email">
                    </p>
                    <p>
                        <label for="url">网站</label>
                        <input type="text" name="url" placeholder="链接（可留空）" maxlength="200" id="id_url">
                    </p>
                    <p>
                        <label for="textarea" class="required">内容</label>
                        <textarea name="content" cols="40" rows="6" required id="id_content">
</textarea>
                    </p>
                    <p>
                        <label style="float:left;">验证码</label>
                        <div class="row gx-2" style="margin-top: 8px"><div class="col-6"><input autocomplete="off" id="id_captcha_1" name="captcha_1" type="text" placeholder="验证码" /> <input id="id_captcha_0" name="captcha_0" type="hidden" value="b2504bc701c0bd69b9fcca2768d543998e670581" />
</div><div class="col-6">
<img src="../captcha/image/b2504bc701c0bd69b9fcca2768d543998e670581/index.png" alt="captcha" class="captcha" /></div></div>
                    </p>
                    <p>
                        <button type="submit" class="submit">提交评论</button>
                        <input type="hidden" name="parent" id="id_parent">
                        <input type="hidden" name="archive" value="365" id="id_archive">
                        <input type="hidden" name="csrfmiddlewaretoken" value="S14G7R09MqAKrah1j1fU3dQHqhf6D6uqEzsxFWBSaMOtZI5pl2cF0GTMLEwhcIGI">
                    </p>
                </form>
                </div>
            </div>
        </div>

    </div>
    



<div  class="col-5 columns" id="sidebar" role="complementary">

  <div class="widget widget_search">
    <h3>搜索</h3>
    <form action="https://www.leavesongs.com/search/" id="searchform" method="get">
        <input type="text" id="searchkey" name="keyword" value="" class="searchkey" placeholder="Search..."/>
        <button type="submit"  id="searchsubmit">Go</button>
    </form>
  </div>

  
  <div class="widget">
	<h3 class="widget-title">最新评论</h3>
	<ul class="widget-list" id="recent-comment">
    
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>木木</cite>：<a href="../THINK/europe-trip-2022.html#comment-4523">虽然物价对比不出什么，但是还是觉得很高昂</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>dongdong4fei</cite>：<a href="../THINK/using-chatgpt-for-antispam.html#comment-4520">肯德基疯狂星期四！ 疯狂星期四！  https://m.kfc.com.cn/wechatco...</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>dongdong4fei</cite>：<a href="../THINK/using-chatgpt-for-antispam.html#comment-4519">小猪咪小猪咪小猪咪</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>sam</cite>：<a href="javascript-prototype-pollution-attack.html#comment-4518">还得是P神，文章一看就懂</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>程序</cite>：<a href="discuz72-sql-injection.html#comment-4517">很不错的文章</a></div>
        </li>
    
    </ul>
  </div>

  <div class="widget widget-category">
	<h3>分类</h3>
	<ul id="blogsort" class="widget-list">
    
    
    <li>
        <a href="../sort/PENETRATION.html">网络安全<em>143</em></a>
    </li>
    
    <li>
        <a href="../sort/C.html">C/C++<em>32</em></a>
    </li>
    
    <li>
        <a href="../sort/THINK.html">心得与体会<em>24</em></a>
    </li>
    
    <li>
        <a href="../sort/PYTHON.html">Python<em>19</em></a>
    </li>
    
    <li>
        <a href="../sort/SHARE.html">资源分享<em>16</em></a>
    </li>
    
    </ul>
  </div>

  <div class="widget widget-tag">
	<h3>随机标签</h3>
	<div class="tag-cloud">
        
        
        <a rel="tag" href="../tag/%E5%A4%A7%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86.html">大文件处理</a>
        
        <a rel="tag" href="../tag/%E5%9B%9E%E8%B0%83%E5%90%8E%E9%97%A8.html">回调后门</a>
        
        <a rel="tag" href="../tag/iOS.html">iOS</a>
        
        <a rel="tag" href="../tag/%E4%BD%8D%E8%BF%90%E7%AE%97.html">位运算</a>
        
        <a rel="tag" href="../tag/%E6%A1%A5%E6%8E%A5.html">桥接</a>
        
        <a rel="tag" href="../tag/writeup.html">writeup</a>
        
        <a rel="tag" href="../tag/IIS.html">IIS</a>
        
        <a rel="tag" href="../tag/WTForm.html">WTForm</a>
        
        <a rel="tag" href="../tag/apache.html">apache</a>
        
        <a rel="tag" href="../tag/web%E6%8C%87%E7%BA%B9.html">web指纹</a>
        
        <a rel="tag" href="../tag/%E6%B1%89%E8%AF%BA%E5%A1%94.html">汉诺塔</a>
        
        <a rel="tag" href="../tag/cmd%E5%90%8E%E9%97%A8.html">cmd后门</a>
        
        <a rel="tag" href="../tag/Linux.html">Linux</a>
        
        <a rel="tag" href="../tag/CSP.html">CSP</a>
        
        <a rel="tag" href="../tag/%E5%9B%A2%E9%98%9F.html">团队</a>
        
        <a rel="tag" href="../tag/phpwind.html">phpwind</a>
        
        <a rel="tag" href="../tag/%E6%80%BB%E7%BB%93.html">总结</a>
        
        <a rel="tag" href="../tag/%E9%81%8D%E5%8E%86%E7%9B%AE%E5%BD%95.html">遍历目录</a>
        
        <a rel="tag" href="../tag/C-FREE.html">C-FREE</a>
        
        <a rel="tag" href="../tag/var_dump.html">var_dump</a>
        
        <a rel="tag" href="../tag/disable_functions.html">disable_functions</a>
        
        <a rel="tag" href="../tag/%E6%8A%A5%E7%BA%B8.html">报纸</a>
        
        <a rel="tag" href="../tag/%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E.html">越权漏洞</a>
        
        <a rel="tag" href="../tag/web%E5%BA%94%E7%94%A8.html">web应用</a>
        
        <a rel="tag" href="../tag/360webscan.html">360webscan</a>
        
        <a rel="tag" href="../tag/asyncore.html">asyncore</a>
        
        <a rel="tag" href="../tag/%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87.html">沙盒绕过</a>
        
        <a rel="tag" href="../tag/fckeditor.html">fckeditor</a>
        
        <a rel="tag" href="../tag/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%80%9F%E5%BA%A6.html">数据库速度</a>
        
        <a rel="tag" href="../tag/kali.html">kali</a>
        
    </div>
  </div>

  <div class="widget widget-recent-entries">
	<h3 class="widget-title">热门日志</h3>
	<ul id="hotlog" class="widget-list">
    
    
        <li><a href="../other/tinger.html">About.Me</a></li>
    
        <li><a href="detect-django.html">如何判断目标站点是否为Django开发</a></li>
    
        <li><a href="webshell-without-alphanum-advanced.html">无字母数字webshell之提高篇</a></li>
    
        <li><a href="webshell-without-alphanum.html">一些不包含数字和字母的webshell</a></li>
    
        <li><a href="php-filter-magic.html">谈一谈php://filter的妙用</a></li>
    
    </ul>
  </div>
  

</div>
</div>

<div id="footer">
	<!-- copyright -->
	<div class="container">
		<div class="row remove-bottom">
			<div class="col-6 columns">
			<h3>Little About</h3>
			<p>Phithon 非强迫症小青年  <br>
现居先 <br>
爱好：种花、买书、收藏明信片 <br>
欢迎各大组织收留 <br>
E-mail：root@leavesongs.com </p>
			</div>

			<div class="col-10 columns">

				<h3 class="mobile-hide">Follow me</h3>
        <div id="social-links">
          <a href="http://weibo.com/101yx" class="sweibo" target="_blank" title="新浪微博">新浪微博</a>
          <a href="javascript:alert(/没有腾讯微博哟/)" class="qweibo" target="_blank" title="腾讯微博">腾讯微博</a>
          <a href="javascript:alert(/墙外有什么/);window.open('http://google.com')" class="google" target="_blank" title="墙外的世界">google+</a>
          <a href="https://github.com/phith0n" class="github" target="_blank" title="Github">github</a>
          <a href="javascript:confirm(/mailto:root#leavesongs.com/)" class="mail" target="_blank" title="私信给我">私信给我</a>
          <a href="../feed/index.rss" target="_blank" class="rss" title="离别歌">RSS订阅</a>
        </div>
        <div class="bot-line"></div>
				<p class="copyright">
	Copyright &copy; Powered by talkbook
				&nbsp;&nbsp;<i>Designed and built with all the love in the world by <a href="../index.html" target="_blank">Phithon</a> && deepsky </i>
                    <a href="../index.html">更换模板</a>
				</p>
			</div>
		</div>
	</div>
	<!-- /copyright -->
</div>
<a href="#" id="go-top">Top ↑</a>
<script src="https://cdn.staticfile.org/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/jquery.appear/0.4.1/jquery.appear.min.js"></script>
<script src="../static/deep/js/common_tpl.js" type="text/javascript"></script>
<script src="../static/deep/js/config.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FF5KPQ1CZ6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FF5KPQ1CZ6');
</script>

<script src="https://cdn.staticfile.org/fancybox/2.1.7/js/jquery.fancybox.min.js"></script>
<script>
$(document).ready(function () {
    $(".entry a").each(function (i, e) {
        if(e.host != 'www.leavesongs.com') {
            e.target = '_blank';
        }
    });
    $(".entry img").each(function (i, e) {
        if(e.parentNode.tagName.toUpperCase() != 'A') {
            $(e).wrap('<a href="'+escapeHtml(e.src)+'" class="fancybox"></a>');
        } else {
            $(e.parentNode).addClass('fancybox');
        }
    });
    $('.fancybox').fancybox();
})
</script>

</body>

</html>