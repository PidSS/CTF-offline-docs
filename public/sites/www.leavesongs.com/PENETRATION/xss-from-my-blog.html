
<!DOCTYPE html>
<html lang=en>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <meta name="description" content="phith0n的小站，长期存在与分享关于网络安全与各种编程的原创文章。">
  <meta name="keywords" content="phith0n,网络安全,代码审计,信息安全,漏洞挖掘,php,C++,mysql,python">
  <link rel="shortcut icon" href="../static/cactus/images/favicon.ico">
  <link rel="icon" type="image/png" href="../static/cactus/images/favicon-192x192.png" sizes="192x192">
  <link rel="apple-touch-icon" sizes="180x180" href="../static/cactus/images/apple-touch-icon.png">
  <link rel="alternate" type="application/atom+xml" href="../feed/index.rss" title="离别歌"/>

  <title>我自己博客的一个XSS的故事 | 离别歌</title>
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.staticfile.org/bootstrap/5.1.3/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="../static/cactus/css/style%EF%B9%96v=20220521.css">
  
  <link rel="stylesheet" href="../static/cactus/css/code%EF%B9%96v=20211026.css">
  <link href="https://cdn.staticfile.org/fancybox/2.1.7/css/jquery.fancybox.min.css" rel="stylesheet">

</head>
<body>



  <div class="sticky">
    <a href="#" id="menu-icon" class="menu-icon active"><i class="fa fa-bars fa-lg"></i></a>
    <div class="menu">
      <ul>
        <li><a href="../index.html">主页</a></li>
        <li><a href="javascript:history.back(-1)">返回</a></li>
      </ul>
      <br>
    </div>
    <div class="clearfix"></div>
    <div class="info" style="position: fixed">
      <span id="i-top" style="display: none">Back to top</span>
      <span id="i-share" style="display: none">Share post</span>
    </div>
    <ul class="actions">
      <li><a class="icon" href="#" id="back-top"><i
          class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();"
          onmouseout="$('#i-top').toggle();"></i></a></li>
      <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true"
                                      onmouseover="$('#i-share').toggle();"
                                      onmouseout="$('#i-share').toggle();"
                                      onclick="$('#share').toggleClass('hidden');return false;"></i></a></li>
    </ul>
    <div id="share" class="hidden">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3A//www.leavesongs.com/PENETRATION/xss-from-my-blog.html"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https%3A//www.leavesongs.com/PENETRATION/xss-from-my-blog.html&amp;text=%E6%88%91%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E7%9A%84%E4%B8%80%E4%B8%AAXSS%E7%9A%84%E6%95%85%E4%BA%8B"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3A//www.leavesongs.com/PENETRATION/xss-from-my-blog.html&amp;title=%E6%88%91%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E7%9A%84%E4%B8%80%E4%B8%AAXSS%E7%9A%84%E6%95%85%E4%BA%8B"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3A//www.leavesongs.com/PENETRATION/xss-from-my-blog.html&amp;is_video=false&amp;description=%E6%88%91%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E7%9A%84%E4%B8%80%E4%B8%AAXSS%E7%9A%84%E6%95%85%E4%BA%8B"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=%E6%88%91%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E7%9A%84%E4%B8%80%E4%B8%AAXSS%E7%9A%84%E6%95%85%E4%BA%8B&amp;body=Check out this article: https%3A//www.leavesongs.com/PENETRATION/xss-from-my-blog.html"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https%3A//www.leavesongs.com/PENETRATION/xss-from-my-blog.html&amp;title=%E6%88%91%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E7%9A%84%E4%B8%80%E4%B8%AAXSS%E7%9A%84%E6%95%85%E4%BA%8B"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https%3A//www.leavesongs.com/PENETRATION/xss-from-my-blog.html&amp;title=%E6%88%91%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E7%9A%84%E4%B8%80%E4%B8%AAXSS%E7%9A%84%E6%95%85%E4%BA%8B"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3A//www.leavesongs.com/PENETRATION/xss-from-my-blog.html&amp;title=%E6%88%91%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E7%9A%84%E4%B8%80%E4%B8%AAXSS%E7%9A%84%E6%95%85%E4%BA%8B"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https%3A//www.leavesongs.com/PENETRATION/xss-from-my-blog.html&amp;title=%E6%88%91%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E7%9A%84%E4%B8%80%E4%B8%AAXSS%E7%9A%84%E6%95%85%E4%BA%8B"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https%3A//www.leavesongs.com/PENETRATION/xss-from-my-blog.html&amp;name=%E6%88%91%E8%87%AA%E5%B7%B1%E5%8D%9A%E5%AE%A2%E7%9A%84%E4%B8%80%E4%B8%AAXSS%E7%9A%84%E6%95%85%E4%BA%8B&amp;description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>
    </div>
  </div>

  <div class="container-md">
    <div class="article row justify-content-center min-height">
      <div class="col-lg-8 col-md-10 col-sm-12">
        <article itemscope itemtype="http://schema.org/BlogPosting">
          <header class="post-header">
            <h1 class="color-main h1 mb-0" itemprop="name headline">我自己博客的一个XSS的故事</h1>
            <div class="meta">
              <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <span itemprop="name">phithon</span>
              </span>

              <div class="postdate">
                <time datetime="2022年6月19日 03:17" itemprop="datePublished">
                  2022 六月 19 03:17
                </time>
              </div>

              <div class="article-tag">
                阅读：48245
              </div>

              
                <div class="article-tag">
                  <i class="fa fa-bookmark"></i>
                  <a class="tag-link" href="../sort/PENETRATION.html">网络安全</a>
                </div>
              

              
                <div class="article-tag">
                  <i class="fa fa-tag"></i>
                  
                    <a class="tag-link" href="../tag/DOMXSS.html">DOMXSS</a>,
                  
                  
                    <a class="tag-link" href="../tag/xss.html">xss</a>
                  
                </div>
              
            </div>
          </header>
          <div class="content" itemprop="articleBody">
            <p>今天晚上收到几个提醒，打开一看是有人在我博客评论区测试XSS：</p>
<p><a href="../media/attachment/2022/06/19/15ef69f3-c60c-4b8e-9826-46690e54fafd.png"><img alt="image-20220619003454334-16555700950171.png" src="../media/attachment/2022/06/19/15ef69f3-c60c-4b8e-9826-46690e54fafd.4c15fcb8c7b9.png" /></a></p>
<p>本来这种测试司空见惯了，而且此人也没成功找到XSS，放以前我多半就关掉页面了。</p>
<p>不过我今晚不知为何临时起意，就顺势看了一下自己写的代码，居然被我自己找到一个XSS漏洞：</p>
<p><a href="../media/attachment/2022/06/19/ae138aa5-8acb-456f-9672-f823fed43700.png"><img alt="image-20220619003357418.png" src="../media/attachment/2022/06/19/ae138aa5-8acb-456f-9672-f823fed43700.a589111d5b2f.png" /></a></p>
<p>原因是什么呢？</p>
<h2 id="0x01"><a class="toclink" href="#0x01">0x01 开发历史介绍</a></h2>
<p>我当时在开发这个回复按钮的时候，为了方便，直接用JavaScript伪协议来调用<code>reply_to</code>函数，比如：</p>
<p><a href="../media/attachment/2022/06/19/dbba68a6-f9db-4464-9649-7f2d136ee48c.png"><img alt="image-20220619003805674.png" src="../media/attachment/2022/06/19/dbba68a6-f9db-4464-9649-7f2d136ee48c.a00ea07f4f19.png" /></a></p>
<p><code>reply_to</code>函数接受两个参数，一个是这条评论的id，第二个是这条评论的用户昵称。</p>
<p>当然，因为我的博客基于Django开发，所以默认在输出页面的时候会有HTML编码，这里不会直接逃逸出href属性的范围。</p>
<p>但其实如果只使用默认的HTML编码，在这个上下文中是不够的，会产生一个DOM型XSS，例如：</p>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;javascript:console.log(&#39;&amp;#x27;&amp;#x2b;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&amp;#x2b;&amp;#x27;&#39;)&quot;</span><span class="p">&gt;</span>click 1<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>

<p><a href="../media/attachment/2022/06/19/ddc2e568-0f2c-4c1a-b067-cdc984ab9274.png"><img alt="image-20220619005504956.png" src="../media/attachment/2022/06/19/ddc2e568-0f2c-4c1a-b067-cdc984ab9274.68ffa0dae9ea.png" /></a></p>
<p>原因是HTML在渲染属性的时候，会先解实体编码后才执行属性内部的JavaScript代码。所以，上面这个例子里实际执行的代码是：</p>
<div class="codehilite"><pre><span></span><code><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">+</span><span class="nx">alert</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

<p>逃逸出单引号执行了alert。</p>
<p>这是很经典的DOM型XSS，所以我在当时写代码的时候也考虑了这种情况。我的处理方式是使用Django中的一个模板filter叫<a href="https://docs.djangoproject.com/en/4.0/ref/templates/builtins/#escapejs" target="_blank"><code>escapejs</code></a>，它专用于转义JavaScript引号内的代码。我的处理逻辑如下：</p>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;javascript:reply_to(&#39;{{ object.pk }}&#39;, &#39;{{ object.nickname | escapejs }}&#39;)&quot;</span><span class="p">&gt;</span>回复<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>

<p>这样，用户的昵称中的特殊字符将会被转义成unicode编码，比如本文开头那个兄弟测试的评论，就无法触发XSS：</p>
<p><a href="../media/attachment/2022/06/19/8e0d4424-ac98-4f37-84c3-5587f8c033dd.png"><img alt="image-20220619010230312.png" src="../media/attachment/2022/06/19/8e0d4424-ac98-4f37-84c3-5587f8c033dd.28f5c3eb4789.png" /></a></p>
<p>看起来被转义的死死的，为什么我还是找到了XSS呢？</p>
<h2 id="0x02-urlxss"><a class="toclink" href="#0x02-urlxss">0x02 URL编码导致的XSS漏洞</a></h2>
<p>原因就出在JavaScript伪协议上，不管是JavaScript伪协议还是HTTP协议，他们在href属性里都是URL。既然是URL，那么肯定支持URL编码，这就是核心问题了：<strong>浏览器在渲染JavaScript伪协议地址的时候，会先进行URL解码，再执行JavaScript。</strong></p>
<p>那么这个问题其实就和前面说的HTML编码导致的DOM型XSS一样，如果我们输入用户的昵称是<code>%27%2Balert%281%29%2B%27</code>，会被解码成<code>'+alert(1)+'</code>再放进JavaScript里执行，那么实际执行的代码也是<code>console.log(''+alert(1)+'')</code>，造成一个DOM型XSS：</p>
<p><a href="../media/attachment/2022/06/19/8eac3cf8-67fc-44f4-9074-4883251ef369.png"><img alt="image-20220619011108045.png" src="../media/attachment/2022/06/19/8eac3cf8-67fc-44f4-9074-4883251ef369.69035450ed07.png" /></a></p>
<p>这其实也是一个很常见的知识，不过我当时在写代码的时候忽略了。另一个原因也在于<code>escapejs</code>，它实际上只转义了下面这些字符：</p>
<div class="codehilite"><pre><span></span><code><span class="n">_js_escapes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u005C&quot;</span><span class="p">,</span>
    <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u0027&quot;</span><span class="p">,</span>
    <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u0022&quot;</span><span class="p">,</span>
    <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u003E&quot;</span><span class="p">,</span>
    <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u003C&quot;</span><span class="p">,</span>
    <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u0026&quot;</span><span class="p">,</span>
    <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u003D&quot;</span><span class="p">,</span>
    <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u002D&quot;</span><span class="p">,</span>
    <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u003B&quot;</span><span class="p">,</span>
    <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;`&quot;</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u0060&quot;</span><span class="p">,</span>
    <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\u2028</span><span class="s2">&quot;</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u2028&quot;</span><span class="p">,</span>
    <span class="nb">ord</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\u2029</span><span class="s2">&quot;</span><span class="p">):</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">u2029&quot;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>

<p>其中不包含<code>%</code>，所以也间接导致了这个漏洞的产生。</p>
<p>当然，Django文档中也明确说明了他们不认为escapejs可以用于处理安全问题，而仅用于防止JavaScript语法出错：</p>
<blockquote>
<p><em>escapejs</em></p>
<p>Escapes characters for use in JavaScript strings. This does <em>not</em> make the string safe for use in HTML or JavaScript template literals, but does protect you from syntax errors when using templates to generate JavaScript/JSON.</p>
</blockquote>
<p>我也曾在<a href="https://t.zsxq.com/VRFMbU7" target="_blank">代码审计知识星球</a>里介绍过当时我发现的另一个容易导致开发者误用<code>escapejs</code>的问题，这就是另一个故事了，本文不细表。</p>
<p>那么，在无法修改<code>escapejs</code>转义的字符的情况下，如何修复这个漏洞呢？</p>
<h2 id="0x03"><a class="toclink" href="#0x03">0x03 漫谈漏洞修复</a></h2>
<p>说到修复漏洞，我想到这半年以来面试的时候总会问的一类问题，就是某某漏洞如何修复。</p>
<p>按理说Web漏洞的原理与修复方式应该属于非常基础的问题之一了，但很多候选人都没法正确回答。</p>
<p>比如在遇到命令注入修复一类问题的时候，大部分候选人会回答“过滤”、“拦截”特殊字符，或者只允许数字、字母、汉字等字符；那么如果业务开发就是需要使用特殊字符，又如何处理呢？很多人回答不上来。</p>
<p>当然我不反对白名单用户的输入，在不影响业务的情况下这是最保险也最安全的方式，但你至少需要知道更加wide的修复方法是什么，这一点反映出你是不是真的了解一个漏洞的原理。</p>
<p>比如今天遇到的这个问题，我们很容易想到的第一个修复方法就是在用户评论的时候拦截或过滤<code>%</code>字符。但是这样其实就影响了那些昵称包含<code>%</code>的用户，他们无法正常评论。</p>
<p>我们常常反对一刀切，但殊不知我们自己很多时候也在做一刀切的决定，毕竟一刀切最简单，不用承担风险。</p>
<p>对于该漏洞，我的修复方式是：</p>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;javascript:reply_to(&#39;{{ object.pk }}&#39;, &#39;{{ object.nickname | escapejs | urlencode }}&#39;)&quot;</span><span class="p">&gt;</span>回复<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</code></pre></div>

<p>因为浏览器在解析URL的时候会进行URL解码，那么用户的输入理应进行URL编码后再放进URL中。这就是我修复这个漏洞的方法，让用户的输入按照浏览器解析的顺序进行编码：<strong>先进行unicode编码再进行url编码</strong>。</p>
<p>因为这个写法也在<a href="https://github.com/phith0n/mooder" target="_blank">mooder</a>中使用，所以请使用mooder的同学升级下最新版本来防御XSS漏洞：<a href="https://github.com/phith0n/mooder/commit/611124d2f685281ef47570d41f976e194bed9d6f" target="_blank">https://github.com/phith0n/mooder/commit/611124d2f685281ef47570d41f976e194bed9d6f</a></p>
          </div>
        </article>

        
          <h1 class="h1 color-main">赞赏</h1>
          <div class="zan text-center">
            <p>喜欢这篇文章？打赏1元</p>
            <p class="m-0"><img src="../static/wx.jpg" width="280" alt=""></p>
          </div>
        

        <div id="reply-list">
          <h1 class="h1 color-main">评论</h1>
          
            
              <div class="flex mb-2" id="comment-4144">
                <div class="gravatar">
                  <img src="../static/placeholder.jpg" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">h3h3</a>
                    <time datetime="2023年3月21日 00:03" itemprop="datePublished">
                      2023 三月 21 00:03
                    </time>
                    <a href="javascript:reply_to('4144', 'h3h3')">回复</a>
                  </p>
                  <p class="comment-meta">膜一膜</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-4036">
                <div class="gravatar">
                  <img src="../static/placeholder.jpg" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">11&#x27;1</a>
                    <time datetime="2022年12月13日 13:19" itemprop="datePublished">
                      2022 十二月 13 13:19
                    </time>
                    <a href="javascript:reply_to('4036', '11%5Cu00271')">回复</a>
                  </p>
                  <p class="comment-meta">alert(&quot;P牛牛逼&quot;)</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-4030">
                <div class="gravatar">
                  <img src="../static/placeholder.jpg" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">ICQ</a>
                    <time datetime="2022年11月26日 16:55" itemprop="datePublished">
                      2022 十一月 26 16:55
                    </time>
                    <a href="javascript:reply_to('4030', 'ICQ')">回复</a>
                  </p>
                  <p class="comment-meta">i春秋到此一游</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-3980">
                <div class="gravatar">
                  <img src="https://secure.gravatar.com/avatar/f405d80940c9a7bf2f98c660eb4a0382.jpg?s=100&amp;d=mm&amp;r=g" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="https://qq.md" target="_blank" rel="nofollow noopener">叶开</a>
                    <time datetime="2022年10月29日 05:53" itemprop="datePublished">
                      2022 十月 29 05:53
                    </time>
                    <a href="javascript:reply_to('3980', '%E5%8F%B6%E5%BC%80')">回复</a>
                  </p>
                  <p class="comment-meta">学习了！</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-3962">
                <div class="gravatar">
                  <img src="https://secure.gravatar.com/avatar/658cf03c90c7eff8f470bfb663f1986f.jpg?s=100&amp;d=mm&amp;r=g" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">ixx</a>
                    <time datetime="2022年9月19日 17:58" itemprop="datePublished">
                      2022 九月 19 17:58
                    </time>
                    <a href="javascript:reply_to('3962', 'ixx')">回复</a>
                  </p>
                  <p class="comment-meta">666 发志狠来自己都黑</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-3958">
                <div class="gravatar">
                  <img src="../static/placeholder.jpg" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">&amp;#x27;&amp;#x2b;&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;&amp;#x2</a>
                    <time datetime="2022年9月13日 11:50" itemprop="datePublished">
                      2022 九月 13 11:50
                    </time>
                    <a href="javascript:reply_to('3958', '%5Cu0026%23x27%5Cu003B%5Cu0026%23x2b%5Cu003B%5Cu0026%23x61%5Cu003B%5Cu0026%23x6c%5Cu003B%5Cu0026%23x65%5Cu003B%5Cu0026%23x72%5Cu003B%5Cu0026%23x74%5Cu003B%5Cu0026%23x28%5Cu003B%5Cu0026%23x31%5Cu003B%5Cu0026%23x29%5Cu003B%5Cu0026%23x2')">回复</a>
                  </p>
                  <p class="comment-meta">1</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-3948">
                <div class="gravatar">
                  <img src="../static/placeholder.jpg" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">nok</a>
                    <time datetime="2022年8月24日 00:30" itemprop="datePublished">
                      2022 八月 24 00:30
                    </time>
                    <a href="javascript:reply_to('3948', 'nok')">回复</a>
                  </p>
                  <p class="comment-meta">你的这个是怎么实现的？<br>我为什么打不出来<br><br>## 0x01 XXX<br><br>## 0x02 XXX</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-3945">
                <div class="gravatar">
                  <img src="../static/placeholder.jpg" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">0x27+alert(1)+0x27</a>
                    <time datetime="2022年8月17日 17:38" itemprop="datePublished">
                      2022 八月 17 17:38
                    </time>
                    <a href="javascript:reply_to('3945', '0x27%2Balert%281%29%2B0x27')">回复</a>
                  </p>
                  <p class="comment-meta">0x27+alert(1)+0x27</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-3944">
                <div class="gravatar">
                  <img src="../static/placeholder.jpg" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">0x27+alert(1)+0x27</a>
                    <time datetime="2022年8月17日 17:37" itemprop="datePublished">
                      2022 八月 17 17:37
                    </time>
                    <a href="javascript:reply_to('3944', '0x27%2Balert%281%29%2B0x27')">回复</a>
                  </p>
                  <p class="comment-meta">1</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-3943">
                <div class="gravatar">
                  <img src="https://secure.gravatar.com/avatar/da2b85d0a0c226be1765b829fe48dda6.jpg?s=100&amp;d=mm&amp;r=g" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">kira</a>
                    <time datetime="2022年8月17日 10:44" itemprop="datePublished">
                      2022 八月 17 10:44
                    </time>
                    <a href="javascript:reply_to('3943', 'kira')">回复</a>
                  </p>
                  <p class="comment-meta">学习了</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-3940">
                <div class="gravatar">
                  <img src="../static/placeholder.jpg" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">%27%2Balert%281%29%2B%27</a>
                    <time datetime="2022年8月11日 17:22" itemprop="datePublished">
                      2022 八月 11 17:22
                    </time>
                    <a href="javascript:reply_to('3940', '%2527%252Balert%25281%2529%252B%2527')">回复</a>
                  </p>
                  <p class="comment-meta">%27%2Balert%281%29%2B%27</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-3939">
                <div class="gravatar">
                  <img src="../static/placeholder.jpg" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">P神牛逼</a>
                    <time datetime="2022年8月11日 10:55" itemprop="datePublished">
                      2022 八月 11 10:55
                    </time>
                    <a href="javascript:reply_to('3939', 'P%E7%A5%9E%E7%89%9B%E9%80%BC')">回复</a>
                  </p>
                  <p class="comment-meta">alert(&quot;P神牛逼&quot;)</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-3936">
                <div class="gravatar">
                  <img src="../static/placeholder.jpg" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">\</a>
                    <time datetime="2022年8月7日 17:14" itemprop="datePublished">
                      2022 八月 07 17:14
                    </time>
                    <a href="javascript:reply_to('3936', '%5Cu005C')">回复</a>
                  </p>
                  <p class="comment-meta">test</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-3930">
                <div class="gravatar">
                  <img src="../static/placeholder.jpg" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">@@</a>
                    <time datetime="2022年7月28日 14:55" itemprop="datePublished">
                      2022 七月 28 14:55
                    </time>
                    <a href="javascript:reply_to('3930', '%40%40')">回复</a>
                  </p>
                  <p class="comment-meta">&quot;\x4E\&quot;\x42&quot;</p>
                </div>
              </div>
              
            
              <div class="flex mb-2" id="comment-3919">
                <div class="gravatar">
                  <img src="../static/placeholder.jpg" width="40px" height="40px" alt="">
                </div>
                <div class="ps-2">
                  <p class="comment-meta title">
                    <a href="" target="_blank" rel="nofollow noopener">111</a>
                    <time datetime="2022年7月21日 12:44" itemprop="datePublished">
                      2022 七月 21 12:44
                    </time>
                    <a href="javascript:reply_to('3919', '111')">回复</a>
                  </p>
                  <p class="comment-meta">alert(&quot;P神牛逼&quot;)</p>
                </div>
              </div>
              
            
          
        </div>

        
          

<nav role="navigation">
  <ul class="cd-pagination">
    
      <li class="button"><a href="javascript:;"></a></li>
    
    
      
        <li><a class="current"
               href="xss-from-my-blog%EF%B9%96page=1.html#reply-list">1</a></li>
      
    
      
        <li><a 
               href="xss-from-my-blog%EF%B9%96page=2.html#reply-list">2</a></li>
      
    
      
        <li><a 
               href="xss-from-my-blog%EF%B9%96page=3.html#reply-list">3</a></li>
      
    
    
      <li class="button"><a href="xss-from-my-blog%EF%B9%96page=2.html#reply-list"></a></li>
    
  </ul>
</nav>
        

        <form method="post" enctype="multipart/form-data" action="#reply" id="reply" class="mb-4">
          <div class="container-fluid px-0">
            
            <div class="row">
              <div class="col">
                <textarea name="content" cols="40" rows="6" required id="id_content">
</textarea>
              </div>
            </div>
            <div class="row gx-2">
              <div class="col-4">
                <input type="text" name="nickname" placeholder="昵称" maxlength="64" required id="id_nickname">
              </div>
              <div class="col-4">
                <input type="text" name="email" placeholder="邮箱（可留空）" maxlength="254" id="id_email">
              </div>
              <div class="col-4">
                <input type="text" name="url" placeholder="链接（可留空）" maxlength="200" id="id_url">
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-4">
              <div class="row gx-2" style="margin-top: 8px"><div class="col-6"><input autocomplete="off" id="id_captcha_1" name="captcha_1" type="text" placeholder="验证码" /> <input id="id_captcha_0" name="captcha_0" type="hidden" value="d885a7de3f7943799924a4e47cdc1e8434a9e06b" />
</div><div class="col-6">
<img src="../captcha/image/d885a7de3f7943799924a4e47cdc1e8434a9e06b/index.png" alt="captcha" class="captcha" /></div></div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <input type="submit" class="ui-button ui-button-sgreen" value="提交">
            </div>
          </div>
          <input type="hidden" name="archive" value="482" id="id_archive">
          <input type="hidden" name="parent" id="id_parent">
          <input type="hidden" name="csrfmiddlewaretoken" value="qmvgSxYTCFL5pa00Uy5LmyqPls0SJnNOcUT7qCzC01ZOXIOoWz2wj1tUGPh3iZZ6">
        </form>
      </div>
    </div>
    <div class="row justify-content-center">
      <div class="col-lg-7 col-md-10 col-sm-12">
        <footer class="footer mx-auto">
  <div class="footer-left">
    Copyright &copy; 2023 Powered by talkbook
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <li><a href="../index.html">首页</a></li>
        <li><a href="../feed/index.rss" target="_blank">RSS订阅</a></li>
        <li><a href="http://weibo.com/101yx" target="_blank">微博</a></li>
        <li><a href="https://github.com/phith0n" target="_blank">项目</a></li>
        <li><a href="../index.html">更换模板</a></li>
      </ul>
    </nav>
  </div>
</footer>
      </div>
    </div>
  </div>

<script src="https://cdn.staticfile.org/jquery/2.2.4/jquery.min.js"></script>
<script src="../static/cactus/js/main%EF%B9%96v=2021102502.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FF5KPQ1CZ6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FF5KPQ1CZ6');
</script>

  <script src="https://cdn.staticfile.org/fancybox/2.1.7/js/jquery.fancybox.min.js"></script>
  <script>
      $(document).ready(function () {
          $(".content a").each(function (i, e) {
              if (e.host != 'www.leavesongs.com') {
                  e.target = '_blank';
              }
          });
          $(".content img").each(function (i, e) {
              if (e.parentNode.tagName.toUpperCase() != 'A') {
                  $(e).wrap('<a href="' + escapeHtml(e.src) + '" class="fancybox"></a>');
              } else {
                  $(e.parentNode).addClass('fancybox');
              }
          });
          $('.fancybox').fancybox();
      })
  </script>

</body>
</html>