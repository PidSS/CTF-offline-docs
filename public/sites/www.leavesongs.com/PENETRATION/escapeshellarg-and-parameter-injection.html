

<html class="no-js">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="keywords" content="" />
    <meta name="description" content="phith0n的小站，长期存在与分享关于网络安全与各种编程的原创文章。" />
    <title>谈escapeshellarg绕过与参数注入漏洞 | 离别歌</title>
    <link rel="alternate" type="application/atom+xml" href="../feed/index.rss" title="离别歌" />
    <link href="../static/deep/css/base.css" rel="stylesheet" type="text/css" />
    <link href="../static/deep/css/style.css" rel="stylesheet" type="text/css" />
    <link rel="shortcut icon" href="../static/deep/images/favicon.ico" />
    
<style>div.row .col-xs-4 {
  float: left;
  margin-left: 4px;
}
div.row .col-xs-4 img {
  margin-left: 5px;
}
</style>
<link href="https://cdn.staticfile.org/fancybox/2.1.7/css/jquery.fancybox.min.css" rel="stylesheet">
<link rel="stylesheet" href="../static/deep/css/code.css">

</head>
<body>
<!--[if lt IE 8]>
    <div class="browsehappy" role="dialog">当前网页 <strong>不支持</strong> 你正在使用的浏览器. 为了正常的访问, 请 <a href="http://browsehappy.com/">升级你的浏览器</a>.</div>
<![endif]-->
<div id="header">
    <div class="container">
        <h1 class="h1-title">
            <a href="../index.html">
               <img src="../static/deep/images/logo.png" alt="离别歌" />
            </a>
        </h1>
        <div id="nav">
        <input type="checkbox" id="button">
        <label for="button" onclick>菜单</label>
        
        <ul>
            
            <li class="item ">
                <a href="../index.html" >首页</a>
            </li>
            
            <li class="item ">
                <a href="../list/index.html" >文章</a>
            </li>
            
            <li class="item ">
                <a href="../other/tinger.html" >关于</a>
            </li>
            
            <li class="item ">
                <a href="../other/friends-link.html" >友链</a>
            </li>
            
            <li class="item ">
                <a href="https://github.com/phith0n" target="_blank" >项目</a>
            </li>
            
            <li class="item ">
                <a href="https://www.leavesongs.com/PENETRATION/code-auditor-secret-group.html" target="_blank" >代码审计</a>
            </li>
            
        </ul>
        
        </div>
    </div>
</div>

<div class="banner-bar">
    <div class="container">
        <div class="col-12 columns">
            <div class="place">
                <a href="../index.html">首页</a>
                &raquo;
                
                网络安全 &raquo; <a href="escapeshellarg-and-parameter-injection.html">谈escapeshellarg绕过与参数注入漏洞</a>
                
            </div>
        </div>
    </div>
</div>
<div class="container">
    <div class="col-11 columns" id="mainbody" role="main">
        <div class="post-single type-post">
            <h1 class="article-h1">谈escapeshellarg绕过与参数注入漏洞</h1>
            <div class="details-up">
  <span class="author">作者: phithon</span>
  
  <span class="category">分类: <a href="../sort/PENETRATION.html">网络安全</a></span>
  
  <span class="date">时间: 2018-4-29 20:07</span>
  <span class="comments-top" itemprop="interactionCount">评论：<a itemprop="discussionUrl" href="#reply-list">10条评论</a></span>
  <span class="comments-top" itemprop="interactionCount">浏览：<a itemprop="discussionUrl" href="escapeshellarg-and-parameter-injection.html">66574人看过</a></span>
  
  <span class="date">标签:
    
        <a href="../tag/%E5%8F%82%E6%95%B0%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html">参数注入漏洞</a>
    
        <a href="../tag/escapeshellarg.html">escapeshellarg</a>
    
        <a href="../tag/gitlist.html">gitlist</a>
    
  </span>
  
</div>
            <div class="entry">
                <p>参数注入漏洞是指，在执行命令的时候，用户控制了命令中的某个参数，并通过一些危险的参数功能，达成攻击的目的。</p>
<h2 id="0x01-gitlist-060"><a class="toclink" href="#0x01-gitlist-060">0x01 从gitlist 0.6.0远程命令执行漏洞说起</a></h2>
<p>我们从gitlist说起，gitlist是一款使用PHP开发的图形化git仓库查看工具。在其0.6.0版本中，存在一处命令参数注入问题，可以导致远程命令执行漏洞。</p>
<p>在用户对仓库中代码进行搜索的时候，gitlist将调用<code>git grep</code>命令：</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">searchTree</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$branch</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$query</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$query</span> <span class="o">=</span> <span class="nb">escapeshellarg</span><span class="p">(</span><span class="nv">$query</span><span class="p">);</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="nv">$results</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getClient</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="s2">&quot;grep -i --line-number </span><span class="si">{</span><span class="nv">$query</span><span class="si">}</span><span class="s2"> </span><span class="si">$branch</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">\RuntimeException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
</pre></div>


<p>其中，<code>$query</code>是搜索的关键字，<code>$branch</code>是搜索的分支。</p>
<p>如果用户输入的<code>$query</code>的值是<code>--open-files-in-pager=id;</code>，将可以执行<code>id</code>命令：</p>
<p><a href="../media/attachment/2018/04/29/dd89dc70-2446-48e1-a728-5693d1fa868a.png"><img alt="1.png" src="../media/attachment/2018/04/29/dd89dc70-2446-48e1-a728-5693d1fa868a.bbb0aaacef7d.png" /></a></p>
<h2 id="0x02-escapeshellarg"><a class="toclink" href="#0x02-escapeshellarg">0x02 escapeshellarg为什么没有奏效？</a></h2>
<p>导致这个漏洞的原因，有几点：</p>
<ol>
<li>开发者对于<code>escapeshellarg</code>函数的误解，造成参数注入</li>
<li><code>git grep</code>的参数<code>--open-files-in-pager</code>的值，将被直接执行</li>
</ol>
<p>理论上，在经过<code>$query = escapeshellarg($query);</code>处理后，<code>$query</code>将变成一个由单引号包裹的字符串。但不出漏洞的前提是，这个字符串应该出现在“参数值”的位置，而不是出现在参数选项（option）中。</p>
<p>我们可以试一下如下命令：</p>
<div class="codehilite"><pre><span></span>git grep -i --line-number -e &#39;--open-files-in-pager=id;&#39; master
</pre></div>


<p><a href="../media/attachment/2018/04/29/840cca46-5780-4713-bf2a-319f296368b7.png"><img alt="2.png" src="../media/attachment/2018/04/29/840cca46-5780-4713-bf2a-319f296368b7.8f8883e407b5.png" /></a></p>
<p>如上图，我将<code>$query</code>放在了<code>-e</code>参数的值的位置，此时它就仅仅是一个字符串而已，并不会被当成参数<code>--open-files-in-pager</code>。</p>
<p>这应该作为本漏洞的最佳修复方法，也是git官方对pattern可能是用户输入的情况的一种解决方案（以下说明来自man-page）：</p>
<blockquote>
<p>-e <br />
The next parameter is the pattern. This option has to be used for patterns starting with - and should be used in scripts passing user input to grep. Multiple patterns are combined by<br />
or.</p>
</blockquote>
<p>当然，gitlist的开发者用了另一种修复方案：</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">searchTree</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="nv">$branch</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$query</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">null</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$query</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;/(--?[A-Za-z0-9\-]+)/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>
    <span class="nv">$query</span> <span class="o">=</span> <span class="nb">escapeshellarg</span><span class="p">(</span><span class="nv">$query</span><span class="p">);</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="nv">$results</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getClient</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">(</span><span class="nv">$this</span><span class="p">,</span> <span class="s2">&quot;grep -i --line-number -- </span><span class="si">{</span><span class="nv">$query</span><span class="si">}</span><span class="s2"> </span><span class="si">$branch</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">\RuntimeException</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>
    <span class="p">}</span>
</pre></div>


<p>首先用<code>preg_replace</code>将<code>-</code>开头的非法字符移除，然后将<code>$query</code>拼接在<code>--</code>的后面。</p>
<p>在命令行解析器中，<code>--</code>的意思是，此后的部分不会再包含参数选项（option）：</p>
<blockquote>
<p>A -- signals the end of options and disables further option processing. Any arguments after the -- are treated as filenames and arguments. An argument of - is equivalent to --.</p>
<p>If arguments remain after option processing, and neither the -c nor the -s option has been supplied, the first argument is assumed to be the name of a file containing shell commands. If bash is invoked in this fashion, $0 is set to the name of the file, and the positional parameters are set to the remaining arguments. Bash reads and executes commands from this file, then exits. Bash's exit status is the exit status of the last command executed in the script. If no commands are executed, the exit status is 0. An attempt is first made to open the file in the current directory, and, if no file is found, then the shell searches the directories in PATH for the script.</p>
</blockquote>
<p>举个简单的例子，如果我们需要查看一个文件名是<code>--name</code>的文件，我们就不能用<code>cat --name</code>来读取，也不能用<code>cat '--name'</code>，而必须要用<code>cat -- --name</code>。从这个例子也能看出，单引号并不是区分一个字符串是“参数值”或“选项”的标准。</p>
<p><a href="../media/attachment/2018/04/29/d70ec825-c4fc-4874-88b7-d4c8bbebfd70.png"><img alt="3.png" src="../media/attachment/2018/04/29/d70ec825-c4fc-4874-88b7-d4c8bbebfd70.e5e87fc9feff.png" /></a></p>
<p>所以官方这个修复方案也是可以接受的，只不过第一步的<code>preg_replace</code>有点影响正常搜索功能。</p>
<h2 id="0x03-php"><a class="toclink" href="#0x03-php">0x03 这不是PHP的专利</a></h2>
<p>熟悉PHP语言的同学一定对PHP执行命令的方法感受深刻，PHP内置的命令执行函数（如<code>shell_exec</code>、<code>system</code>），都只接受一个“字符串”作为参数。而在内核中，这个字符串将被直接作为一条shell命令来调用，这种情况下就极为容易出现命令注入漏洞。</p>
<p>由于这个特点，PHP特别准备了两个过滤函数：</p>
<ul>
<li>escapeshellcmd</li>
<li>escapeshellarg</li>
</ul>
<p>二者分工不同，前者为了防止用户利用shell的一些技巧（如分号、反引号等），执行其他命令；后者是为了防止用户的输入逃逸出“参数值”的位置，变成一个“参数选项”。</p>
<p>但我在0x02中也已经说清楚了，如果开发者在拼接命令的时候，将<code>$query</code>直接给拼接在“参数选项”的位置上，那用escapeshellarg也就没任何效果了。</p>
<p>Java、Python等语言，执行命令的方法相对来说更加优雅：</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">subprocess</span>

<span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;id&#39;</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;git&#39;</span><span class="p">,</span> <span class="s1">&#39;grep&#39;</span><span class="p">,</span> <span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="s1">&#39;--line-number&#39;</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="s1">&#39;master&#39;</span><span class="p">],</span> <span class="n">cwd</span><span class="o">=</span><span class="s1">&#39;/tmp/vulhub&#39;</span><span class="p">)</span>
</pre></div>


<p>默认情况下，python的subprocess接受的是一个列表。我们可以将用户输入的query放在列表的一项，这样也就避免了开发者手工转义query的工作，也能从根本上防御命令注入漏洞。但可惜的是，python帮开发者做的操作，也仅仅相当于是PHP中的escapeshellarg。我们可以试试令query等于<code>--open-files-in-pager=id;</code>：</p>
<p><a href="../media/attachment/2018/04/29/8296bbd4-40cd-481e-9147-6f11e80967d8.png"><img alt="e6169951-5f65-4535-9bd9-55cf694de9c5.png" src="../media/attachment/2018/04/29/8296bbd4-40cd-481e-9147-6f11e80967d8.6b4cdb17a1b8.png" /></a></p>
<p>可见，仍然是存在参数注入漏洞的。原因还是0x02中说的原因，你把query放在了“参数选项”的位置上，无论怎么过滤，或者换成其他语言，都不可能解决问题。</p>
<h2 id="0x04"><a class="toclink" href="#0x04">0x04 举一反三</a></h2>
<p>参数注入的例子还比较多，因为大部分的开发者都能理解命令注入的原理，但处理了命令注入后，往往都会忽略参数注入的问题。</p>
<p>最典型是案例是<a href="https://github.com/vulhub/vulhub/blob/master/wordpress/pwnscriptum/README.md">Wordpress PwnScriptum漏洞</a>，PHP mail函数的第五个参数，允许直接注入参数，用户通过注入<code>-X</code>参数，导致写入任意文件，最终getshell。</p>
<p>另一个典型的例子是<a href="https://github.com/vulhub/vulhub/tree/master/php/CVE-2012-1823">php-cgi CVE-2012-1823</a> ，在cgi模式中，用户传入的querystring将作为cgi的参数传给php-cgi命令。而php-cgi命令可以用-d参数指定配置项，我们通过指定<code>auto_prepend_file=php://input</code>，最终导致任意代码执行。</p>
<p>客户端上也出现过类似的漏洞，比如<a href="https://github.com/vulhub/vulhub/tree/master/electron/CVE-2018-1000006">Electron CVE-2018-1000006</a>，我们通过注入参数<code>--gpu-launcher=cmd.exe /c start calc</code>，来让electron内置的chromium执行任意命令。electron的最早给出的缓解措施也是在拼接点前面加上“--”。</p>
            </div>
            <div itemprop="keywords" class="tags-meta">
                标签:
                
                    <a href="../tag/%E5%8F%82%E6%95%B0%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html">参数注入漏洞</a>
                
                    <a href="../tag/escapeshellarg.html">escapeshellarg</a>
                
                    <a href="../tag/gitlist.html">gitlist</a>
                
            </div>
            <br>
<!--MOB SHARE BEGIN-->
<div class="-mob-share-ui-button -mob-share-open">分享</div>
<div class="-mob-share-ui" style="display: none">
    <ul class="-mob-share-list">
        <li class="-mob-share-weibo"><p>新浪微博</p></li>
        <li class="-mob-share-qzone"><p>QQ空间</p></li>
        <li class="-mob-share-qq"><p>QQ好友</p></li>
        <li class="-mob-share-weixin"><p>微信</p></li>
        <li class="-mob-share-douban"><p>豆瓣</p></li>
        <li class="-mob-share-facebook"><p>Facebook</p></li>
        <li class="-mob-share-twitter"><p>Twitter</p></li>
        <li class="-mob-share-pocket"><p>Pocket</p></li>
        <li class="-mob-share-google"><p>Google+</p></li>
        <li class="-mob-share-youdao"><p>有道云笔记</p></li>
        <li class="-mob-share-mingdao"><p>明道</p></li>
        <li class="-mob-share-tumblr"><p>Tumblr</p></li>
        <li class="-mob-share-instapaper"><p>Instapaper</p></li>
        <li class="-mob-share-linkedin"><p>LinkedIn</p></li>
    </ul>
    <div class="-mob-share-close">取消</div>
</div>
<div class="-mob-share-ui-bg"></div>
<script id="-mob-share" src="https://f1.webshare.mob.com/code/mob-share.js?appkey=af155d9007c8"></script>
<!--MOB SHARE END-->

        <div class="qqlist">
          <h3>订阅本站<small>(RSS)</small></h3>
          <form method="post" target="_blank" action="https://list.qq.com/cgi-bin/qf_compose_send">
          <input type="hidden" value="qf_booked_feedback" name="t" />
          <input type="hidden" value="dace5c2b356504de449e7f3fc2bb59f3f6124d6563786446" name="id" />
          <input type="text" placeholder="E-mail" value="" class="rsstxt" name="to" id="to" />
          <button type="submit" >订阅&rarr;</button>
          </form>
        </div>


        </div>

        
        <div class="post-single type-post text-center">
            <h3 style="margin-top: 0">喜欢这篇文章，扫码和我成为赞友！</h3>
            <img src="../static/wx.jpg" width="280" alt="">
        </div>
        

        <!-- 评论位置 -->
        <div id="comments" class="comments">
          <h3>已有 10 条评论</h3>
            <ol class="comment-list">
            
            
              <li class="comment-body" id="comment-3305">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">windy</a></div>
                    <p>请问是怎么进入root@ ... in ~/vulhub on git ...这个目录还是状态啥的，也就是怎么切换到执行git grep那个命令的</p>
                    <span class="comment-time">时间: 2019-03-17 17:23</span>
                    <span class="comment-reply"><a href="#comment-3305" onclick="reply_to('3305','windy')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3142">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/fd1b064e33110c3b4df8300d6c9f3876.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="https://www.pangookj.com" target="_blank" rel="nofollow noopener">天津网站建设</a></div>
                    <p>感谢博主分享，PHP有什么优势吗？</p>
                    <span class="comment-time">时间: 2018-09-11 15:51</span>
                    <span class="comment-reply"><a href="#comment-3142" onclick="reply_to('3142','天津网站建设')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3090">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">Ph0rse</a></div>
                    <p>同样好奇“shell_exec(escapeshellcmd(‘ls ’.escapeshellarg($_GET[c])));”这个怎么利用的</p>
                    <span class="comment-time">时间: 2018-06-23 01:09</span>
                    <span class="comment-reply"><a href="#comment-3090" onclick="reply_to('3090','Ph0rse')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3093">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/c4267eb6d17276fa31c547ac71611e90.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="../index.html" target="_blank" rel="nofollow noopener">phithon</a></div>
                    <p>@Ph0rse 这里是执行不了命令的。</p>
                    <span class="comment-time">时间: 2018-06-25 12:01</span>
                    <span class="comment-reply"><a href="#comment-3093" onclick="reply_to('3093','phithon')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3068">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="https://secure.gravatar.com/avatar/161d4db27bb51f07f934a082ba8ee274.jpg?s=100&amp;d=mm&amp;r=g">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="https://GitHub.com/wangyihang" target="_blank" rel="nofollow noopener">王一航</a></div>
                    <p>感谢ph师傅的分析，之前看过一个文章举了一个例子：<br>shell_exec(escapeshellcmd(‘ls ’.escapeshellarg($_GET[c])));<br>感觉这种代码段应该也挺常见的，乍一看确实没啥毛病...</p>
                    <span class="comment-time">时间: 2018-05-02 21:15</span>
                    <span class="comment-reply"><a href="#comment-3068" onclick="reply_to('3068','王一航')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3069">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">nobody</a></div>
                    <p>@王一航 想问下这个要怎么注入...</p>
                    <span class="comment-time">时间: 2018-05-03 22:25</span>
                    <span class="comment-reply"><a href="#comment-3069" onclick="reply_to('3069','nobody')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3077">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">sch0lar</a></div>
                    <p>@nobody 输入值为--open-files-in-pager=id;就可以执行id吧，不知道理解的对不对</p>
                    <span class="comment-time">时间: 2018-05-10 12:21</span>
                    <span class="comment-reply"><a href="#comment-3077" onclick="reply_to('3077','sch0lar')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3078">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">sch0lar</a></div>
                    <p>@nobody 刚去验证了一下，发现不对，发现没法利用呀，有大佬能讲一下利用的方法吗</p>
                    <span class="comment-time">时间: 2018-05-10 12:51</span>
                    <span class="comment-reply"><a href="#comment-3078" onclick="reply_to('3078','sch0lar')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3199">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">maple</a></div>
                    <p>@sch0lar git grep 参数 --open-files-in-pager 后面的参数会立即执行</p>
                    <span class="comment-time">时间: 2018-10-30 18:27</span>
                    <span class="comment-reply"><a href="#comment-3199" onclick="reply_to('3199','maple')">回复</a></span>
                    </div>
                </div>
              </li>
            
              <li class="comment-body" id="comment-3504">
                <div class="clearfix">
                    <div class="comment-author">
                        <img src="../static/placeholder.jpg">
                    </div>
                    <div class="comment-meta">
                    <div class="fn"><a href="" target="_blank" rel="nofollow noopener">longtao</a></div>
                    <p>@王一航 前提是这个命令里的参数有执行命令的功能</p>
                    <span class="comment-time">时间: 2020-04-19 11:11</span>
                    <span class="comment-reply"><a href="#comment-3504" onclick="reply_to('3504','longtao')">回复</a></span>
                    </div>
                </div>
              </li>
            
            
            </ol>
            
        </div>

        <div id="reply"></div>
        <div id="comment-place">
            <div id="comment-post" class="respond none-resize">
             <div id="respond">
                <h3 id="response">添加新评论</h3>
                <form method="post" id="comment-form" role="form" action="#comments">
                    <p>
                        <label for="author" class="required">称呼</label>
                        <input type="text" name="nickname" placeholder="昵称" maxlength="64" required id="id_nickname">
                    </p>
                    <p>
                        <label for="mail">Email</label>
                        <input type="text" name="email" placeholder="邮箱（可留空）" maxlength="254" id="id_email">
                    </p>
                    <p>
                        <label for="url">网站</label>
                        <input type="text" name="url" placeholder="链接（可留空）" maxlength="200" id="id_url">
                    </p>
                    <p>
                        <label for="textarea" class="required">内容</label>
                        <textarea name="content" cols="40" rows="6" required id="id_content">
</textarea>
                    </p>
                    <p>
                        <label style="float:left;">验证码</label>
                        <div class="row gx-2" style="margin-top: 8px"><div class="col-6"><input autocomplete="off" id="id_captcha_1" name="captcha_1" type="text" placeholder="验证码" /> <input id="id_captcha_0" name="captcha_0" type="hidden" value="1f510ab509a19f49749babede8e2657048097bb6" />
</div><div class="col-6">
<img src="../captcha/image/1f510ab509a19f49749babede8e2657048097bb6/index.png" alt="captcha" class="captcha" /></div></div>
                    </p>
                    <p>
                        <button type="submit" class="submit">提交评论</button>
                        <input type="hidden" name="parent" id="id_parent">
                        <input type="hidden" name="archive" value="435" id="id_archive">
                        <input type="hidden" name="csrfmiddlewaretoken" value="qMqaCxal20i6qFVUhfJVnUJJmEjc6TdqckO1aCL4qmwPYdJijgGGknMOH1AnFvpI">
                    </p>
                </form>
                </div>
            </div>
        </div>

    </div>
    



<div  class="col-5 columns" id="sidebar" role="complementary">

  <div class="widget widget_search">
    <h3>搜索</h3>
    <form action="https://www.leavesongs.com/search/" id="searchform" method="get">
        <input type="text" id="searchkey" name="keyword" value="" class="searchkey" placeholder="Search..."/>
        <button type="submit"  id="searchsubmit">Go</button>
    </form>
  </div>

  
  <div class="widget">
	<h3 class="widget-title">最新评论</h3>
	<ul class="widget-list" id="recent-comment">
    
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>木木</cite>：<a href="../THINK/europe-trip-2022.html#comment-4523">虽然物价对比不出什么，但是还是觉得很高昂</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>dongdong4fei</cite>：<a href="../THINK/using-chatgpt-for-antispam.html#comment-4520">肯德基疯狂星期四！ 疯狂星期四！  https://m.kfc.com.cn/wechatco...</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>dongdong4fei</cite>：<a href="../THINK/using-chatgpt-for-antispam.html#comment-4519">小猪咪小猪咪小猪咪</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>sam</cite>：<a href="javascript-prototype-pollution-attack.html#comment-4518">还得是P神，文章一看就懂</a></div>
        </li>
    
        <li id="comment" class="clearfix">
            <img class="avatar" src="../static/placeholder.jpg" alt="%s" width="40" height="40">
            <div class="comments-link"><cite>程序</cite>：<a href="discuz72-sql-injection.html#comment-4517">很不错的文章</a></div>
        </li>
    
    </ul>
  </div>

  <div class="widget widget-category">
	<h3>分类</h3>
	<ul id="blogsort" class="widget-list">
    
    
    <li>
        <a href="../sort/PENETRATION.html">网络安全<em>143</em></a>
    </li>
    
    <li>
        <a href="../sort/C.html">C/C++<em>32</em></a>
    </li>
    
    <li>
        <a href="../sort/THINK.html">心得与体会<em>24</em></a>
    </li>
    
    <li>
        <a href="../sort/PYTHON.html">Python<em>19</em></a>
    </li>
    
    <li>
        <a href="../sort/SHARE.html">资源分享<em>16</em></a>
    </li>
    
    </ul>
  </div>

  <div class="widget widget-tag">
	<h3>随机标签</h3>
	<div class="tag-cloud">
        
        
        <a rel="tag" href="../tag/%E5%A4%A7%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86.html">大文件处理</a>
        
        <a rel="tag" href="../tag/%E5%9B%9E%E8%B0%83%E5%90%8E%E9%97%A8.html">回调后门</a>
        
        <a rel="tag" href="../tag/iOS.html">iOS</a>
        
        <a rel="tag" href="../tag/%E4%BD%8D%E8%BF%90%E7%AE%97.html">位运算</a>
        
        <a rel="tag" href="../tag/%E6%A1%A5%E6%8E%A5.html">桥接</a>
        
        <a rel="tag" href="../tag/writeup.html">writeup</a>
        
        <a rel="tag" href="../tag/IIS.html">IIS</a>
        
        <a rel="tag" href="../tag/WTForm.html">WTForm</a>
        
        <a rel="tag" href="../tag/apache.html">apache</a>
        
        <a rel="tag" href="../tag/web%E6%8C%87%E7%BA%B9.html">web指纹</a>
        
        <a rel="tag" href="../tag/%E6%B1%89%E8%AF%BA%E5%A1%94.html">汉诺塔</a>
        
        <a rel="tag" href="../tag/cmd%E5%90%8E%E9%97%A8.html">cmd后门</a>
        
        <a rel="tag" href="../tag/Linux.html">Linux</a>
        
        <a rel="tag" href="../tag/CSP.html">CSP</a>
        
        <a rel="tag" href="../tag/%E5%9B%A2%E9%98%9F.html">团队</a>
        
        <a rel="tag" href="../tag/phpwind.html">phpwind</a>
        
        <a rel="tag" href="../tag/%E6%80%BB%E7%BB%93.html">总结</a>
        
        <a rel="tag" href="../tag/%E9%81%8D%E5%8E%86%E7%9B%AE%E5%BD%95.html">遍历目录</a>
        
        <a rel="tag" href="../tag/C-FREE.html">C-FREE</a>
        
        <a rel="tag" href="../tag/var_dump.html">var_dump</a>
        
        <a rel="tag" href="../tag/disable_functions.html">disable_functions</a>
        
        <a rel="tag" href="../tag/%E6%8A%A5%E7%BA%B8.html">报纸</a>
        
        <a rel="tag" href="../tag/%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E.html">越权漏洞</a>
        
        <a rel="tag" href="../tag/web%E5%BA%94%E7%94%A8.html">web应用</a>
        
        <a rel="tag" href="../tag/360webscan.html">360webscan</a>
        
        <a rel="tag" href="../tag/asyncore.html">asyncore</a>
        
        <a rel="tag" href="../tag/%E6%B2%99%E7%9B%92%E7%BB%95%E8%BF%87.html">沙盒绕过</a>
        
        <a rel="tag" href="../tag/fckeditor.html">fckeditor</a>
        
        <a rel="tag" href="../tag/%E6%95%B0%E6%8D%AE%E5%BA%93%E9%80%9F%E5%BA%A6.html">数据库速度</a>
        
        <a rel="tag" href="../tag/kali.html">kali</a>
        
    </div>
  </div>

  <div class="widget widget-recent-entries">
	<h3 class="widget-title">热门日志</h3>
	<ul id="hotlog" class="widget-list">
    
    
        <li><a href="../other/tinger.html">About.Me</a></li>
    
        <li><a href="detect-django.html">如何判断目标站点是否为Django开发</a></li>
    
        <li><a href="webshell-without-alphanum-advanced.html">无字母数字webshell之提高篇</a></li>
    
        <li><a href="webshell-without-alphanum.html">一些不包含数字和字母的webshell</a></li>
    
        <li><a href="php-filter-magic.html">谈一谈php://filter的妙用</a></li>
    
    </ul>
  </div>
  

</div>
</div>

<div id="footer">
	<!-- copyright -->
	<div class="container">
		<div class="row remove-bottom">
			<div class="col-6 columns">
			<h3>Little About</h3>
			<p>Phithon 非强迫症小青年  <br>
现居先 <br>
爱好：种花、买书、收藏明信片 <br>
欢迎各大组织收留 <br>
E-mail：root@leavesongs.com </p>
			</div>

			<div class="col-10 columns">

				<h3 class="mobile-hide">Follow me</h3>
        <div id="social-links">
          <a href="http://weibo.com/101yx" class="sweibo" target="_blank" title="新浪微博">新浪微博</a>
          <a href="javascript:alert(/没有腾讯微博哟/)" class="qweibo" target="_blank" title="腾讯微博">腾讯微博</a>
          <a href="javascript:alert(/墙外有什么/);window.open('http://google.com')" class="google" target="_blank" title="墙外的世界">google+</a>
          <a href="https://github.com/phith0n" class="github" target="_blank" title="Github">github</a>
          <a href="javascript:confirm(/mailto:root#leavesongs.com/)" class="mail" target="_blank" title="私信给我">私信给我</a>
          <a href="../feed/index.rss" target="_blank" class="rss" title="离别歌">RSS订阅</a>
        </div>
        <div class="bot-line"></div>
				<p class="copyright">
	Copyright &copy; Powered by talkbook
				&nbsp;&nbsp;<i>Designed and built with all the love in the world by <a href="../index.html" target="_blank">Phithon</a> && deepsky </i>
                    <a href="../index.html">更换模板</a>
				</p>
			</div>
		</div>
	</div>
	<!-- /copyright -->
</div>
<a href="#" id="go-top">Top ↑</a>
<script src="https://cdn.staticfile.org/jquery/1.12.4/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/jquery.appear/0.4.1/jquery.appear.min.js"></script>
<script src="../static/deep/js/common_tpl.js" type="text/javascript"></script>
<script src="../static/deep/js/config.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FF5KPQ1CZ6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FF5KPQ1CZ6');
</script>

<script src="https://cdn.staticfile.org/fancybox/2.1.7/js/jquery.fancybox.min.js"></script>
<script>
$(document).ready(function () {
    $(".entry a").each(function (i, e) {
        if(e.host != 'www.leavesongs.com') {
            e.target = '_blank';
        }
    });
    $(".entry img").each(function (i, e) {
        if(e.parentNode.tagName.toUpperCase() != 'A') {
            $(e).wrap('<a href="'+escapeHtml(e.src)+'" class="fancybox"></a>');
        } else {
            $(e.parentNode).addClass('fancybox');
        }
    });
    $('.fancybox').fancybox();
})
</script>

</body>

</html>